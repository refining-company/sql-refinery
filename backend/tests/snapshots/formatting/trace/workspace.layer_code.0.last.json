{
  "code.Code(files=1)": {
    "files": {
      "{cwd}/tests/inputs/unformatted.sql": [
        { "code.Query({cwd}/tests/inputs/unformatted.sql:1:0-1:725) = SELECT date(date_month, 'start of year') AS date_year, CASE WHEN c.region IN ...": {
            "expressions": [
              "code.Expression({cwd}/tests/inputs/unformatted.sql:1:218-1:276) = IIF(a.industry = 'Information Technology', 'IT', 'Non-IT')",
              "code.Expression({cwd}/tests/inputs/unformatted.sql:1:293-1:308) = SUM(ar.revenue)",
              "code.Expression({cwd}/tests/inputs/unformatted.sql:1:321-1:350) = COUNT(DISTINCT ar.account_id)",
              "code.Expression({cwd}/tests/inputs/unformatted.sql:1:364-1:411) = SUM(ar.revenue) / COUNT(DISTINCT ar.account_id)",
              "code.Expression({cwd}/tests/inputs/unformatted.sql:1:55-1:200) = CASE WHEN c.region IN ('Americas') THEN 'AMER' WHEN c.region IN ('Europe', 'A...",
              "code.Expression({cwd}/tests/inputs/unformatted.sql:1:7-1:40) = date(date_month, 'start of year')" ],
            "location": "code.Location = {cwd}/tests/inputs/unformatted.sql:1:0-1:725",
            "sources": [
              "code.Table({cwd}/tests/inputs/unformatted.sql:1:440-1:456) = ?.accounts_revenue",
              "code.Table({cwd}/tests/inputs/unformatted.sql:1:470-1:478) = ?.accounts",
              "code.Table({cwd}/tests/inputs/unformatted.sql:1:510-1:519) = ?.countries" ],
            "sql": "SELECT date(date_month, 'start of year') AS date_year, CASE WHEN c.region IN ('Americas') THEN 'AMER' WHEN c.region IN ('Europe', 'Africa') THEN 'EMEA' WHEN c.region = 'Asia' THEN 'APAC' ELSE NULL END AS macro_region, IIF(a.industry = 'Information Technology', 'IT', 'Non-IT') AS industry_it, SUM(ar.revenue) AS revenue, COUNT(DISTINCT ar.account_id) AS accounts, SUM(ar.revenue) / COUNT(DISTINCT ar.account_id) AS revenue_per_account FROM accounts_revenue ar LEFT JOIN accounts a USING (account_id) LEFT JOIN countries c USING (country) WHERE a.industry IN ('Information Technology', 'Telecommunication Services') AND date_month BETWEEN DATE('now', '-24 months') AND DATE('now') GROUP BY date_year, macro_region, industry_it" } } ] } } }