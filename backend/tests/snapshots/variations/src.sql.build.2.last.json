{
  "0-accounts.sql": [
    { "@root (source_file at 0:0) = -- FOUNDATIONAL TABL": [
        { "@scope (query_expr at 6:0) = WITH RECURSIVE date_": [
            { "@scope (query_expr at 7:4) = SELECT date(MIN(CASE": [
                { "@query (query_expr at 7:4) = SELECT date(MIN(CASE": [
                    { "@columns (select_list at 8:8) = date(MIN(CASE WHEN d": [
                        { "@expression (function_call at 8:8) = date(MIN(CASE WHEN d": [
                            { "@column (identifier at 8:27) = d.stage_date": [] },
                            { "@column (identifier at 8:42) = d.contract_start_dat": [] },
                            { "@column (identifier at 8:69) = d.stage_date": [] },
                            { "@column (identifier at 8:87) = d.contract_start_dat": [] } ] },
                        { "@alias (identifier at 8:118) = date_month": [] } ] },
                    { "@sources (from_clause at 9:4) = FROM deals d": [
                        { "@table (identifier at 9:9) = deals": [] },
                        { "@alias (identifier at 9:15) = d": [] } ] } ] },
                { "@query (query_expr at 11:4) = SELECT date(date_day": [
                    { "@columns (select_list at 12:8) = date(date_day, '+1 d": [
                        { "@expression (function_call at 12:8) = date(date_day, '+1 d": [
                            { "@column (identifier at 12:13) = date_day": [] } ] } ] },
                    { "@sources (from_clause at 13:4) = FROM date_ranges": [
                        { "@table (identifier at 13:9) = date_ranges": [] } ] },
                    { "@filter (where_clause at 14:4) = WHERE date_day < (SE": [
                        { "@column (identifier at 14:10) = date_day": [] },
                        { "@query (query_expr at 14:22) = SELECT date(MAX(CASE": [
                            { "@columns (select_list at 14:29) = date(MAX(CASE WHEN d": [
                                { "@expression (function_call at 14:29) = date(MAX(CASE WHEN d": [
                                    { "@column (identifier at 14:48) = d.contract_end_date": [] },
                                    { "@column (identifier at 14:70) = d.stage_date": [] },
                                    { "@column (identifier at 14:88) = d.contract_end_date": [] },
                                    { "@column (identifier at 14:113) = d.stage_date": [] } ] } ] },
                            { "@sources (from_clause at 14:132) = FROM deals d": [
                                { "@table (identifier at 14:137) = deals": [] },
                                { "@alias (identifier at 14:143) = d": [] } ] } ] } ] } ] } ] },
            { "@columns (select_list at 17:4) = date_day": [
                { "@column (identifier at 17:4) = date_day": [] } ] },
            { "@sources (from_clause at 18:0) = FROM date_ranges": [
                { "@table (identifier at 18:5) = date_ranges": [] } ] },
            { "@grouping (group_by_clause at 19:0) = GROUP BY date_day": [
                { "@column (identifier at 19:9) = date_day": [] } ] } ] },
        { "@query (query_expr at 25:0) = SELECT *, revenue / ": [
            { "@columns (select_list at 26:4) = *, revenue / contrac": [
                { "@column (select_all at 26:4) = *": [] },
                { "@expression (binary_expression at 27:4) = revenue / contract_d": [
                    { "@column (identifier at 27:4) = revenue": [] },
                    { "@column (identifier at 27:14) = contract_duration_da": [] } ] },
                { "@alias (identifier at 27:40) = revenue_day": [] },
                { "@expression (binary_expression at 28:4) = revenue_core / contr": [
                    { "@column (identifier at 28:4) = revenue_core": [] },
                    { "@column (identifier at 28:19) = contract_duration_da": [] } ] },
                { "@alias (identifier at 28:45) = revenue_core_day": [] },
                { "@expression (binary_expression at 29:4) = revenue_aux / contra": [
                    { "@column (identifier at 29:4) = revenue_aux": [] },
                    { "@column (identifier at 29:18) = contract_duration_da": [] } ] },
                { "@alias (identifier at 29:44) = revenue_aux_day": [] } ] },
            { "@sources (from_clause at 30:0) = FROM ( SELECT d.deal": [
                { "@query (query_expr at 31:4) = SELECT d.deal_id, d.": [
                    { "@columns (select_list at 32:8) = d.deal_id, d.account": [
                        { "@column (identifier at 32:8) = d.deal_id": [] },
                        { "@column (identifier at 33:8) = d.account_id": [] },
                        { "@column (identifier at 34:8) = d.contract_start_dat": [] },
                        { "@column (identifier at 35:8) = d.contract_end_date": [] },
                        { "@expression (binary_expression at 36:8) = julianday(d.contract": [
                            { "@column (identifier at 36:18) = d.contract_end_date": [] },
                            { "@column (identifier at 36:51) = d.contract_start_dat": [] } ] },
                        { "@alias (identifier at 36:81) = contract_duration_da": [] },
                        { "@expression (function_call at 37:8) = SUM(CASE WHEN o.prod": [
                            { "@column (identifier at 37:22) = o.product": [] },
                            { "@column (identifier at 37:86) = o.value": [] } ] },
                        { "@alias (identifier at 37:109) = revenue_core": [] },
                        { "@expression (function_call at 38:8) = SUM(CASE WHEN o.prod": [
                            { "@column (identifier at 38:22) = o.product": [] },
                            { "@column (identifier at 38:67) = o.value": [] } ] },
                        { "@alias (identifier at 38:90) = revenue_aux": [] },
                        { "@expression (function_call at 39:8) = SUM(o.value)": [
                            { "@column (identifier at 39:12) = o.value": [] } ] },
                        { "@alias (identifier at 39:24) = revenue": [] } ] },
                    { "@sources (from_clause at 40:4) = FROM orders o JOIN d": [
                        { "@table (identifier at 40:9) = orders": [] },
                        { "@alias (identifier at 40:16) = o": [] },
                        { "@table (identifier at 41:13) = deals": [] },
                        { "@alias (identifier at 41:19) = d": [] },
                        { "@join (join_condition at 41:21) = USING (deal_id, orde": [
                            { "@column (identifier at 41:28) = deal_id": [] },
                            { "@column (identifier at 41:37) = order_id": [] } ] } ] },
                    { "@filter (where_clause at 42:4) = WHERE d.stage = 4": [
                        { "@column (identifier at 42:10) = d.stage": [] } ] },
                    { "@grouping (group_by_clause at 43:4) = GROUP BY d.deal_id, ": [
                        { "@column (identifier at 43:13) = d.deal_id": [] },
                        { "@column (identifier at 43:24) = d.account_id": [] },
                        { "@column (identifier at 43:38) = d.contract_start_dat": [] },
                        { "@column (identifier at 43:61) = d.contract_end_date": [] } ] } ] },
                { "@alias (identifier at 44:5) = t": [] } ] } ] },
        { "@query (query_expr at 50:0) = SELECT t.date_month,": [
            { "@columns (select_list at 51:4) = t.date_month, t.acco": [
                { "@column (identifier at 51:4) = t.date_month": [] },
                { "@column (identifier at 52:4) = t.account_id": [] },
                { "@expression (function_call at 53:4) = AVG(t.deals)": [
                    { "@column (identifier at 53:8) = t.deals": [] } ] },
                { "@alias (identifier at 53:20) = deals": [] },
                { "@expression (function_call at 54:4) = SUM(t.revenue_core)": [
                    { "@column (identifier at 54:8) = t.revenue_core": [] } ] },
                { "@alias (identifier at 54:27) = revenue_core": [] },
                { "@expression (function_call at 55:4) = SUM(t.revenue_aux)": [
                    { "@column (identifier at 55:8) = t.revenue_aux": [] } ] },
                { "@alias (identifier at 55:26) = revenue_aux": [] },
                { "@expression (function_call at 56:4) = SUM(t.revenue)": [
                    { "@column (identifier at 56:8) = t.revenue": [] } ] },
                { "@alias (identifier at 56:22) = revenue": [] } ] },
            { "@sources (from_clause at 57:0) = FROM ( SELECT dr.dat": [
                { "@query (query_expr at 58:4) = SELECT dr.date_day, ": [
                    { "@columns (select_list at 59:8) = dr.date_day, DATE(da": [
                        { "@column (identifier at 59:8) = dr.date_day": [] },
                        { "@expression (function_call at 60:8) = DATE(date_day, 'star": [
                            { "@column (identifier at 60:13) = date_day": [] } ] },
                        { "@alias (identifier at 60:44) = date_month": [] },
                        { "@column (identifier at 61:8) = ds.account_id": [] },
                        { "@expression (function_call at 62:8) = COUNT(ds.deal_id)": [
                            { "@column (identifier at 62:14) = ds.deal_id": [] } ] },
                        { "@alias (identifier at 62:29) = deals": [] },
                        { "@expression (function_call at 63:8) = SUM(ds.revenue_core_": [
                            { "@column (identifier at 63:12) = ds.revenue_core_day": [] } ] },
                        { "@alias (identifier at 63:36) = revenue_core": [] },
                        { "@expression (function_call at 64:8) = SUM(ds.revenue_aux_d": [
                            { "@column (identifier at 64:12) = ds.revenue_aux_day": [] } ] },
                        { "@alias (identifier at 64:35) = revenue_aux": [] },
                        { "@expression (function_call at 65:8) = SUM(ds.revenue_day)": [
                            { "@column (identifier at 65:12) = ds.revenue_day": [] } ] },
                        { "@alias (identifier at 65:31) = revenue": [] } ] },
                    { "@sources (from_clause at 66:4) = FROM date_ranges dr ": [
                        { "@table (identifier at 66:9) = date_ranges": [] },
                        { "@alias (identifier at 66:21) = dr": [] },
                        { "@table (identifier at 67:18) = deals_signed": [] },
                        { "@alias (identifier at 67:31) = ds": [] },
                        { "@join (join_condition at 68:12) = ON dr.date_day >= da": [
                            { "@expression (binary_expression at 68:16) = dr.date_day >= date(": [
                                { "@column (identifier at 68:16) = dr.date_day": [] },
                                { "@column (identifier at 68:36) = ds.contract_start_da": [] },
                                { "@column (identifier at 69:16) = dr.date_day": [] },
                                { "@column (identifier at 69:36) = ds.contract_end_date": [] } ] } ] } ] },
                    { "@grouping (group_by_clause at 70:4) = GROUP BY dr.date_day": [
                        { "@column (identifier at 70:13) = dr.date_day": [] },
                        { "@column (identifier at 70:26) = ds.account_id": [] } ] } ] },
                { "@alias (identifier at 70:41) = t": [] } ] },
            { "@grouping (group_by_clause at 71:0) = GROUP BY account_id,": [
                { "@column (identifier at 71:9) = account_id": [] },
                { "@column (identifier at 71:21) = date_month": [] } ] } ] },
        { "@query (query_expr at 78:0) = SELECT t.*, CASE WHE": [
            { "@columns (select_list at 79:4) = t.*, CASE WHEN t.rev": [
                { "@column (select_all at 79:4) = t.*": [] },
                { "@expression (casewhen_expression at 80:4) = CASE WHEN t.revenue_": [
                    { "@column (identifier at 81:13) = t.revenue_12m": [] },
                    { "@column (identifier at 82:13) = t.revenue_12m": [] },
                    { "@column (identifier at 82:37) = t.revenue_12m": [] },
                    { "@column (identifier at 83:13) = t.revenue_12m": [] } ] },
                { "@alias (identifier at 85:11) = account_size": [] } ] },
            { "@sources (from_clause at 86:0) = FROM ( SELECT accoun": [
                { "@query (query_expr at 87:4) = SELECT account_id, d": [
                    { "@columns (select_list at 88:8) = account_id, date_mon": [
                        { "@column (identifier at 88:8) = account_id": [] },
                        { "@column (identifier at 89:8) = date_month": [] },
                        { "@column (identifier at 90:8) = revenue": [] },
                        { "@column (identifier at 91:8) = revenue_core": [] },
                        { "@column (identifier at 92:8) = revenue_aux": [] },
                        { "@column (identifier at 93:8) = deals": [] },
                        { "@column (identifier at 94:8) = accounts.name": [] },
                        { "@column (identifier at 95:8) = accounts.industry": [] },
                        { "@column (identifier at 96:8) = accounts.country": [] },
                        { "@expression (casewhen_expression at 97:8) = CASE WHEN c.region I": [
                            { "@column (identifier at 98:17) = c.region": [] },
                            { "@column (identifier at 99:17) = c.region": [] } ] },
                        { "@alias (identifier at 101:15) = region_cluster": [] },
                        { "@column (identifier at 102:8) = accounts.priority": [] },
                        { "@expression (function_call at 103:8) = SUM(revenue) OVER ( ": [
                            { "@column (identifier at 103:12) = revenue": [] },
                            { "@column (identifier at 104:25) = account_id": [] },
                            { "@ordering (order_by_clause at 105:12) = ORDER BY date_month": [
                                { "@column (identifier at 105:21) = date_month": [] } ] } ] },
                        { "@alias (identifier at 107:13) = revenue_12m": [] } ] },
                    { "@sources (from_clause at 108:4) = FROM accounts_revenu": [
                        { "@table (identifier at 108:9) = accounts_revenue": [] },
                        { "@table (identifier at 109:13) = accounts": [] },
                        { "@join (join_condition at 109:22) = USING (account_id)": [
                            { "@column (identifier at 109:29) = account_id": [] } ] },
                        { "@table (identifier at 110:18) = countries": [] },
                        { "@alias (identifier at 110:28) = c": [] },
                        { "@join (join_condition at 110:30) = USING (country)": [
                            { "@column (identifier at 110:37) = country": [] } ] } ] } ] },
                { "@alias (identifier at 111:5) = t": [] } ] } ] } ] } ],
  "1-revenue.sql": [
    { "@root (source_file at 0:0) = -- REVENUE REPORTS -": [
        { "@query (query_expr at 4:0) = SELECT date(date_mon": [
            { "@columns (select_list at 5:4) = date(date_month, 'st": [
                { "@expression (function_call at 5:4) = date(date_month, 'st": [
                    { "@column (identifier at 5:9) = date_month": [] } ] },
                { "@alias (identifier at 5:41) = date_year": [] },
                { "@expression (casewhen_expression at 6:4) = CASE WHEN c.region I": [
                    { "@column (identifier at 7:13) = c.region": [] },
                    { "@column (identifier at 8:13) = c.region": [] } ] },
                { "@alias (identifier at 10:11) = region_cluster": [] },
                { "@expression (casewhen_expression at 11:4) = CASE WHEN a.industry": [
                    { "@column (identifier at 12:13) = a.industry": [] },
                    { "@column (identifier at 13:13) = a.industry": [] } ] },
                { "@alias (identifier at 15:11) = industry_cluster": [] },
                { "@column (identifier at 16:4) = a360.account_size": [] },
                { "@expression (function_call at 17:4) = SUM(ar.revenue)": [
                    { "@column (identifier at 17:8) = ar.revenue": [] } ] },
                { "@alias (identifier at 17:23) = revenue": [] },
                { "@expression (function_call at 18:4) = COUNT(DISTINCT ar.ac": [
                    { "@column (identifier at 18:19) = ar.account_id": [] } ] },
                { "@alias (identifier at 18:37) = accounts": [] },
                { "@expression (binary_expression at 19:4) = SUM(ar.revenue) / CO": [
                    { "@column (identifier at 19:8) = ar.revenue": [] },
                    { "@column (identifier at 19:37) = ar.account_id": [] } ] },
                { "@alias (identifier at 19:55) = revenue_per_account": [] } ] },
            { "@sources (from_clause at 20:0) = FROM accounts_revenu": [
                { "@table (identifier at 20:5) = accounts_revenue": [] },
                { "@alias (identifier at 20:22) = ar": [] },
                { "@table (identifier at 21:14) = accounts": [] },
                { "@alias (identifier at 21:23) = a": [] },
                { "@join (join_condition at 21:25) = USING (account_id)": [
                    { "@column (identifier at 21:32) = account_id": [] } ] },
                { "@table (identifier at 22:14) = countries": [] },
                { "@alias (identifier at 22:24) = c": [] },
                { "@join (join_condition at 22:26) = USING (country)": [
                    { "@column (identifier at 22:33) = country": [] } ] },
                { "@table (identifier at 23:14) = accounts_360": [] },
                { "@alias (identifier at 23:27) = a360": [] },
                { "@join (join_condition at 23:32) = USING (account_id, d": [
                    { "@column (identifier at 23:39) = account_id": [] },
                    { "@column (identifier at 23:51) = date_month": [] } ] } ] },
            { "@grouping (group_by_clause at 24:0) = GROUP BY date_year, ": [
                { "@column (identifier at 24:9) = date_year": [] },
                { "@column (identifier at 24:20) = region_cluster": [] },
                { "@column (identifier at 24:36) = industry_cluster": [] },
                { "@column (identifier at 24:54) = a360.account_size": [] } ] },
            { "@ordering (order_by_clause at 25:0) = ORDER BY date_year, ": [
                { "@column (identifier at 25:9) = date_year": [] },
                { "@column (identifier at 25:20) = region_cluster": [] },
                { "@column (identifier at 25:36) = industry_cluster": [] } ] } ] },
        { "@query (query_expr at 29:0) = SELECT accounts.name": [
            { "@columns (select_list at 30:4) = accounts.name, regio": [
                { "@column (identifier at 30:4) = accounts.name": [] },
                { "@column (identifier at 31:4) = region": [] },
                { "@expression (casewhen_expression at 32:4) = CASE WHEN c.region I": [
                    { "@column (identifier at 33:13) = c.region": [] },
                    { "@column (identifier at 34:13) = c.region": [] } ] },
                { "@alias (identifier at 36:11) = cluster": [] },
                { "@column (identifier at 37:4) = accounts.industry": [] },
                { "@alias (identifier at 37:25) = industry": [] },
                { "@expression (function_call at 38:4) = IIF(accounts.industr": [
                    { "@column (identifier at 38:8) = accounts.industry": [] } ] },
                { "@alias (identifier at 38:74) = industry_tech": [] },
                { "@expression (casewhen_expression at 39:4) = CASE WHEN SUM(accoun": [
                    { "@column (identifier at 40:17) = accounts_revenue.rev": [] },
                    { "@column (identifier at 41:17) = accounts_revenue.rev": [] },
                    { "@column (identifier at 41:57) = accounts_revenue.rev": [] },
                    { "@column (identifier at 42:17) = accounts_revenue.rev": [] } ] },
                { "@alias (identifier at 44:11) = account_size": [] },
                { "@expression (function_call at 45:4) = SUM(accounts_revenue": [
                    { "@column (identifier at 45:8) = accounts_revenue.rev": [] } ] },
                { "@alias (identifier at 45:37) = revenue_12m": [] } ] },
            { "@sources (from_clause at 46:0) = FROM accounts LEFT J": [
                { "@table (identifier at 46:5) = accounts": [] },
                { "@table (identifier at 47:14) = accounts_revenue": [] },
                { "@join (join_condition at 47:31) = USING (account_id)": [
                    { "@column (identifier at 47:38) = account_id": [] } ] },
                { "@table (identifier at 48:14) = countries": [] },
                { "@alias (identifier at 48:24) = c": [] },
                { "@join (join_condition at 48:26) = USING (country)": [
                    { "@column (identifier at 48:33) = country": [] } ] } ] },
            { "@filter (where_clause at 49:0) = WHERE accounts_reven": [
                { "@column (identifier at 49:6) = accounts_revenue.dat": [] } ] },
            { "@grouping (group_by_clause at 50:0) = GROUP BY accounts.na": [
                { "@column (identifier at 50:9) = accounts.name": [] },
                { "@column (identifier at 50:24) = region": [] },
                { "@column (identifier at 50:32) = accounts.industry": [] } ] } ] } ] } ],
  "editor.sql": [
    { "@root (source_file at 0:0) = -- CASE: Different g": [
        { "@query (query_expr at 2:0) = SELECT date(date_mon": [
            { "@columns (select_list at 3:4) = date(date_month, 'st": [
                { "@expression (function_call at 3:4) = date(date_month, 'st": [
                    { "@column (identifier at 3:9) = date_month": [] } ] },
                { "@alias (identifier at 3:41) = date_year": [] },
                { "@expression (casewhen_expression at 5:4) = CASE WHEN c.region I": [
                    { "@column (identifier at 6:13) = c.region": [] },
                    { "@column (identifier at 7:13) = c.region": [] },
                    { "@column (identifier at 8:13) = c.region": [] } ] },
                { "@alias (identifier at 10:11) = macro_region": [] },
                { "@expression (function_call at 12:4) = IIF(a.industry = 'In": [
                    { "@column (identifier at 12:8) = a.industry": [] } ] },
                { "@alias (identifier at 12:66) = industry_it": [] },
                { "@expression (function_call at 13:4) = SUM(ar.revenue)": [
                    { "@column (identifier at 13:8) = ar.revenue": [] } ] },
                { "@alias (identifier at 13:23) = revenue": [] },
                { "@expression (function_call at 14:4) = COUNT(DISTINCT ar.ac": [
                    { "@column (identifier at 14:19) = ar.account_id": [] } ] },
                { "@alias (identifier at 14:37) = accounts": [] },
                { "@expression (binary_expression at 15:4) = SUM(ar.revenue) / CO": [
                    { "@column (identifier at 15:8) = ar.revenue": [] },
                    { "@column (identifier at 15:37) = ar.account_id": [] } ] },
                { "@alias (identifier at 15:55) = revenue_per_account": [] } ] },
            { "@sources (from_clause at 16:0) = FROM accounts_revenu": [
                { "@table (identifier at 16:5) = accounts_revenue": [] },
                { "@alias (identifier at 16:22) = ar": [] },
                { "@table (identifier at 17:14) = accounts": [] },
                { "@alias (identifier at 17:23) = a": [] },
                { "@join (join_condition at 17:25) = USING (account_id)": [
                    { "@column (identifier at 17:32) = account_id": [] } ] },
                { "@table (identifier at 18:14) = countries": [] },
                { "@alias (identifier at 18:24) = c": [] },
                { "@join (join_condition at 18:26) = USING (country)": [
                    { "@column (identifier at 18:33) = country": [] } ] } ] },
            { "@filter (where_clause at 19:0) = WHERE -- This is app": [
                { "@column (identifier at 21:4) = a.industry": [] },
                { "@column (identifier at 23:8) = date_month": [] } ] },
            { "@grouping (group_by_clause at 24:0) = GROUP BY date_year, ": [
                { "@column (identifier at 24:9) = date_year": [] },
                { "@column (identifier at 24:20) = macro_region": [] },
                { "@column (identifier at 24:34) = industry_it": [] } ] } ] } ] } ] }