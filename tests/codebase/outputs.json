{
  "files": [
    { "file:editor.sql:-- CASE: Different groupings or thresholds applied to columns SELECT date(date_month, 'start o": [] },
    { "file:0-accounts.sql:-- FOUNDATIONAL TABLES -- Calendar scaffolding: one day per row DROP TABLE IF EXISTS date_ranges; ": [] },
    { "file:1-revenue.sql:-- REVENUE REPORTS -- Revenue by region, cluster, account size SELECT date(date_month, 'start": [] } ],
  "queries": [
    { "File:editor.sql:2:0 Expression:SELECT date(date_month, 'start of year') AS date_year, -- This should cause an error CA": {
        "columns": [
          "None:None:b'account_id'",
          "None:None:b'country'",
          "None:b'countries':b'region'",
          "None:None:b'date_month'",
          "None:None:b'macro_region'",
          "None:None:b'industry_it'",
          "None:b'accounts_revenue':b'revenue'",
          "None:b'accounts_revenue':b'account_id'",
          "None:b'accounts':b'industry'",
          "None:None:b'date_year'" ],
        "ops": [
          { "File:editor.sql:3:4 Expression:date(date_month, 'start of year'):4b7b97e7a6896e093cad32653300500aaa41bdd3cef9129d22da46e7479b9b76": [],
            "columns": [
              "None:None:b'date_month'" ] },
          { "File:editor.sql:5:4 Expression:CASE WHEN c.region IN ('Americas') THEN 'AMER' WHEN c.region IN ('Europe', 'Africa'):3e6ce402ad75545e4bc33912151bbd21e9130f312c5f8264434ec6a04ff01a09": [],
            "columns": [
              "None:b'countries':b'region'" ] },
          { "File:editor.sql:12:4 Expression:IIF(a.industry = 'Information Technology', 'IT', 'Non-IT'):c0b13fbaf4bbe940b50b558c057106356ead92fec7df3ae268c7df4f835a88d9": [],
            "columns": [
              "None:b'accounts':b'industry'" ] },
          { "File:editor.sql:13:4 Expression:SUM(ar.revenue):b63a36ce15ba6b5fe27de8705f6e88b47b3df577aab4903b2204cd16ded340c6": [],
            "columns": [
              "None:b'accounts_revenue':b'revenue'" ] },
          { "File:editor.sql:14:4 Expression:COUNT(DISTINCT ar.account_id):deb42d562dad3cc78436994dadb32a4e875bb3afac7d3fb01daa3721a5b60a85": [],
            "columns": [
              "None:b'accounts_revenue':b'account_id'" ] },
          { "File:editor.sql:15:4 Expression:SUM(ar.revenue) / COUNT(DISTINCT ar.account_id):787feb0754235784176b4b3438a50c239a42ebb7d1f37331a6cdbd53f5e2234f": [],
            "columns": [
              "None:b'accounts_revenue':b'revenue'",
              "None:b'accounts_revenue':b'account_id'" ] },
          { "File:editor.sql:17:32 Expression:account_id:80d5680d88a935ce1f11b0731d6c27091798019cf1b93f093393238d061c4afe": [],
            "columns": [
              "None:None:b'account_id'" ] },
          { "File:editor.sql:18:33 Expression:country:9c92d791dfe191f885b510e68fddd75e50be5e19d55dfd12a7b016c541b30705": [],
            "columns": [
              "None:None:b'country'" ] },
          { "File:editor.sql:24:9 Expression:date_year:dfdec1fde5d3fb8cd44b6c956e7c9cf2b629b120950b3bc2918cf80b1c6249ca": [],
            "columns": [
              "None:None:b'date_year'" ] },
          { "File:editor.sql:24:20 Expression:macro_region:bcc4934d5fe46751da8d887ea8b4e72bd72e0313f327f4825bf1be75819efcbe": [],
            "columns": [
              "None:None:b'macro_region'" ] },
          { "File:editor.sql:24:34 Expression:industry_it:c3aa9981d9242a27d50908d9041098dd9dcaf76f7d7e5dbc77997d69e22c8f2d": [],
            "columns": [
              "None:None:b'industry_it'" ] } ] } },
    { "File:0-accounts.sql:25:0 Expression:SELECT *, revenue / contract_duration_days AS revenue_day, revenue_core / contract_dura": {
        "columns": [
          "None:None:b'revenue_core'",
          "None:None:b'revenue_aux'",
          "None:None:b'revenue'",
          "None:None:b'contract_duration_days'" ],
        "ops": [
          { "File:0-accounts.sql:27:4 Expression:revenue / contract_duration_days:51f5fc4a853126c8799ca65b1db65ce5efaa4c8f8c202ee9646fc909d8868dab": [],
            "columns": [
              "None:None:b'revenue'",
              "None:None:b'contract_duration_days'" ] },
          { "File:0-accounts.sql:28:4 Expression:revenue_core / contract_duration_days:7bbea5dce65707acba6d337652a0da591d19c3e22cd6c99cd8b9f4a005f6a0d4": [],
            "columns": [
              "None:None:b'revenue_core'",
              "None:None:b'contract_duration_days'" ] },
          { "File:0-accounts.sql:29:4 Expression:revenue_aux / contract_duration_days:e77a77b6803cf3e557134ada6e9f56c9f8ab19c3463238022426c4f08bd36775": [],
            "columns": [
              "None:None:b'revenue_aux'",
              "None:None:b'contract_duration_days'" ] } ] } },
    { "File:0-accounts.sql:50:0 Expression:SELECT t.date_month, t.account_id, AVG(t.deals) AS deals, SUM(t.revenue_core) AS re": {
        "columns": [
          "None:None:b'account_id'",
          "None:b't':b'date_month'",
          "None:b't':b'deals'",
          "None:b't':b'revenue_core'",
          "None:None:b'date_month'",
          "None:b't':b'revenue_aux'",
          "None:b't':b'revenue'",
          "None:b't':b'account_id'" ],
        "ops": [
          { "File:0-accounts.sql:51:4 Expression:t.date_month:67317e501b3a779b7fac632026f46726e34e5bbab9688dc385a57e604a20eef1": [],
            "columns": [
              "None:b't':b'date_month'" ] },
          { "File:0-accounts.sql:52:4 Expression:t.account_id:c21101b11f131efe74f257d7f7f4149b21da80df5716a866cc20023136cdd365": [],
            "columns": [
              "None:b't':b'account_id'" ] },
          { "File:0-accounts.sql:53:4 Expression:AVG(t.deals):14a9db0bfcd45a2a6d315c35ae9ab577687439d3b6ce14262d07d5c050216200": [],
            "columns": [
              "None:b't':b'deals'" ] },
          { "File:0-accounts.sql:54:4 Expression:SUM(t.revenue_core):011b13191a7951961453905e8c14f49057b0f8695a86eee9cd1825d30a458026": [],
            "columns": [
              "None:b't':b'revenue_core'" ] },
          { "File:0-accounts.sql:55:4 Expression:SUM(t.revenue_aux):e0d3f664fe2d1a7e29d2c4ccac79b0ca24536142e57d4e523a656095737e7901": [],
            "columns": [
              "None:b't':b'revenue_aux'" ] },
          { "File:0-accounts.sql:56:4 Expression:SUM(t.revenue):e4de1d66f96f0e8e5d990299e488b2f4e6adc33630d0c80eb4ae3aa1ea224eac": [],
            "columns": [
              "None:b't':b'revenue'" ] },
          { "File:0-accounts.sql:71:9 Expression:account_id:80d5680d88a935ce1f11b0731d6c27091798019cf1b93f093393238d061c4afe": [],
            "columns": [
              "None:None:b'account_id'" ] },
          { "File:0-accounts.sql:71:21 Expression:date_month:25aff29a8fcdb8b5b04fdf197217ef36208e5cb3d6e87135841457dc65fa239d": [],
            "columns": [
              "None:None:b'date_month'" ] } ] } },
    { "File:0-accounts.sql:78:0 Expression:SELECT t.*, CASE WHEN t.revenue_12m <= 300 THEN 'Small' WHEN t.revenue_12m": {
        "columns": [
          "None:b't':b'revenue_12m'" ],
        "ops": [
          { "File:0-accounts.sql:80:4 Expression:CASE WHEN t.revenue_12m <= 300 THEN 'Small' WHEN t.revenue_12m > 300 AND t.revenue_:c9651417f21495f87d0c7d6a7cfae40a21147cc8efbb78f150733a0758354724": [],
            "columns": [
              "None:b't':b'revenue_12m'" ] } ] } },
    { "File:1-revenue.sql:4:0 Expression:SELECT date(date_month, 'start of year') AS date_year, CASE WHEN c.region IN ('Amer": {
        "columns": [
          "None:None:b'account_id'",
          "None:None:b'country'",
          "None:None:b'region_cluster'",
          "None:b'countries':b'region'",
          "None:None:b'date_month'",
          "None:b'accounts_revenue':b'revenue'",
          "None:b'accounts_revenue':b'account_id'",
          "None:b'accounts':b'industry'",
          "None:None:b'date_year'",
          "None:None:b'industry_cluster'",
          "None:b'accounts_360':b'account_size'" ],
        "ops": [
          { "File:1-revenue.sql:5:4 Expression:date(date_month, 'start of year'):4b7b97e7a6896e093cad32653300500aaa41bdd3cef9129d22da46e7479b9b76": [],
            "columns": [
              "None:None:b'date_month'" ] },
          { "File:1-revenue.sql:6:4 Expression:CASE WHEN c.region IN ('Americas', 'Europe') THEN 'North-West' WHEN c.region IN ('Af:ecb334b79ee833cf1226dd33198cdc61e2863ea22416dc1be17d8af713cd636f": [],
            "columns": [
              "None:b'countries':b'region'" ] },
          { "File:1-revenue.sql:11:4 Expression:CASE WHEN a.industry = 'Information Technology' THEN 'Tech' WHEN a.industry IS NULL:cdad108efc823f2045dd61df442280e40d550fa237c2da6c080055c2b2aa9575": [],
            "columns": [
              "None:b'accounts':b'industry'" ] },
          { "File:1-revenue.sql:16:4 Expression:a360.account_size:c062cfd77c57fa3d7799862a617cb1424a31b4098b4b5825c02d75e5801820ad": [],
            "columns": [
              "None:b'accounts_360':b'account_size'" ] },
          { "File:1-revenue.sql:17:4 Expression:SUM(ar.revenue):b63a36ce15ba6b5fe27de8705f6e88b47b3df577aab4903b2204cd16ded340c6": [],
            "columns": [
              "None:b'accounts_revenue':b'revenue'" ] },
          { "File:1-revenue.sql:18:4 Expression:COUNT(DISTINCT ar.account_id):deb42d562dad3cc78436994dadb32a4e875bb3afac7d3fb01daa3721a5b60a85": [],
            "columns": [
              "None:b'accounts_revenue':b'account_id'" ] },
          { "File:1-revenue.sql:19:4 Expression:SUM(ar.revenue) / COUNT(DISTINCT ar.account_id):787feb0754235784176b4b3438a50c239a42ebb7d1f37331a6cdbd53f5e2234f": [],
            "columns": [
              "None:b'accounts_revenue':b'revenue'",
              "None:b'accounts_revenue':b'account_id'" ] },
          { "File:1-revenue.sql:21:32 Expression:account_id:80d5680d88a935ce1f11b0731d6c27091798019cf1b93f093393238d061c4afe": [],
            "columns": [
              "None:None:b'account_id'" ] },
          { "File:1-revenue.sql:22:33 Expression:country:9c92d791dfe191f885b510e68fddd75e50be5e19d55dfd12a7b016c541b30705": [],
            "columns": [
              "None:None:b'country'" ] },
          { "File:1-revenue.sql:23:39 Expression:account_id:80d5680d88a935ce1f11b0731d6c27091798019cf1b93f093393238d061c4afe": [],
            "columns": [
              "None:None:b'account_id'",
              "None:None:b'date_month'" ] },
          { "File:1-revenue.sql:23:51 Expression:date_month:25aff29a8fcdb8b5b04fdf197217ef36208e5cb3d6e87135841457dc65fa239d": [],
            "columns": [
              "None:None:b'account_id'",
              "None:None:b'date_month'" ] },
          { "File:1-revenue.sql:24:9 Expression:date_year:dfdec1fde5d3fb8cd44b6c956e7c9cf2b629b120950b3bc2918cf80b1c6249ca": [],
            "columns": [
              "None:None:b'date_year'" ] },
          { "File:1-revenue.sql:24:20 Expression:region_cluster:5bf05161bfb2ae29623db366105106c840582b52cae51b05d46a4ff6adbc4964": [],
            "columns": [
              "None:None:b'region_cluster'" ] },
          { "File:1-revenue.sql:24:36 Expression:industry_cluster:cc33e4c7fc6cb7ccb2603f41b7259dfd4cdf598ba14ffae14fb5d7994249abb9": [],
            "columns": [
              "None:None:b'industry_cluster'" ] },
          { "File:1-revenue.sql:24:54 Expression:a360.account_size:c062cfd77c57fa3d7799862a617cb1424a31b4098b4b5825c02d75e5801820ad": [],
            "columns": [
              "None:b'accounts_360':b'account_size'" ] },
          { "File:1-revenue.sql:25:9 Expression:date_year:dfdec1fde5d3fb8cd44b6c956e7c9cf2b629b120950b3bc2918cf80b1c6249ca": [],
            "columns": [
              "None:None:b'date_year'",
              "None:None:b'region_cluster'",
              "None:None:b'industry_cluster'" ] },
          { "File:1-revenue.sql:25:20 Expression:region_cluster:5bf05161bfb2ae29623db366105106c840582b52cae51b05d46a4ff6adbc4964": [],
            "columns": [
              "None:None:b'date_year'",
              "None:None:b'region_cluster'",
              "None:None:b'industry_cluster'" ] },
          { "File:1-revenue.sql:25:36 Expression:industry_cluster:cc33e4c7fc6cb7ccb2603f41b7259dfd4cdf598ba14ffae14fb5d7994249abb9": [],
            "columns": [
              "None:None:b'date_year'",
              "None:None:b'region_cluster'",
              "None:None:b'industry_cluster'" ] } ] } },
    { "File:1-revenue.sql:29:0 Expression:SELECT accounts.name, region, CASE WHEN c.region IN ('Americas', 'Europe') THEN ": {
        "columns": [
          "None:b'accounts_revenue':b'region'",
          "None:b'accounts_revenue':b'country'",
          "None:b'countries':b'region'",
          "None:b'accounts':b'name'",
          "None:b'accounts_revenue':b'revenue'",
          "None:b'accounts_revenue':b'account_id'",
          "None:b'accounts':b'industry'" ],
        "ops": [
          { "File:1-revenue.sql:30:4 Expression:accounts.name:3d4d38d841e360ea2672fad2445c6d8f60cd0604fba111db2693bbeeb21a8f4c": [],
            "columns": [
              "None:b'accounts':b'name'" ] },
          { "File:1-revenue.sql:31:4 Expression:region:c33d6fe3df0c9eaca54d99c18d15aba9e2c76c130caaefdf24fa0dfae0b44707": [],
            "columns": [
              "None:b'accounts_revenue':b'region'" ] },
          { "File:1-revenue.sql:32:4 Expression:CASE WHEN c.region IN ('Americas', 'Europe') THEN 'North-West' WHEN c.region IN ('Af:ecb334b79ee833cf1226dd33198cdc61e2863ea22416dc1be17d8af713cd636f": [],
            "columns": [
              "None:b'countries':b'region'" ] },
          { "File:1-revenue.sql:37:4 Expression:accounts.industry:081c32c3400d07bb74c3ae4808846d306e5b8f982a6dbd1c1877a23bb20ab6ab": [],
            "columns": [
              "None:b'accounts':b'industry'" ] },
          { "File:1-revenue.sql:38:4 Expression:IIF(accounts.industry = 'Information Technology', 'Tech', 'Other'):0283633179496ea59e17859094ce6b30796e39be4d655e2410cc4c8c8c90e66e": [],
            "columns": [
              "None:b'accounts':b'industry'" ] },
          { "File:1-revenue.sql:39:4 Expression:CASE WHEN SUM(accounts_revenue.revenue) <= 300 THEN 'Small' WHEN SUM(accounts_reven:e38675467d1de20f63525b2a4b2bb303186ddb1a3fddc0048f9ab6bfca17be76": [],
            "columns": [
              "None:b'accounts_revenue':b'revenue'" ] },
          { "File:1-revenue.sql:45:4 Expression:SUM(accounts_revenue.revenue):db93a2907a69509dfcffd393f3987a84d98d88f3695bd3d9eb73cf5945ae9392": [],
            "columns": [
              "None:b'accounts_revenue':b'revenue'" ] },
          { "File:1-revenue.sql:47:38 Expression:account_id:80d5680d88a935ce1f11b0731d6c27091798019cf1b93f093393238d061c4afe": [],
            "columns": [
              "None:b'accounts_revenue':b'account_id'" ] },
          { "File:1-revenue.sql:48:33 Expression:country:9c92d791dfe191f885b510e68fddd75e50be5e19d55dfd12a7b016c541b30705": [],
            "columns": [
              "None:b'accounts_revenue':b'country'" ] },
          { "File:1-revenue.sql:50:9 Expression:accounts.name:3d4d38d841e360ea2672fad2445c6d8f60cd0604fba111db2693bbeeb21a8f4c": [],
            "columns": [
              "None:b'accounts':b'name'" ] },
          { "File:1-revenue.sql:50:24 Expression:region:c33d6fe3df0c9eaca54d99c18d15aba9e2c76c130caaefdf24fa0dfae0b44707": [],
            "columns": [
              "None:b'accounts_revenue':b'region'" ] },
          { "File:1-revenue.sql:50:32 Expression:accounts.industry:081c32c3400d07bb74c3ae4808846d306e5b8f982a6dbd1c1877a23bb20ab6ab": [],
            "columns": [
              "None:b'accounts':b'industry'" ] } ] } } ] }