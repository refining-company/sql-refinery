{
  "files": {
    "editor.sql": {
      "root": [
        {
          "source_file": [
            { "comment": [] },
            {
              "query_statement": [
                {
                  "query_expr": [
                    {
                      "select": [
                        { "SELECT": [] },
                        {
                          "select_list": [
                            {
                              "_aliasable_expression": [
                                {
                                  "function_call": [
                                    { "identifier:date": [{ "DATE": [] }] },
                                    { "(": [] },
                                    {
                                      "argument": [
                                        { "identifier:date_month": [] }
                                      ]
                                    },
                                    { ",": [] },
                                    {
                                      "argument": [
                                        { "string:'start of year'": [] }
                                      ]
                                    },
                                    { ")": [] }
                                  ]
                                },
                                {
                                  "as_alias": [
                                    { "AS": [] },
                                    { "identifier:date_year": [] }
                                  ]
                                }
                              ]
                            },
                            { ",": [] },
                            { "comment": [] },
                            {
                              "_aliasable_expression": [
                                {
                                  "casewhen_expression": [
                                    { "CASE": [] },
                                    {
                                      "casewhen_clause": [
                                        { "WHEN_MATCHED": [] },
                                        {
                                          "binary_expression": [
                                            {
                                              "identifier:c.region": [
                                                { ".": [] }
                                              ]
                                            },
                                            { "IN": [] },
                                            { "(": [] },
                                            { "string:'Americas'": [] },
                                            { ")": [] }
                                          ]
                                        },
                                        { "THEN": [] },
                                        { "string:'AMER'": [] }
                                      ]
                                    },
                                    {
                                      "casewhen_clause": [
                                        { "WHEN_MATCHED": [] },
                                        {
                                          "binary_expression": [
                                            {
                                              "identifier:c.region": [
                                                { ".": [] }
                                              ]
                                            },
                                            { "IN": [] },
                                            {
                                              "struct": [
                                                { "(": [] },
                                                { "string:'Europe'": [] },
                                                { ",": [] },
                                                { "string:'Africa'": [] },
                                                { ")": [] }
                                              ]
                                            }
                                          ]
                                        },
                                        { "THEN": [] },
                                        { "string:'EMEA'": [] }
                                      ]
                                    },
                                    {
                                      "casewhen_clause": [
                                        { "WHEN_MATCHED": [] },
                                        {
                                          "binary_expression": [
                                            {
                                              "identifier:c.region": [
                                                { ".": [] }
                                              ]
                                            },
                                            { "=": [] },
                                            { "string:'Asia'": [] }
                                          ]
                                        },
                                        { "THEN": [] },
                                        { "string:'APAC'": [] }
                                      ]
                                    },
                                    {
                                      "caseelse_clause": [
                                        { "ELSE": [] },
                                        { "NULL": [{ "NOT_NULL": [] }] }
                                      ]
                                    },
                                    { "END_IF": [] }
                                  ]
                                },
                                {
                                  "as_alias": [
                                    { "AS": [] },
                                    { "identifier:macro_region": [] }
                                  ]
                                }
                              ]
                            },
                            { ",": [] },
                            { "comment": [] },
                            {
                              "_aliasable_expression": [
                                {
                                  "function_call": [
                                    { "identifier:IIF": [] },
                                    { "(": [] },
                                    {
                                      "argument": [
                                        {
                                          "binary_expression": [
                                            {
                                              "identifier:a.industry": [
                                                { ".": [] }
                                              ]
                                            },
                                            { "=": [] },
                                            {
                                              "string:'Information Technology'": []
                                            }
                                          ]
                                        }
                                      ]
                                    },
                                    { ",": [] },
                                    { "argument": [{ "string:'IT'": [] }] },
                                    { ",": [] },
                                    { "argument": [{ "string:'Non-IT'": [] }] },
                                    { ")": [] }
                                  ]
                                },
                                {
                                  "as_alias": [
                                    { "AS": [] },
                                    { "identifier:industry_it": [] }
                                  ]
                                }
                              ]
                            },
                            { ",": [] },
                            {
                              "_aliasable_expression": [
                                {
                                  "function_call": [
                                    { "identifier:SUM": [] },
                                    { "(": [] },
                                    {
                                      "argument": [
                                        {
                                          "identifier:ar.revenue": [{ ".": [] }]
                                        }
                                      ]
                                    },
                                    { ")": [] }
                                  ]
                                },
                                {
                                  "as_alias": [
                                    { "AS": [] },
                                    { "identifier:revenue": [] }
                                  ]
                                }
                              ]
                            },
                            { ",": [] },
                            {
                              "_aliasable_expression": [
                                {
                                  "function_call": [
                                    { "identifier:COUNT": [] },
                                    { "(": [] },
                                    {
                                      "_keyword_distinct": [
                                        { "DISTINCT_FROM": [] }
                                      ]
                                    },
                                    {
                                      "argument": [
                                        {
                                          "identifier:ar.account_id": [
                                            { ".": [] }
                                          ]
                                        }
                                      ]
                                    },
                                    { ")": [] }
                                  ]
                                },
                                {
                                  "as_alias": [
                                    { "AS": [] },
                                    { "identifier:accounts": [] }
                                  ]
                                }
                              ]
                            },
                            { ",": [] },
                            {
                              "_aliasable_expression": [
                                {
                                  "binary_expression": [
                                    {
                                      "function_call": [
                                        { "identifier:SUM": [] },
                                        { "(": [] },
                                        {
                                          "argument": [
                                            {
                                              "identifier:ar.revenue": [
                                                { ".": [] }
                                              ]
                                            }
                                          ]
                                        },
                                        { ")": [] }
                                      ]
                                    },
                                    { "/": [] },
                                    {
                                      "function_call": [
                                        { "identifier:COUNT": [] },
                                        { "(": [] },
                                        {
                                          "_keyword_distinct": [
                                            { "DISTINCT_FROM": [] }
                                          ]
                                        },
                                        {
                                          "argument": [
                                            {
                                              "identifier:ar.account_id": [
                                                { ".": [] }
                                              ]
                                            }
                                          ]
                                        },
                                        { ")": [] }
                                      ]
                                    }
                                  ]
                                },
                                {
                                  "as_alias": [
                                    { "AS": [] },
                                    { "identifier:revenue_per_account": [] }
                                  ]
                                }
                              ]
                            }
                          ]
                        },
                        {
                          "from_clause": [
                            { "FROM": [] },
                            {
                              "from_item": [
                                {
                                  "join_operation": [
                                    {
                                      "from_item": [
                                        {
                                          "join_operation": [
                                            {
                                              "from_item": [
                                                {
                                                  "identifier:accounts_revenue": []
                                                },
                                                {
                                                  "as_alias": [
                                                    { "identifier:ar": [] }
                                                  ]
                                                }
                                              ]
                                            },
                                            { "join_type": [{ "LEFT": [] }] },
                                            { "JOIN": [] },
                                            {
                                              "from_item": [
                                                { "identifier:accounts": [] },
                                                {
                                                  "as_alias": [
                                                    { "identifier:a": [] }
                                                  ]
                                                }
                                              ]
                                            },
                                            {
                                              "join_condition": [
                                                { "USING": [] },
                                                { "(": [] },
                                                { "identifier:account_id": [] },
                                                { ")": [] }
                                              ]
                                            }
                                          ]
                                        }
                                      ]
                                    },
                                    { "join_type": [{ "LEFT": [] }] },
                                    { "JOIN": [] },
                                    {
                                      "from_item": [
                                        { "identifier:countries": [] },
                                        { "as_alias": [{ "identifier:c": [] }] }
                                      ]
                                    },
                                    {
                                      "join_condition": [
                                        { "USING": [] },
                                        { "(": [] },
                                        { "identifier:country": [] },
                                        { ")": [] }
                                      ]
                                    }
                                  ]
                                }
                              ]
                            }
                          ]
                        },
                        {
                          "where_clause": [
                            { "WHERE": [] },
                            { "comment": [] },
                            {
                              "binary_expression": [
                                {
                                  "binary_expression": [
                                    { "identifier:a.industry": [{ ".": [] }] },
                                    { "IN": [] },
                                    {
                                      "struct": [
                                        { "(": [] },
                                        {
                                          "string:'Information Technology'": []
                                        },
                                        { ",": [] },
                                        {
                                          "string:'Telecommunication Services'": []
                                        },
                                        { ")": [] }
                                      ]
                                    }
                                  ]
                                },
                                { "comment": [] },
                                { "AND": [] },
                                {
                                  "between_operator": [
                                    { "identifier:date_month": [] },
                                    { "BETWEEN": [] },
                                    {
                                      "_expression": [
                                        {
                                          "function_call": [
                                            {
                                              "identifier:DATE": [
                                                { "DATE": [] }
                                              ]
                                            },
                                            { "(": [] },
                                            {
                                              "argument": [
                                                { "string:'now'": [] }
                                              ]
                                            },
                                            { ",": [] },
                                            {
                                              "argument": [
                                                { "string:'-24 months'": [] }
                                              ]
                                            },
                                            { ")": [] }
                                          ]
                                        }
                                      ]
                                    },
                                    { "AND": [] },
                                    {
                                      "_expression": [
                                        {
                                          "function_call": [
                                            {
                                              "identifier:DATE": [
                                                { "DATE": [] }
                                              ]
                                            },
                                            { "(": [] },
                                            {
                                              "argument": [
                                                { "string:'now'": [] }
                                              ]
                                            },
                                            { ")": [] }
                                          ]
                                        }
                                      ]
                                    }
                                  ]
                                }
                              ]
                            }
                          ]
                        },
                        {
                          "group_by_clause": [
                            { "GROUP_BY": [] },
                            { "GROUP_BY": [] },
                            {
                              "grouping_item": [{ "identifier:date_year": [] }]
                            },
                            { ",": [] },
                            {
                              "grouping_item": [
                                { "identifier:macro_region": [] }
                              ]
                            },
                            { ",": [] },
                            {
                              "grouping_item": [
                                { "identifier:industry_it": [] }
                              ]
                            }
                          ]
                        }
                      ]
                    }
                  ]
                }
              ]
            }
          ]
        }
      ]
    },
    "0-accounts.sql": {
      "root": [
        {
          "source_file": [
            { "comment": [] },
            { "comment": [] },
            {
              "drop_table_statement": [
                { "DROP_PRIMARY_KEY": [] },
                { "TABLE": [] },
                {
                  "keyword_if_exists": [{ "IF": [] }, { "IF_NOT_EXISTS": [] }]
                },
                { "identifier:date_ranges": [] }
              ]
            },
            { ";": [] },
            {
              "create_table_statement": [
                { "CREATE": [] },
                { "TABLE": [] },
                { "identifier:date_ranges": [] },
                { "AS": [] },
                {
                  "query_statement": [
                    {
                      "query_expr": [
                        {
                          "cte_clause": [
                            { "REMOTE_WITH_CONNECTION": [] },
                            { "with_recursive_keyword": [] },
                            {
                              "cte": [
                                { "identifier:date_ranges": [] },
                                { "ERROR": [{ "(": [] }, { ")": [] }] },
                                { "AS": [] },
                                { "(": [] },
                                {
                                  "query_expr": [
                                    {
                                      "set_operation": [
                                        {
                                          "query_expr": [
                                            {
                                              "select": [
                                                { "SELECT": [] },
                                                {
                                                  "select_list": [
                                                    {
                                                      "_aliasable_expression": [
                                                        {
                                                          "function_call": [
                                                            {
                                                              "identifier:date": [
                                                                { "DATE": [] }
                                                              ]
                                                            },
                                                            { "(": [] },
                                                            {
                                                              "argument": [
                                                                {
                                                                  "function_call": [
                                                                    {
                                                                      "identifier:MIN": []
                                                                    },
                                                                    { "(": [] },
                                                                    {
                                                                      "argument": [
                                                                        {
                                                                          "casewhen_expression": [
                                                                            {
                                                                              "CASE": []
                                                                            },
                                                                            {
                                                                              "casewhen_clause": [
                                                                                {
                                                                                  "WHEN_MATCHED": []
                                                                                },
                                                                                {
                                                                                  "binary_expression": [
                                                                                    {
                                                                                      "identifier:d.stage_date": [
                                                                                        {
                                                                                          ".": []
                                                                                        }
                                                                                      ]
                                                                                    },
                                                                                    {
                                                                                      "<": []
                                                                                    },
                                                                                    {
                                                                                      "identifier:d.contract_start_date": [
                                                                                        {
                                                                                          ".": []
                                                                                        }
                                                                                      ]
                                                                                    }
                                                                                  ]
                                                                                },
                                                                                {
                                                                                  "THEN": []
                                                                                },
                                                                                {
                                                                                  "identifier:d.stage_date": [
                                                                                    {
                                                                                      ".": []
                                                                                    }
                                                                                  ]
                                                                                }
                                                                              ]
                                                                            },
                                                                            {
                                                                              "caseelse_clause": [
                                                                                {
                                                                                  "ELSE": []
                                                                                },
                                                                                {
                                                                                  "identifier:d.contract_start_date": [
                                                                                    {
                                                                                      ".": []
                                                                                    }
                                                                                  ]
                                                                                }
                                                                              ]
                                                                            },
                                                                            {
                                                                              "END_IF": []
                                                                            }
                                                                          ]
                                                                        }
                                                                      ]
                                                                    },
                                                                    { ")": [] }
                                                                  ]
                                                                }
                                                              ]
                                                            },
                                                            { ")": [] }
                                                          ]
                                                        },
                                                        {
                                                          "as_alias": [
                                                            { "AS": [] },
                                                            {
                                                              "identifier:date_month": []
                                                            }
                                                          ]
                                                        }
                                                      ]
                                                    }
                                                  ]
                                                },
                                                {
                                                  "from_clause": [
                                                    { "FROM": [] },
                                                    {
                                                      "from_item": [
                                                        {
                                                          "identifier:deals": []
                                                        },
                                                        {
                                                          "as_alias": [
                                                            {
                                                              "identifier:d": []
                                                            }
                                                          ]
                                                        }
                                                      ]
                                                    }
                                                  ]
                                                }
                                              ]
                                            }
                                          ]
                                        },
                                        { "UNION_ALL": [] },
                                        { "ALL": [] },
                                        {
                                          "query_expr": [
                                            {
                                              "select": [
                                                { "SELECT": [] },
                                                {
                                                  "select_list": [
                                                    {
                                                      "_aliasable_expression": [
                                                        {
                                                          "function_call": [
                                                            {
                                                              "identifier:date": [
                                                                { "DATE": [] }
                                                              ]
                                                            },
                                                            { "(": [] },
                                                            {
                                                              "argument": [
                                                                {
                                                                  "identifier:date_day": []
                                                                }
                                                              ]
                                                            },
                                                            { ",": [] },
                                                            {
                                                              "argument": [
                                                                {
                                                                  "string:'+1 day'": []
                                                                }
                                                              ]
                                                            },
                                                            { ")": [] }
                                                          ]
                                                        }
                                                      ]
                                                    }
                                                  ]
                                                },
                                                {
                                                  "from_clause": [
                                                    { "FROM": [] },
                                                    {
                                                      "from_item": [
                                                        {
                                                          "identifier:date_ranges": []
                                                        }
                                                      ]
                                                    }
                                                  ]
                                                },
                                                {
                                                  "where_clause": [
                                                    { "WHERE": [] },
                                                    {
                                                      "binary_expression": [
                                                        {
                                                          "identifier:date_day": []
                                                        },
                                                        { "<": [] },
                                                        {
                                                          "select_subexpression": [
                                                            { "(": [] },
                                                            {
                                                              "query_expr": [
                                                                {
                                                                  "select": [
                                                                    {
                                                                      "SELECT": []
                                                                    },
                                                                    {
                                                                      "select_list": [
                                                                        {
                                                                          "_aliasable_expression": [
                                                                            {
                                                                              "function_call": [
                                                                                {
                                                                                  "identifier:date": [
                                                                                    {
                                                                                      "DATE": []
                                                                                    }
                                                                                  ]
                                                                                },
                                                                                {
                                                                                  "(": []
                                                                                },
                                                                                {
                                                                                  "argument": [
                                                                                    {
                                                                                      "function_call": [
                                                                                        {
                                                                                          "identifier:MAX": []
                                                                                        },
                                                                                        {
                                                                                          "(": []
                                                                                        },
                                                                                        {
                                                                                          "argument": [
                                                                                            {
                                                                                              "casewhen_expression": [
                                                                                                {
                                                                                                  "CASE": []
                                                                                                },
                                                                                                {
                                                                                                  "casewhen_clause": [
                                                                                                    {
                                                                                                      "WHEN_MATCHED": []
                                                                                                    },
                                                                                                    {
                                                                                                      "binary_expression": [
                                                                                                        {
                                                                                                          "identifier:d.contract_end_date": [
                                                                                                            {
                                                                                                              ".": []
                                                                                                            }
                                                                                                          ]
                                                                                                        },
                                                                                                        {
                                                                                                          ">": []
                                                                                                        },
                                                                                                        {
                                                                                                          "identifier:d.stage_date": [
                                                                                                            {
                                                                                                              ".": []
                                                                                                            }
                                                                                                          ]
                                                                                                        }
                                                                                                      ]
                                                                                                    },
                                                                                                    {
                                                                                                      "THEN": []
                                                                                                    },
                                                                                                    {
                                                                                                      "identifier:d.contract_end_date": [
                                                                                                        {
                                                                                                          ".": []
                                                                                                        }
                                                                                                      ]
                                                                                                    }
                                                                                                  ]
                                                                                                },
                                                                                                {
                                                                                                  "caseelse_clause": [
                                                                                                    {
                                                                                                      "ELSE": []
                                                                                                    },
                                                                                                    {
                                                                                                      "identifier:d.stage_date": [
                                                                                                        {
                                                                                                          ".": []
                                                                                                        }
                                                                                                      ]
                                                                                                    }
                                                                                                  ]
                                                                                                },
                                                                                                {
                                                                                                  "END_IF": []
                                                                                                }
                                                                                              ]
                                                                                            }
                                                                                          ]
                                                                                        },
                                                                                        {
                                                                                          ")": []
                                                                                        }
                                                                                      ]
                                                                                    }
                                                                                  ]
                                                                                },
                                                                                {
                                                                                  ")": []
                                                                                }
                                                                              ]
                                                                            }
                                                                          ]
                                                                        }
                                                                      ]
                                                                    },
                                                                    {
                                                                      "from_clause": [
                                                                        {
                                                                          "FROM": []
                                                                        },
                                                                        {
                                                                          "from_item": [
                                                                            {
                                                                              "identifier:deals": []
                                                                            },
                                                                            {
                                                                              "as_alias": [
                                                                                {
                                                                                  "identifier:d": []
                                                                                }
                                                                              ]
                                                                            }
                                                                          ]
                                                                        }
                                                                      ]
                                                                    }
                                                                  ]
                                                                }
                                                              ]
                                                            },
                                                            { ")": [] }
                                                          ]
                                                        }
                                                      ]
                                                    }
                                                  ]
                                                }
                                              ]
                                            }
                                          ]
                                        }
                                      ]
                                    }
                                  ]
                                },
                                { ")": [] }
                              ]
                            }
                          ]
                        },
                        {
                          "select": [
                            { "SELECT": [] },
                            {
                              "select_list": [
                                {
                                  "_aliasable_expression": [
                                    { "identifier:date_day": [] }
                                  ]
                                }
                              ]
                            },
                            {
                              "from_clause": [
                                { "FROM": [] },
                                {
                                  "from_item": [
                                    { "identifier:date_ranges": [] }
                                  ]
                                }
                              ]
                            },
                            {
                              "group_by_clause": [
                                { "GROUP_BY": [] },
                                { "GROUP_BY": [] },
                                {
                                  "grouping_item": [
                                    { "identifier:date_day": [] }
                                  ]
                                }
                              ]
                            }
                          ]
                        }
                      ]
                    }
                  ]
                }
              ]
            },
            { ";": [] },
            { "comment": [] },
            {
              "drop_table_statement": [
                { "DROP_PRIMARY_KEY": [] },
                { "TABLE": [] },
                {
                  "keyword_if_exists": [{ "IF": [] }, { "IF_NOT_EXISTS": [] }]
                },
                { "identifier:deals_signed": [] }
              ]
            },
            { ";": [] },
            {
              "create_table_statement": [
                { "CREATE": [] },
                { "TABLE": [] },
                { "identifier:deals_signed": [] },
                { "AS": [] },
                {
                  "query_statement": [
                    {
                      "query_expr": [
                        {
                          "select": [
                            { "SELECT": [] },
                            {
                              "select_list": [
                                {
                                  "select_all": [
                                    { "asterisk_expression": [{ "*": [] }] }
                                  ]
                                },
                                { ",": [] },
                                {
                                  "_aliasable_expression": [
                                    {
                                      "binary_expression": [
                                        { "identifier:revenue": [] },
                                        { "/": [] },
                                        {
                                          "identifier:contract_duration_days": []
                                        }
                                      ]
                                    },
                                    {
                                      "as_alias": [
                                        { "AS": [] },
                                        { "identifier:revenue_day": [] }
                                      ]
                                    }
                                  ]
                                },
                                { ",": [] },
                                {
                                  "_aliasable_expression": [
                                    {
                                      "binary_expression": [
                                        { "identifier:revenue_core": [] },
                                        { "/": [] },
                                        {
                                          "identifier:contract_duration_days": []
                                        }
                                      ]
                                    },
                                    {
                                      "as_alias": [
                                        { "AS": [] },
                                        { "identifier:revenue_core_day": [] }
                                      ]
                                    }
                                  ]
                                },
                                { ",": [] },
                                {
                                  "_aliasable_expression": [
                                    {
                                      "binary_expression": [
                                        { "identifier:revenue_aux": [] },
                                        { "/": [] },
                                        {
                                          "identifier:contract_duration_days": []
                                        }
                                      ]
                                    },
                                    {
                                      "as_alias": [
                                        { "AS": [] },
                                        { "identifier:revenue_aux_day": [] }
                                      ]
                                    }
                                  ]
                                }
                              ]
                            },
                            {
                              "from_clause": [
                                { "FROM": [] },
                                {
                                  "from_item": [
                                    {
                                      "select_subexpression": [
                                        { "(": [] },
                                        {
                                          "query_expr": [
                                            {
                                              "select": [
                                                { "SELECT": [] },
                                                {
                                                  "select_list": [
                                                    {
                                                      "_aliasable_expression": [
                                                        {
                                                          "identifier:d.deal_id": [
                                                            { ".": [] }
                                                          ]
                                                        }
                                                      ]
                                                    },
                                                    { ",": [] },
                                                    {
                                                      "_aliasable_expression": [
                                                        {
                                                          "identifier:d.account_id": [
                                                            { ".": [] }
                                                          ]
                                                        }
                                                      ]
                                                    },
                                                    { ",": [] },
                                                    {
                                                      "_aliasable_expression": [
                                                        {
                                                          "identifier:d.contract_start_date": [
                                                            { ".": [] }
                                                          ]
                                                        }
                                                      ]
                                                    },
                                                    { ",": [] },
                                                    {
                                                      "_aliasable_expression": [
                                                        {
                                                          "identifier:d.contract_end_date": [
                                                            { ".": [] }
                                                          ]
                                                        }
                                                      ]
                                                    },
                                                    { ",": [] },
                                                    {
                                                      "_aliasable_expression": [
                                                        {
                                                          "binary_expression": [
                                                            {
                                                              "binary_expression": [
                                                                {
                                                                  "function_call": [
                                                                    {
                                                                      "identifier:julianday": []
                                                                    },
                                                                    { "(": [] },
                                                                    {
                                                                      "argument": [
                                                                        {
                                                                          "identifier:d.contract_end_date": [
                                                                            {
                                                                              ".": []
                                                                            }
                                                                          ]
                                                                        }
                                                                      ]
                                                                    },
                                                                    { ")": [] }
                                                                  ]
                                                                },
                                                                { "-": [] },
                                                                {
                                                                  "function_call": [
                                                                    {
                                                                      "identifier:julianday": []
                                                                    },
                                                                    { "(": [] },
                                                                    {
                                                                      "argument": [
                                                                        {
                                                                          "identifier:d.contract_start_date": [
                                                                            {
                                                                              ".": []
                                                                            }
                                                                          ]
                                                                        }
                                                                      ]
                                                                    },
                                                                    { ")": [] }
                                                                  ]
                                                                }
                                                              ]
                                                            },
                                                            { "+": [] },
                                                            { "number:1": [] }
                                                          ]
                                                        },
                                                        {
                                                          "as_alias": [
                                                            { "AS": [] },
                                                            {
                                                              "identifier:contract_duration_days": []
                                                            }
                                                          ]
                                                        }
                                                      ]
                                                    },
                                                    { ",": [] },
                                                    {
                                                      "_aliasable_expression": [
                                                        {
                                                          "function_call": [
                                                            {
                                                              "identifier:SUM": []
                                                            },
                                                            { "(": [] },
                                                            {
                                                              "argument": [
                                                                {
                                                                  "casewhen_expression": [
                                                                    {
                                                                      "CASE": []
                                                                    },
                                                                    {
                                                                      "casewhen_clause": [
                                                                        {
                                                                          "WHEN_MATCHED": []
                                                                        },
                                                                        {
                                                                          "binary_expression": [
                                                                            {
                                                                              "identifier:o.product": [
                                                                                {
                                                                                  ".": []
                                                                                }
                                                                              ]
                                                                            },
                                                                            {
                                                                              "IN": []
                                                                            },
                                                                            {
                                                                              "struct": [
                                                                                {
                                                                                  "(": []
                                                                                },
                                                                                {
                                                                                  "string:'Subscription Base'": []
                                                                                },
                                                                                {
                                                                                  ",": []
                                                                                },
                                                                                {
                                                                                  "string:'Subscription Premium'": []
                                                                                },
                                                                                {
                                                                                  ")": []
                                                                                }
                                                                              ]
                                                                            }
                                                                          ]
                                                                        },
                                                                        {
                                                                          "THEN": []
                                                                        },
                                                                        {
                                                                          "identifier:o.value": [
                                                                            {
                                                                              ".": []
                                                                            }
                                                                          ]
                                                                        }
                                                                      ]
                                                                    },
                                                                    {
                                                                      "caseelse_clause": [
                                                                        {
                                                                          "ELSE": []
                                                                        },
                                                                        {
                                                                          "number:0": []
                                                                        }
                                                                      ]
                                                                    },
                                                                    {
                                                                      "END_IF": []
                                                                    }
                                                                  ]
                                                                }
                                                              ]
                                                            },
                                                            { ")": [] }
                                                          ]
                                                        },
                                                        {
                                                          "as_alias": [
                                                            { "AS": [] },
                                                            {
                                                              "identifier:revenue_core": []
                                                            }
                                                          ]
                                                        }
                                                      ]
                                                    },
                                                    { ",": [] },
                                                    {
                                                      "_aliasable_expression": [
                                                        {
                                                          "function_call": [
                                                            {
                                                              "identifier:SUM": []
                                                            },
                                                            { "(": [] },
                                                            {
                                                              "argument": [
                                                                {
                                                                  "casewhen_expression": [
                                                                    {
                                                                      "CASE": []
                                                                    },
                                                                    {
                                                                      "casewhen_clause": [
                                                                        {
                                                                          "WHEN_MATCHED": []
                                                                        },
                                                                        {
                                                                          "binary_expression": [
                                                                            {
                                                                              "identifier:o.product": [
                                                                                {
                                                                                  ".": []
                                                                                }
                                                                              ]
                                                                            },
                                                                            {
                                                                              "IN": []
                                                                            },
                                                                            {
                                                                              "struct": [
                                                                                {
                                                                                  "(": []
                                                                                },
                                                                                {
                                                                                  "string:'Training'": []
                                                                                },
                                                                                {
                                                                                  ",": []
                                                                                },
                                                                                {
                                                                                  "string:'Consulting'": []
                                                                                },
                                                                                {
                                                                                  ")": []
                                                                                }
                                                                              ]
                                                                            }
                                                                          ]
                                                                        },
                                                                        {
                                                                          "THEN": []
                                                                        },
                                                                        {
                                                                          "identifier:o.value": [
                                                                            {
                                                                              ".": []
                                                                            }
                                                                          ]
                                                                        }
                                                                      ]
                                                                    },
                                                                    {
                                                                      "caseelse_clause": [
                                                                        {
                                                                          "ELSE": []
                                                                        },
                                                                        {
                                                                          "number:0": []
                                                                        }
                                                                      ]
                                                                    },
                                                                    {
                                                                      "END_IF": []
                                                                    }
                                                                  ]
                                                                }
                                                              ]
                                                            },
                                                            { ")": [] }
                                                          ]
                                                        },
                                                        {
                                                          "as_alias": [
                                                            { "AS": [] },
                                                            {
                                                              "identifier:revenue_aux": []
                                                            }
                                                          ]
                                                        }
                                                      ]
                                                    },
                                                    { ",": [] },
                                                    {
                                                      "_aliasable_expression": [
                                                        {
                                                          "function_call": [
                                                            {
                                                              "identifier:SUM": []
                                                            },
                                                            { "(": [] },
                                                            {
                                                              "argument": [
                                                                {
                                                                  "identifier:o.value": [
                                                                    { ".": [] }
                                                                  ]
                                                                }
                                                              ]
                                                            },
                                                            { ")": [] }
                                                          ]
                                                        },
                                                        {
                                                          "as_alias": [
                                                            { "AS": [] },
                                                            {
                                                              "identifier:revenue": []
                                                            }
                                                          ]
                                                        }
                                                      ]
                                                    }
                                                  ]
                                                },
                                                {
                                                  "from_clause": [
                                                    { "FROM": [] },
                                                    {
                                                      "from_item": [
                                                        {
                                                          "join_operation": [
                                                            {
                                                              "from_item": [
                                                                {
                                                                  "identifier:orders": []
                                                                },
                                                                {
                                                                  "as_alias": [
                                                                    {
                                                                      "identifier:o": []
                                                                    }
                                                                  ]
                                                                }
                                                              ]
                                                            },
                                                            { "JOIN": [] },
                                                            {
                                                              "from_item": [
                                                                {
                                                                  "identifier:deals": []
                                                                },
                                                                {
                                                                  "as_alias": [
                                                                    {
                                                                      "identifier:d": []
                                                                    }
                                                                  ]
                                                                }
                                                              ]
                                                            },
                                                            {
                                                              "join_condition": [
                                                                { "USING": [] },
                                                                { "(": [] },
                                                                {
                                                                  "identifier:deal_id": []
                                                                },
                                                                { ",": [] },
                                                                {
                                                                  "identifier:order_id": []
                                                                },
                                                                { ")": [] }
                                                              ]
                                                            }
                                                          ]
                                                        }
                                                      ]
                                                    }
                                                  ]
                                                },
                                                {
                                                  "where_clause": [
                                                    { "WHERE": [] },
                                                    {
                                                      "binary_expression": [
                                                        {
                                                          "identifier:d.stage": [
                                                            { ".": [] }
                                                          ]
                                                        },
                                                        { "=": [] },
                                                        { "number:4": [] }
                                                      ]
                                                    }
                                                  ]
                                                },
                                                {
                                                  "group_by_clause": [
                                                    { "GROUP_BY": [] },
                                                    { "GROUP_BY": [] },
                                                    {
                                                      "grouping_item": [
                                                        {
                                                          "identifier:d.deal_id": [
                                                            { ".": [] }
                                                          ]
                                                        }
                                                      ]
                                                    },
                                                    { ",": [] },
                                                    {
                                                      "grouping_item": [
                                                        {
                                                          "identifier:d.account_id": [
                                                            { ".": [] }
                                                          ]
                                                        }
                                                      ]
                                                    },
                                                    { ",": [] },
                                                    {
                                                      "grouping_item": [
                                                        {
                                                          "identifier:d.contract_start_date": [
                                                            { ".": [] }
                                                          ]
                                                        }
                                                      ]
                                                    },
                                                    { ",": [] },
                                                    {
                                                      "grouping_item": [
                                                        {
                                                          "identifier:d.contract_end_date": [
                                                            { ".": [] }
                                                          ]
                                                        }
                                                      ]
                                                    }
                                                  ]
                                                }
                                              ]
                                            }
                                          ]
                                        },
                                        { ")": [] }
                                      ]
                                    },
                                    {
                                      "as_alias": [
                                        { "AS": [] },
                                        { "identifier:t": [] }
                                      ]
                                    }
                                  ]
                                }
                              ]
                            }
                          ]
                        }
                      ]
                    }
                  ]
                }
              ]
            },
            { ";": [] },
            { "comment": [] },
            {
              "drop_table_statement": [
                { "DROP_PRIMARY_KEY": [] },
                { "TABLE": [] },
                {
                  "keyword_if_exists": [{ "IF": [] }, { "IF_NOT_EXISTS": [] }]
                },
                { "identifier:accounts_revenue": [] }
              ]
            },
            { ";": [] },
            {
              "create_table_statement": [
                { "CREATE": [] },
                { "TABLE": [] },
                { "identifier:accounts_revenue": [] },
                { "AS": [] },
                {
                  "query_statement": [
                    {
                      "query_expr": [
                        {
                          "select": [
                            { "SELECT": [] },
                            {
                              "select_list": [
                                {
                                  "_aliasable_expression": [
                                    { "identifier:t.date_month": [{ ".": [] }] }
                                  ]
                                },
                                { ",": [] },
                                {
                                  "_aliasable_expression": [
                                    { "identifier:t.account_id": [{ ".": [] }] }
                                  ]
                                },
                                { ",": [] },
                                {
                                  "_aliasable_expression": [
                                    {
                                      "function_call": [
                                        { "identifier:AVG": [] },
                                        { "(": [] },
                                        {
                                          "argument": [
                                            {
                                              "identifier:t.deals": [
                                                { ".": [] }
                                              ]
                                            }
                                          ]
                                        },
                                        { ")": [] }
                                      ]
                                    },
                                    {
                                      "as_alias": [
                                        { "AS": [] },
                                        { "identifier:deals": [] }
                                      ]
                                    }
                                  ]
                                },
                                { ",": [] },
                                {
                                  "_aliasable_expression": [
                                    {
                                      "function_call": [
                                        { "identifier:SUM": [] },
                                        { "(": [] },
                                        {
                                          "argument": [
                                            {
                                              "identifier:t.revenue_core": [
                                                { ".": [] }
                                              ]
                                            }
                                          ]
                                        },
                                        { ")": [] }
                                      ]
                                    },
                                    {
                                      "as_alias": [
                                        { "AS": [] },
                                        { "identifier:revenue_core": [] }
                                      ]
                                    }
                                  ]
                                },
                                { ",": [] },
                                {
                                  "_aliasable_expression": [
                                    {
                                      "function_call": [
                                        { "identifier:SUM": [] },
                                        { "(": [] },
                                        {
                                          "argument": [
                                            {
                                              "identifier:t.revenue_aux": [
                                                { ".": [] }
                                              ]
                                            }
                                          ]
                                        },
                                        { ")": [] }
                                      ]
                                    },
                                    {
                                      "as_alias": [
                                        { "AS": [] },
                                        { "identifier:revenue_aux": [] }
                                      ]
                                    }
                                  ]
                                },
                                { ",": [] },
                                {
                                  "_aliasable_expression": [
                                    {
                                      "function_call": [
                                        { "identifier:SUM": [] },
                                        { "(": [] },
                                        {
                                          "argument": [
                                            {
                                              "identifier:t.revenue": [
                                                { ".": [] }
                                              ]
                                            }
                                          ]
                                        },
                                        { ")": [] }
                                      ]
                                    },
                                    {
                                      "as_alias": [
                                        { "AS": [] },
                                        { "identifier:revenue": [] }
                                      ]
                                    }
                                  ]
                                }
                              ]
                            },
                            {
                              "from_clause": [
                                { "FROM": [] },
                                {
                                  "from_item": [
                                    {
                                      "select_subexpression": [
                                        { "(": [] },
                                        {
                                          "query_expr": [
                                            {
                                              "select": [
                                                { "SELECT": [] },
                                                {
                                                  "select_list": [
                                                    {
                                                      "_aliasable_expression": [
                                                        {
                                                          "identifier:dr.date_day": [
                                                            { ".": [] }
                                                          ]
                                                        }
                                                      ]
                                                    },
                                                    { ",": [] },
                                                    {
                                                      "_aliasable_expression": [
                                                        {
                                                          "function_call": [
                                                            {
                                                              "identifier:DATE": [
                                                                { "DATE": [] }
                                                              ]
                                                            },
                                                            { "(": [] },
                                                            {
                                                              "argument": [
                                                                {
                                                                  "identifier:date_day": []
                                                                }
                                                              ]
                                                            },
                                                            { ",": [] },
                                                            {
                                                              "argument": [
                                                                {
                                                                  "string:'start of month'": []
                                                                }
                                                              ]
                                                            },
                                                            { ")": [] }
                                                          ]
                                                        },
                                                        {
                                                          "as_alias": [
                                                            { "AS": [] },
                                                            {
                                                              "identifier:date_month": []
                                                            }
                                                          ]
                                                        }
                                                      ]
                                                    },
                                                    { ",": [] },
                                                    {
                                                      "_aliasable_expression": [
                                                        {
                                                          "identifier:ds.account_id": [
                                                            { ".": [] }
                                                          ]
                                                        }
                                                      ]
                                                    },
                                                    { ",": [] },
                                                    {
                                                      "_aliasable_expression": [
                                                        {
                                                          "function_call": [
                                                            {
                                                              "identifier:COUNT": []
                                                            },
                                                            { "(": [] },
                                                            {
                                                              "argument": [
                                                                {
                                                                  "identifier:ds.deal_id": [
                                                                    { ".": [] }
                                                                  ]
                                                                }
                                                              ]
                                                            },
                                                            { ")": [] }
                                                          ]
                                                        },
                                                        {
                                                          "as_alias": [
                                                            { "AS": [] },
                                                            {
                                                              "identifier:deals": []
                                                            }
                                                          ]
                                                        }
                                                      ]
                                                    },
                                                    { ",": [] },
                                                    {
                                                      "_aliasable_expression": [
                                                        {
                                                          "function_call": [
                                                            {
                                                              "identifier:SUM": []
                                                            },
                                                            { "(": [] },
                                                            {
                                                              "argument": [
                                                                {
                                                                  "identifier:ds.revenue_core_day": [
                                                                    { ".": [] }
                                                                  ]
                                                                }
                                                              ]
                                                            },
                                                            { ")": [] }
                                                          ]
                                                        },
                                                        {
                                                          "as_alias": [
                                                            { "AS": [] },
                                                            {
                                                              "identifier:revenue_core": []
                                                            }
                                                          ]
                                                        }
                                                      ]
                                                    },
                                                    { ",": [] },
                                                    {
                                                      "_aliasable_expression": [
                                                        {
                                                          "function_call": [
                                                            {
                                                              "identifier:SUM": []
                                                            },
                                                            { "(": [] },
                                                            {
                                                              "argument": [
                                                                {
                                                                  "identifier:ds.revenue_aux_day": [
                                                                    { ".": [] }
                                                                  ]
                                                                }
                                                              ]
                                                            },
                                                            { ")": [] }
                                                          ]
                                                        },
                                                        {
                                                          "as_alias": [
                                                            { "AS": [] },
                                                            {
                                                              "identifier:revenue_aux": []
                                                            }
                                                          ]
                                                        }
                                                      ]
                                                    },
                                                    { ",": [] },
                                                    {
                                                      "_aliasable_expression": [
                                                        {
                                                          "function_call": [
                                                            {
                                                              "identifier:SUM": []
                                                            },
                                                            { "(": [] },
                                                            {
                                                              "argument": [
                                                                {
                                                                  "identifier:ds.revenue_day": [
                                                                    { ".": [] }
                                                                  ]
                                                                }
                                                              ]
                                                            },
                                                            { ")": [] }
                                                          ]
                                                        },
                                                        {
                                                          "as_alias": [
                                                            { "AS": [] },
                                                            {
                                                              "identifier:revenue": []
                                                            }
                                                          ]
                                                        }
                                                      ]
                                                    }
                                                  ]
                                                },
                                                {
                                                  "from_clause": [
                                                    { "FROM": [] },
                                                    {
                                                      "from_item": [
                                                        {
                                                          "join_operation": [
                                                            {
                                                              "from_item": [
                                                                {
                                                                  "identifier:date_ranges": []
                                                                },
                                                                {
                                                                  "as_alias": [
                                                                    {
                                                                      "identifier:dr": []
                                                                    }
                                                                  ]
                                                                }
                                                              ]
                                                            },
                                                            {
                                                              "join_type": [
                                                                { "LEFT": [] }
                                                              ]
                                                            },
                                                            { "JOIN": [] },
                                                            {
                                                              "from_item": [
                                                                {
                                                                  "identifier:deals_signed": []
                                                                },
                                                                {
                                                                  "as_alias": [
                                                                    {
                                                                      "identifier:ds": []
                                                                    }
                                                                  ]
                                                                }
                                                              ]
                                                            },
                                                            {
                                                              "join_condition": [
                                                                { "ON": [] },
                                                                {
                                                                  "binary_expression": [
                                                                    {
                                                                      "binary_expression": [
                                                                        {
                                                                          "identifier:dr.date_day": [
                                                                            {
                                                                              ".": []
                                                                            }
                                                                          ]
                                                                        },
                                                                        {
                                                                          ">=": []
                                                                        },
                                                                        {
                                                                          "function_call": [
                                                                            {
                                                                              "identifier:date": [
                                                                                {
                                                                                  "DATE": []
                                                                                }
                                                                              ]
                                                                            },
                                                                            {
                                                                              "(": []
                                                                            },
                                                                            {
                                                                              "argument": [
                                                                                {
                                                                                  "identifier:ds.contract_start_date": [
                                                                                    {
                                                                                      ".": []
                                                                                    }
                                                                                  ]
                                                                                }
                                                                              ]
                                                                            },
                                                                            {
                                                                              ")": []
                                                                            }
                                                                          ]
                                                                        }
                                                                      ]
                                                                    },
                                                                    {
                                                                      "AND": []
                                                                    },
                                                                    {
                                                                      "binary_expression": [
                                                                        {
                                                                          "identifier:dr.date_day": [
                                                                            {
                                                                              ".": []
                                                                            }
                                                                          ]
                                                                        },
                                                                        {
                                                                          "<=": []
                                                                        },
                                                                        {
                                                                          "function_call": [
                                                                            {
                                                                              "identifier:date": [
                                                                                {
                                                                                  "DATE": []
                                                                                }
                                                                              ]
                                                                            },
                                                                            {
                                                                              "(": []
                                                                            },
                                                                            {
                                                                              "argument": [
                                                                                {
                                                                                  "identifier:ds.contract_end_date": [
                                                                                    {
                                                                                      ".": []
                                                                                    }
                                                                                  ]
                                                                                }
                                                                              ]
                                                                            },
                                                                            {
                                                                              ")": []
                                                                            }
                                                                          ]
                                                                        }
                                                                      ]
                                                                    }
                                                                  ]
                                                                }
                                                              ]
                                                            }
                                                          ]
                                                        }
                                                      ]
                                                    }
                                                  ]
                                                },
                                                {
                                                  "group_by_clause": [
                                                    { "GROUP_BY": [] },
                                                    { "GROUP_BY": [] },
                                                    {
                                                      "grouping_item": [
                                                        {
                                                          "identifier:dr.date_day": [
                                                            { ".": [] }
                                                          ]
                                                        }
                                                      ]
                                                    },
                                                    { ",": [] },
                                                    {
                                                      "grouping_item": [
                                                        {
                                                          "identifier:ds.account_id": [
                                                            { ".": [] }
                                                          ]
                                                        }
                                                      ]
                                                    }
                                                  ]
                                                }
                                              ]
                                            }
                                          ]
                                        },
                                        { ")": [] }
                                      ]
                                    },
                                    { "as_alias": [{ "identifier:t": [] }] }
                                  ]
                                }
                              ]
                            },
                            {
                              "group_by_clause": [
                                { "GROUP_BY": [] },
                                { "GROUP_BY": [] },
                                {
                                  "grouping_item": [
                                    { "identifier:account_id": [] }
                                  ]
                                },
                                { ",": [] },
                                {
                                  "grouping_item": [
                                    { "identifier:date_month": [] }
                                  ]
                                }
                              ]
                            }
                          ]
                        }
                      ]
                    }
                  ]
                }
              ]
            },
            { ";": [] },
            { "comment": [] },
            {
              "drop_table_statement": [
                { "DROP_PRIMARY_KEY": [] },
                { "TABLE": [] },
                {
                  "keyword_if_exists": [{ "IF": [] }, { "IF_NOT_EXISTS": [] }]
                },
                { "identifier:accounts_360": [] }
              ]
            },
            { ";": [] },
            {
              "create_table_statement": [
                { "CREATE": [] },
                { "TABLE": [] },
                { "identifier:accounts_360": [] },
                { "AS": [] },
                {
                  "query_statement": [
                    {
                      "query_expr": [
                        {
                          "select": [
                            { "SELECT": [] },
                            {
                              "select_list": [
                                {
                                  "select_all": [
                                    {
                                      "asterisk_expression": [
                                        { ".": [] },
                                        { "*": [] }
                                      ]
                                    }
                                  ]
                                },
                                { ",": [] },
                                {
                                  "_aliasable_expression": [
                                    {
                                      "casewhen_expression": [
                                        { "CASE": [] },
                                        {
                                          "casewhen_clause": [
                                            { "WHEN_MATCHED": [] },
                                            {
                                              "binary_expression": [
                                                {
                                                  "identifier:t.revenue_12m": [
                                                    { ".": [] }
                                                  ]
                                                },
                                                { "<=": [] },
                                                { "number:300": [] }
                                              ]
                                            },
                                            { "THEN": [] },
                                            { "string:'Small'": [] }
                                          ]
                                        },
                                        {
                                          "casewhen_clause": [
                                            { "WHEN_MATCHED": [] },
                                            {
                                              "binary_expression": [
                                                {
                                                  "binary_expression": [
                                                    {
                                                      "identifier:t.revenue_12m": [
                                                        { ".": [] }
                                                      ]
                                                    },
                                                    { ">": [] },
                                                    { "number:300": [] }
                                                  ]
                                                },
                                                { "AND": [] },
                                                {
                                                  "binary_expression": [
                                                    {
                                                      "identifier:t.revenue_12m": [
                                                        { ".": [] }
                                                      ]
                                                    },
                                                    { "<=": [] },
                                                    { "number:600": [] }
                                                  ]
                                                }
                                              ]
                                            },
                                            { "THEN": [] },
                                            { "string:'Medium'": [] }
                                          ]
                                        },
                                        {
                                          "casewhen_clause": [
                                            { "WHEN_MATCHED": [] },
                                            {
                                              "binary_expression": [
                                                {
                                                  "identifier:t.revenue_12m": [
                                                    { ".": [] }
                                                  ]
                                                },
                                                { ">": [] },
                                                { "number:600": [] }
                                              ]
                                            },
                                            { "THEN": [] },
                                            { "string:'Large'": [] }
                                          ]
                                        },
                                        {
                                          "caseelse_clause": [
                                            { "ELSE": [] },
                                            { "NULL": [{ "NOT_NULL": [] }] }
                                          ]
                                        },
                                        { "END_IF": [] }
                                      ]
                                    },
                                    {
                                      "as_alias": [
                                        { "AS": [] },
                                        { "identifier:account_size": [] }
                                      ]
                                    }
                                  ]
                                }
                              ]
                            },
                            {
                              "from_clause": [
                                { "FROM": [] },
                                {
                                  "from_item": [
                                    {
                                      "select_subexpression": [
                                        { "(": [] },
                                        {
                                          "query_expr": [
                                            {
                                              "select": [
                                                { "SELECT": [] },
                                                {
                                                  "select_list": [
                                                    {
                                                      "_aliasable_expression": [
                                                        {
                                                          "identifier:account_id": []
                                                        }
                                                      ]
                                                    },
                                                    { ",": [] },
                                                    {
                                                      "_aliasable_expression": [
                                                        {
                                                          "identifier:date_month": []
                                                        }
                                                      ]
                                                    },
                                                    { ",": [] },
                                                    {
                                                      "_aliasable_expression": [
                                                        {
                                                          "identifier:revenue": []
                                                        }
                                                      ]
                                                    },
                                                    { ",": [] },
                                                    {
                                                      "_aliasable_expression": [
                                                        {
                                                          "identifier:revenue_core": []
                                                        }
                                                      ]
                                                    },
                                                    { ",": [] },
                                                    {
                                                      "_aliasable_expression": [
                                                        {
                                                          "identifier:revenue_aux": []
                                                        }
                                                      ]
                                                    },
                                                    { ",": [] },
                                                    {
                                                      "_aliasable_expression": [
                                                        {
                                                          "identifier:deals": []
                                                        }
                                                      ]
                                                    },
                                                    { ",": [] },
                                                    {
                                                      "_aliasable_expression": [
                                                        {
                                                          "identifier:accounts.name": [
                                                            { ".": [] }
                                                          ]
                                                        }
                                                      ]
                                                    },
                                                    { ",": [] },
                                                    {
                                                      "_aliasable_expression": [
                                                        {
                                                          "identifier:accounts.industry": [
                                                            { ".": [] }
                                                          ]
                                                        }
                                                      ]
                                                    },
                                                    { ",": [] },
                                                    {
                                                      "_aliasable_expression": [
                                                        {
                                                          "identifier:accounts.country": [
                                                            { ".": [] }
                                                          ]
                                                        }
                                                      ]
                                                    },
                                                    { ",": [] },
                                                    {
                                                      "_aliasable_expression": [
                                                        {
                                                          "casewhen_expression": [
                                                            { "CASE": [] },
                                                            {
                                                              "casewhen_clause": [
                                                                {
                                                                  "WHEN_MATCHED": []
                                                                },
                                                                {
                                                                  "binary_expression": [
                                                                    {
                                                                      "identifier:c.region": [
                                                                        {
                                                                          ".": []
                                                                        }
                                                                      ]
                                                                    },
                                                                    {
                                                                      "IN": []
                                                                    },
                                                                    {
                                                                      "struct": [
                                                                        {
                                                                          "(": []
                                                                        },
                                                                        {
                                                                          "string:'Americas'": []
                                                                        },
                                                                        {
                                                                          ",": []
                                                                        },
                                                                        {
                                                                          "string:'Europe'": []
                                                                        },
                                                                        {
                                                                          ")": []
                                                                        }
                                                                      ]
                                                                    }
                                                                  ]
                                                                },
                                                                { "THEN": [] },
                                                                {
                                                                  "string:'North-West'": []
                                                                }
                                                              ]
                                                            },
                                                            {
                                                              "casewhen_clause": [
                                                                {
                                                                  "WHEN_MATCHED": []
                                                                },
                                                                {
                                                                  "binary_expression": [
                                                                    {
                                                                      "identifier:c.region": [
                                                                        {
                                                                          ".": []
                                                                        }
                                                                      ]
                                                                    },
                                                                    {
                                                                      "IN": []
                                                                    },
                                                                    {
                                                                      "struct": [
                                                                        {
                                                                          "(": []
                                                                        },
                                                                        {
                                                                          "string:'Africa'": []
                                                                        },
                                                                        {
                                                                          ",": []
                                                                        },
                                                                        {
                                                                          "string:'Asia'": []
                                                                        },
                                                                        {
                                                                          ")": []
                                                                        }
                                                                      ]
                                                                    }
                                                                  ]
                                                                },
                                                                { "THEN": [] },
                                                                {
                                                                  "string:'South-East'": []
                                                                }
                                                              ]
                                                            },
                                                            {
                                                              "caseelse_clause": [
                                                                { "ELSE": [] },
                                                                {
                                                                  "NULL": [
                                                                    {
                                                                      "NOT_NULL": []
                                                                    }
                                                                  ]
                                                                }
                                                              ]
                                                            },
                                                            { "END_IF": [] }
                                                          ]
                                                        },
                                                        {
                                                          "as_alias": [
                                                            { "AS": [] },
                                                            {
                                                              "identifier:region_cluster": []
                                                            }
                                                          ]
                                                        }
                                                      ]
                                                    },
                                                    { ",": [] },
                                                    {
                                                      "_aliasable_expression": [
                                                        {
                                                          "identifier:accounts.priority": [
                                                            { ".": [] }
                                                          ]
                                                        }
                                                      ]
                                                    },
                                                    { ",": [] },
                                                    {
                                                      "_aliasable_expression": [
                                                        {
                                                          "function_call": [
                                                            {
                                                              "identifier:SUM": []
                                                            },
                                                            { "(": [] },
                                                            {
                                                              "argument": [
                                                                {
                                                                  "identifier:revenue": []
                                                                }
                                                              ]
                                                            },
                                                            { ")": [] },
                                                            {
                                                              "analytics_clause": [
                                                                { "OVER": [] },
                                                                {
                                                                  "over_clause": [
                                                                    {
                                                                      "window_specification": [
                                                                        {
                                                                          "(": []
                                                                        },
                                                                        {
                                                                          "window_partition_clause": [
                                                                            {
                                                                              "PARTITION_COLUMNS": []
                                                                            },
                                                                            {
                                                                              "GROUP_BY": []
                                                                            },
                                                                            {
                                                                              "_expression": [
                                                                                {
                                                                                  "identifier:account_id": []
                                                                                }
                                                                              ]
                                                                            }
                                                                          ]
                                                                        },
                                                                        {
                                                                          "order_by_clause": [
                                                                            {
                                                                              "ORDER_BY": []
                                                                            },
                                                                            {
                                                                              "GROUP_BY": []
                                                                            },
                                                                            {
                                                                              "order_by_clause_body": [
                                                                                {
                                                                                  "identifier:date_month": []
                                                                                }
                                                                              ]
                                                                            }
                                                                          ]
                                                                        },
                                                                        {
                                                                          "window_frame_clause": [
                                                                            {
                                                                              "rows_range": [
                                                                                {
                                                                                  "ROWS": []
                                                                                }
                                                                              ]
                                                                            },
                                                                            {
                                                                              "window_frame_between": [
                                                                                {
                                                                                  "BETWEEN": []
                                                                                },
                                                                                {
                                                                                  "window_numeric_preceding": [
                                                                                    {
                                                                                      "number:11": []
                                                                                    },
                                                                                    {
                                                                                      "PRECEDING": []
                                                                                    }
                                                                                  ]
                                                                                },
                                                                                {
                                                                                  "AND": []
                                                                                },
                                                                                {
                                                                                  "between_to": [
                                                                                    {
                                                                                      "keyword_current_row": [
                                                                                        {
                                                                                          "CURRENT_ROW": []
                                                                                        },
                                                                                        {
                                                                                          "ROW": []
                                                                                        }
                                                                                      ]
                                                                                    }
                                                                                  ]
                                                                                }
                                                                              ]
                                                                            }
                                                                          ]
                                                                        },
                                                                        {
                                                                          ")": []
                                                                        }
                                                                      ]
                                                                    }
                                                                  ]
                                                                }
                                                              ]
                                                            }
                                                          ]
                                                        },
                                                        {
                                                          "as_alias": [
                                                            { "AS": [] },
                                                            {
                                                              "identifier:revenue_12m": []
                                                            }
                                                          ]
                                                        }
                                                      ]
                                                    }
                                                  ]
                                                },
                                                {
                                                  "from_clause": [
                                                    { "FROM": [] },
                                                    {
                                                      "from_item": [
                                                        {
                                                          "join_operation": [
                                                            {
                                                              "from_item": [
                                                                {
                                                                  "join_operation": [
                                                                    {
                                                                      "from_item": [
                                                                        {
                                                                          "identifier:accounts_revenue": []
                                                                        }
                                                                      ]
                                                                    },
                                                                    {
                                                                      "JOIN": []
                                                                    },
                                                                    {
                                                                      "from_item": [
                                                                        {
                                                                          "identifier:accounts": []
                                                                        }
                                                                      ]
                                                                    },
                                                                    {
                                                                      "join_condition": [
                                                                        {
                                                                          "USING": []
                                                                        },
                                                                        {
                                                                          "(": []
                                                                        },
                                                                        {
                                                                          "identifier:account_id": []
                                                                        },
                                                                        {
                                                                          ")": []
                                                                        }
                                                                      ]
                                                                    }
                                                                  ]
                                                                }
                                                              ]
                                                            },
                                                            {
                                                              "join_type": [
                                                                { "LEFT": [] }
                                                              ]
                                                            },
                                                            { "JOIN": [] },
                                                            {
                                                              "from_item": [
                                                                {
                                                                  "identifier:countries": []
                                                                },
                                                                {
                                                                  "as_alias": [
                                                                    {
                                                                      "identifier:c": []
                                                                    }
                                                                  ]
                                                                }
                                                              ]
                                                            },
                                                            {
                                                              "join_condition": [
                                                                { "USING": [] },
                                                                { "(": [] },
                                                                {
                                                                  "identifier:country": []
                                                                },
                                                                { ")": [] }
                                                              ]
                                                            }
                                                          ]
                                                        }
                                                      ]
                                                    }
                                                  ]
                                                }
                                              ]
                                            }
                                          ]
                                        },
                                        { ")": [] }
                                      ]
                                    },
                                    {
                                      "as_alias": [
                                        { "AS": [] },
                                        { "identifier:t": [] }
                                      ]
                                    }
                                  ]
                                }
                              ]
                            }
                          ]
                        }
                      ]
                    }
                  ]
                }
              ]
            },
            { ";": [] }
          ]
        }
      ]
    },
    "1-revenue.sql": {
      "root": [
        {
          "source_file": [
            { "comment": [] },
            { "comment": [] },
            {
              "query_statement": [
                {
                  "query_expr": [
                    {
                      "select": [
                        { "SELECT": [] },
                        {
                          "select_list": [
                            {
                              "_aliasable_expression": [
                                {
                                  "function_call": [
                                    { "identifier:date": [{ "DATE": [] }] },
                                    { "(": [] },
                                    {
                                      "argument": [
                                        { "identifier:date_month": [] }
                                      ]
                                    },
                                    { ",": [] },
                                    {
                                      "argument": [
                                        { "string:'start of year'": [] }
                                      ]
                                    },
                                    { ")": [] }
                                  ]
                                },
                                {
                                  "as_alias": [
                                    { "AS": [] },
                                    { "identifier:date_year": [] }
                                  ]
                                }
                              ]
                            },
                            { ",": [] },
                            {
                              "_aliasable_expression": [
                                {
                                  "casewhen_expression": [
                                    { "CASE": [] },
                                    {
                                      "casewhen_clause": [
                                        { "WHEN_MATCHED": [] },
                                        {
                                          "binary_expression": [
                                            {
                                              "identifier:c.region": [
                                                { ".": [] }
                                              ]
                                            },
                                            { "IN": [] },
                                            {
                                              "struct": [
                                                { "(": [] },
                                                { "string:'Americas'": [] },
                                                { ",": [] },
                                                { "string:'Europe'": [] },
                                                { ")": [] }
                                              ]
                                            }
                                          ]
                                        },
                                        { "THEN": [] },
                                        { "string:'North-West'": [] }
                                      ]
                                    },
                                    {
                                      "casewhen_clause": [
                                        { "WHEN_MATCHED": [] },
                                        {
                                          "binary_expression": [
                                            {
                                              "identifier:c.region": [
                                                { ".": [] }
                                              ]
                                            },
                                            { "IN": [] },
                                            {
                                              "struct": [
                                                { "(": [] },
                                                { "string:'Africa'": [] },
                                                { ",": [] },
                                                { "string:'Asia'": [] },
                                                { ")": [] }
                                              ]
                                            }
                                          ]
                                        },
                                        { "THEN": [] },
                                        { "string:'South-East'": [] }
                                      ]
                                    },
                                    {
                                      "caseelse_clause": [
                                        { "ELSE": [] },
                                        { "NULL": [{ "NOT_NULL": [] }] }
                                      ]
                                    },
                                    { "END_IF": [] }
                                  ]
                                },
                                {
                                  "as_alias": [
                                    { "AS": [] },
                                    { "identifier:region_cluster": [] }
                                  ]
                                }
                              ]
                            },
                            { ",": [] },
                            {
                              "_aliasable_expression": [
                                {
                                  "casewhen_expression": [
                                    { "CASE": [] },
                                    {
                                      "casewhen_clause": [
                                        { "WHEN_MATCHED": [] },
                                        {
                                          "binary_expression": [
                                            {
                                              "identifier:a.industry": [
                                                { ".": [] }
                                              ]
                                            },
                                            { "=": [] },
                                            {
                                              "string:'Information Technology'": []
                                            }
                                          ]
                                        },
                                        { "THEN": [] },
                                        { "string:'Tech'": [] }
                                      ]
                                    },
                                    {
                                      "casewhen_clause": [
                                        { "WHEN_MATCHED": [] },
                                        {
                                          "unary_expression": [
                                            {
                                              "identifier:a.industry": [
                                                { ".": [] }
                                              ]
                                            },
                                            { "IS": [] },
                                            { "NULL": [{ "NOT_NULL": [] }] }
                                          ]
                                        },
                                        { "THEN": [] },
                                        { "NULL": [{ "NOT_NULL": [] }] }
                                      ]
                                    },
                                    {
                                      "caseelse_clause": [
                                        { "ELSE": [] },
                                        { "string:'Other'": [] }
                                      ]
                                    },
                                    { "END_IF": [] }
                                  ]
                                },
                                {
                                  "as_alias": [
                                    { "AS": [] },
                                    { "identifier:industry_cluster": [] }
                                  ]
                                }
                              ]
                            },
                            { ",": [] },
                            {
                              "_aliasable_expression": [
                                {
                                  "identifier:a360.account_size": [{ ".": [] }]
                                }
                              ]
                            },
                            { ",": [] },
                            {
                              "_aliasable_expression": [
                                {
                                  "function_call": [
                                    { "identifier:SUM": [] },
                                    { "(": [] },
                                    {
                                      "argument": [
                                        {
                                          "identifier:ar.revenue": [{ ".": [] }]
                                        }
                                      ]
                                    },
                                    { ")": [] }
                                  ]
                                },
                                {
                                  "as_alias": [
                                    { "AS": [] },
                                    { "identifier:revenue": [] }
                                  ]
                                }
                              ]
                            },
                            { ",": [] },
                            {
                              "_aliasable_expression": [
                                {
                                  "function_call": [
                                    { "identifier:COUNT": [] },
                                    { "(": [] },
                                    {
                                      "_keyword_distinct": [
                                        { "DISTINCT_FROM": [] }
                                      ]
                                    },
                                    {
                                      "argument": [
                                        {
                                          "identifier:ar.account_id": [
                                            { ".": [] }
                                          ]
                                        }
                                      ]
                                    },
                                    { ")": [] }
                                  ]
                                },
                                {
                                  "as_alias": [
                                    { "AS": [] },
                                    { "identifier:accounts": [] }
                                  ]
                                }
                              ]
                            },
                            { ",": [] },
                            {
                              "_aliasable_expression": [
                                {
                                  "binary_expression": [
                                    {
                                      "function_call": [
                                        { "identifier:SUM": [] },
                                        { "(": [] },
                                        {
                                          "argument": [
                                            {
                                              "identifier:ar.revenue": [
                                                { ".": [] }
                                              ]
                                            }
                                          ]
                                        },
                                        { ")": [] }
                                      ]
                                    },
                                    { "/": [] },
                                    {
                                      "function_call": [
                                        { "identifier:COUNT": [] },
                                        { "(": [] },
                                        {
                                          "_keyword_distinct": [
                                            { "DISTINCT_FROM": [] }
                                          ]
                                        },
                                        {
                                          "argument": [
                                            {
                                              "identifier:ar.account_id": [
                                                { ".": [] }
                                              ]
                                            }
                                          ]
                                        },
                                        { ")": [] }
                                      ]
                                    }
                                  ]
                                },
                                {
                                  "as_alias": [
                                    { "AS": [] },
                                    { "identifier:revenue_per_account": [] }
                                  ]
                                }
                              ]
                            }
                          ]
                        },
                        {
                          "from_clause": [
                            { "FROM": [] },
                            {
                              "from_item": [
                                {
                                  "join_operation": [
                                    {
                                      "from_item": [
                                        {
                                          "join_operation": [
                                            {
                                              "from_item": [
                                                {
                                                  "join_operation": [
                                                    {
                                                      "from_item": [
                                                        {
                                                          "identifier:accounts_revenue": []
                                                        },
                                                        {
                                                          "as_alias": [
                                                            {
                                                              "identifier:ar": []
                                                            }
                                                          ]
                                                        }
                                                      ]
                                                    },
                                                    {
                                                      "join_type": [
                                                        { "LEFT": [] }
                                                      ]
                                                    },
                                                    { "JOIN": [] },
                                                    {
                                                      "from_item": [
                                                        {
                                                          "identifier:accounts": []
                                                        },
                                                        {
                                                          "as_alias": [
                                                            {
                                                              "identifier:a": []
                                                            }
                                                          ]
                                                        }
                                                      ]
                                                    },
                                                    {
                                                      "join_condition": [
                                                        { "USING": [] },
                                                        { "(": [] },
                                                        {
                                                          "identifier:account_id": []
                                                        },
                                                        { ")": [] }
                                                      ]
                                                    }
                                                  ]
                                                }
                                              ]
                                            },
                                            { "join_type": [{ "LEFT": [] }] },
                                            { "JOIN": [] },
                                            {
                                              "from_item": [
                                                { "identifier:countries": [] },
                                                {
                                                  "as_alias": [
                                                    { "identifier:c": [] }
                                                  ]
                                                }
                                              ]
                                            },
                                            {
                                              "join_condition": [
                                                { "USING": [] },
                                                { "(": [] },
                                                { "identifier:country": [] },
                                                { ")": [] }
                                              ]
                                            }
                                          ]
                                        }
                                      ]
                                    },
                                    { "join_type": [{ "LEFT": [] }] },
                                    { "JOIN": [] },
                                    {
                                      "from_item": [
                                        { "identifier:accounts_360": [] },
                                        {
                                          "as_alias": [
                                            { "identifier:a360": [] }
                                          ]
                                        }
                                      ]
                                    },
                                    {
                                      "join_condition": [
                                        { "USING": [] },
                                        { "(": [] },
                                        { "identifier:account_id": [] },
                                        { ",": [] },
                                        { "identifier:date_month": [] },
                                        { ")": [] }
                                      ]
                                    }
                                  ]
                                }
                              ]
                            }
                          ]
                        },
                        {
                          "group_by_clause": [
                            { "GROUP_BY": [] },
                            { "GROUP_BY": [] },
                            {
                              "grouping_item": [{ "identifier:date_year": [] }]
                            },
                            { ",": [] },
                            {
                              "grouping_item": [
                                { "identifier:region_cluster": [] }
                              ]
                            },
                            { ",": [] },
                            {
                              "grouping_item": [
                                { "identifier:industry_cluster": [] }
                              ]
                            },
                            { ",": [] },
                            {
                              "grouping_item": [
                                {
                                  "identifier:a360.account_size": [{ ".": [] }]
                                }
                              ]
                            }
                          ]
                        }
                      ]
                    },
                    {
                      "order_by_clause": [
                        { "ORDER_BY": [] },
                        { "GROUP_BY": [] },
                        {
                          "order_by_clause_body": [
                            { "identifier:date_year": [] },
                            { ",": [] },
                            { "identifier:region_cluster": [] },
                            { ",": [] },
                            { "identifier:industry_cluster": [] }
                          ]
                        }
                      ]
                    }
                  ]
                }
              ]
            },
            { ";": [] },
            { "comment": [] },
            {
              "query_statement": [
                {
                  "query_expr": [
                    {
                      "select": [
                        { "SELECT": [] },
                        {
                          "select_list": [
                            {
                              "_aliasable_expression": [
                                { "identifier:accounts.name": [{ ".": [] }] }
                              ]
                            },
                            { ",": [] },
                            {
                              "_aliasable_expression": [
                                { "identifier:region": [] }
                              ]
                            },
                            { ",": [] },
                            {
                              "_aliasable_expression": [
                                {
                                  "casewhen_expression": [
                                    { "CASE": [] },
                                    {
                                      "casewhen_clause": [
                                        { "WHEN_MATCHED": [] },
                                        {
                                          "binary_expression": [
                                            {
                                              "identifier:c.region": [
                                                { ".": [] }
                                              ]
                                            },
                                            { "IN": [] },
                                            {
                                              "struct": [
                                                { "(": [] },
                                                { "string:'Americas'": [] },
                                                { ",": [] },
                                                { "string:'Europe'": [] },
                                                { ")": [] }
                                              ]
                                            }
                                          ]
                                        },
                                        { "THEN": [] },
                                        { "string:'North-West'": [] }
                                      ]
                                    },
                                    {
                                      "casewhen_clause": [
                                        { "WHEN_MATCHED": [] },
                                        {
                                          "binary_expression": [
                                            {
                                              "identifier:c.region": [
                                                { ".": [] }
                                              ]
                                            },
                                            { "IN": [] },
                                            {
                                              "struct": [
                                                { "(": [] },
                                                { "string:'Africa'": [] },
                                                { ",": [] },
                                                { "string:'Asia'": [] },
                                                { ")": [] }
                                              ]
                                            }
                                          ]
                                        },
                                        { "THEN": [] },
                                        { "string:'South-East'": [] }
                                      ]
                                    },
                                    {
                                      "caseelse_clause": [
                                        { "ELSE": [] },
                                        { "NULL": [{ "NOT_NULL": [] }] }
                                      ]
                                    },
                                    { "END_IF": [] }
                                  ]
                                },
                                {
                                  "as_alias": [
                                    { "AS": [] },
                                    { "identifier:cluster": [] }
                                  ]
                                }
                              ]
                            },
                            { ",": [] },
                            {
                              "_aliasable_expression": [
                                {
                                  "identifier:accounts.industry": [{ ".": [] }]
                                },
                                {
                                  "as_alias": [
                                    { "AS": [] },
                                    { "identifier:industry": [] }
                                  ]
                                }
                              ]
                            },
                            { ",": [] },
                            {
                              "_aliasable_expression": [
                                {
                                  "function_call": [
                                    { "identifier:IIF": [] },
                                    { "(": [] },
                                    {
                                      "argument": [
                                        {
                                          "binary_expression": [
                                            {
                                              "identifier:accounts.industry": [
                                                { ".": [] }
                                              ]
                                            },
                                            { "=": [] },
                                            {
                                              "string:'Information Technology'": []
                                            }
                                          ]
                                        }
                                      ]
                                    },
                                    { ",": [] },
                                    { "argument": [{ "string:'Tech'": [] }] },
                                    { ",": [] },
                                    { "argument": [{ "string:'Other'": [] }] },
                                    { ")": [] }
                                  ]
                                },
                                {
                                  "as_alias": [
                                    { "AS": [] },
                                    { "identifier:industry_tech": [] }
                                  ]
                                }
                              ]
                            },
                            { ",": [] },
                            {
                              "_aliasable_expression": [
                                {
                                  "casewhen_expression": [
                                    { "CASE": [] },
                                    {
                                      "casewhen_clause": [
                                        { "WHEN_MATCHED": [] },
                                        {
                                          "binary_expression": [
                                            {
                                              "function_call": [
                                                { "identifier:SUM": [] },
                                                { "(": [] },
                                                {
                                                  "argument": [
                                                    {
                                                      "identifier:accounts_revenue.revenue": [
                                                        { ".": [] }
                                                      ]
                                                    }
                                                  ]
                                                },
                                                { ")": [] }
                                              ]
                                            },
                                            { "<=": [] },
                                            { "number:300": [] }
                                          ]
                                        },
                                        { "THEN": [] },
                                        { "string:'Small'": [] }
                                      ]
                                    },
                                    {
                                      "casewhen_clause": [
                                        { "WHEN_MATCHED": [] },
                                        {
                                          "binary_expression": [
                                            {
                                              "binary_expression": [
                                                {
                                                  "function_call": [
                                                    { "identifier:SUM": [] },
                                                    { "(": [] },
                                                    {
                                                      "argument": [
                                                        {
                                                          "identifier:accounts_revenue.revenue": [
                                                            { ".": [] }
                                                          ]
                                                        }
                                                      ]
                                                    },
                                                    { ")": [] }
                                                  ]
                                                },
                                                { ">": [] },
                                                { "number:300": [] }
                                              ]
                                            },
                                            { "AND": [] },
                                            {
                                              "binary_expression": [
                                                {
                                                  "function_call": [
                                                    { "identifier:SUM": [] },
                                                    { "(": [] },
                                                    {
                                                      "argument": [
                                                        {
                                                          "identifier:accounts_revenue.revenue": [
                                                            { ".": [] }
                                                          ]
                                                        }
                                                      ]
                                                    },
                                                    { ")": [] }
                                                  ]
                                                },
                                                { "<=": [] },
                                                { "number:600": [] }
                                              ]
                                            }
                                          ]
                                        },
                                        { "THEN": [] },
                                        { "string:'Medium'": [] }
                                      ]
                                    },
                                    {
                                      "casewhen_clause": [
                                        { "WHEN_MATCHED": [] },
                                        {
                                          "binary_expression": [
                                            {
                                              "function_call": [
                                                { "identifier:SUM": [] },
                                                { "(": [] },
                                                {
                                                  "argument": [
                                                    {
                                                      "identifier:accounts_revenue.revenue": [
                                                        { ".": [] }
                                                      ]
                                                    }
                                                  ]
                                                },
                                                { ")": [] }
                                              ]
                                            },
                                            { ">": [] },
                                            { "number:600": [] }
                                          ]
                                        },
                                        { "THEN": [] },
                                        { "string:'Large'": [] }
                                      ]
                                    },
                                    {
                                      "caseelse_clause": [
                                        { "ELSE": [] },
                                        { "NULL": [{ "NOT_NULL": [] }] }
                                      ]
                                    },
                                    { "END_IF": [] }
                                  ]
                                },
                                {
                                  "as_alias": [
                                    { "AS": [] },
                                    { "identifier:account_size": [] }
                                  ]
                                }
                              ]
                            },
                            { ",": [] },
                            {
                              "_aliasable_expression": [
                                {
                                  "function_call": [
                                    { "identifier:SUM": [] },
                                    { "(": [] },
                                    {
                                      "argument": [
                                        {
                                          "identifier:accounts_revenue.revenue": [
                                            { ".": [] }
                                          ]
                                        }
                                      ]
                                    },
                                    { ")": [] }
                                  ]
                                },
                                {
                                  "as_alias": [
                                    { "AS": [] },
                                    { "identifier:revenue_12m": [] }
                                  ]
                                }
                              ]
                            }
                          ]
                        },
                        {
                          "from_clause": [
                            { "FROM": [] },
                            {
                              "from_item": [
                                {
                                  "join_operation": [
                                    {
                                      "from_item": [
                                        {
                                          "join_operation": [
                                            {
                                              "from_item": [
                                                { "identifier:accounts": [] }
                                              ]
                                            },
                                            { "join_type": [{ "LEFT": [] }] },
                                            { "JOIN": [] },
                                            {
                                              "from_item": [
                                                {
                                                  "identifier:accounts_revenue": []
                                                }
                                              ]
                                            },
                                            {
                                              "join_condition": [
                                                { "USING": [] },
                                                { "(": [] },
                                                { "identifier:account_id": [] },
                                                { ")": [] }
                                              ]
                                            }
                                          ]
                                        }
                                      ]
                                    },
                                    { "join_type": [{ "LEFT": [] }] },
                                    { "JOIN": [] },
                                    {
                                      "from_item": [
                                        { "identifier:countries": [] },
                                        { "as_alias": [{ "identifier:c": [] }] }
                                      ]
                                    },
                                    {
                                      "join_condition": [
                                        { "USING": [] },
                                        { "(": [] },
                                        { "identifier:country": [] },
                                        { ")": [] }
                                      ]
                                    }
                                  ]
                                }
                              ]
                            }
                          ]
                        },
                        {
                          "where_clause": [
                            { "WHERE": [] },
                            {
                              "between_operator": [
                                {
                                  "identifier:accounts_revenue.date_month": [
                                    { ".": [] }
                                  ]
                                },
                                { "BETWEEN": [] },
                                {
                                  "_expression": [
                                    {
                                      "function_call": [
                                        { "identifier:DATE": [{ "DATE": [] }] },
                                        { "(": [] },
                                        {
                                          "argument": [{ "string:'now'": [] }]
                                        },
                                        { ",": [] },
                                        {
                                          "argument": [
                                            { "string:'-12 months'": [] }
                                          ]
                                        },
                                        { ")": [] }
                                      ]
                                    }
                                  ]
                                },
                                { "AND": [] },
                                {
                                  "_expression": [
                                    {
                                      "function_call": [
                                        { "identifier:DATE": [{ "DATE": [] }] },
                                        { "(": [] },
                                        {
                                          "argument": [{ "string:'now'": [] }]
                                        },
                                        { ")": [] }
                                      ]
                                    }
                                  ]
                                }
                              ]
                            }
                          ]
                        },
                        {
                          "group_by_clause": [
                            { "GROUP_BY": [] },
                            { "GROUP_BY": [] },
                            {
                              "grouping_item": [
                                { "identifier:accounts.name": [{ ".": [] }] }
                              ]
                            },
                            { ",": [] },
                            { "grouping_item": [{ "identifier:region": [] }] },
                            { ",": [] },
                            {
                              "grouping_item": [
                                {
                                  "identifier:accounts.industry": [{ ".": [] }]
                                }
                              ]
                            }
                          ]
                        }
                      ]
                    }
                  ]
                }
              ]
            },
            { ";": [] }
          ]
        }
      ]
    }
  },
  "queries": [
    {
      "node": {
        "query_expr": [
          {
            "select": [
              { "SELECT": [] },
              {
                "select_list": [
                  {
                    "_aliasable_expression": [
                      {
                        "function_call": [
                          { "identifier:date": [{ "DATE": [] }] },
                          { "(": [] },
                          { "argument": [{ "identifier:date_month": [] }] },
                          { ",": [] },
                          { "argument": [{ "string:'start of year'": [] }] },
                          { ")": [] }
                        ]
                      },
                      {
                        "as_alias": [
                          { "AS": [] },
                          { "identifier:date_year": [] }
                        ]
                      }
                    ]
                  },
                  { ",": [] },
                  { "comment": [] },
                  {
                    "_aliasable_expression": [
                      {
                        "casewhen_expression": [
                          { "CASE": [] },
                          {
                            "casewhen_clause": [
                              { "WHEN_MATCHED": [] },
                              {
                                "binary_expression": [
                                  { "identifier:c.region": [{ ".": [] }] },
                                  { "IN": [] },
                                  { "(": [] },
                                  { "string:'Americas'": [] },
                                  { ")": [] }
                                ]
                              },
                              { "THEN": [] },
                              { "string:'AMER'": [] }
                            ]
                          },
                          {
                            "casewhen_clause": [
                              { "WHEN_MATCHED": [] },
                              {
                                "binary_expression": [
                                  { "identifier:c.region": [{ ".": [] }] },
                                  { "IN": [] },
                                  {
                                    "struct": [
                                      { "(": [] },
                                      { "string:'Europe'": [] },
                                      { ",": [] },
                                      { "string:'Africa'": [] },
                                      { ")": [] }
                                    ]
                                  }
                                ]
                              },
                              { "THEN": [] },
                              { "string:'EMEA'": [] }
                            ]
                          },
                          {
                            "casewhen_clause": [
                              { "WHEN_MATCHED": [] },
                              {
                                "binary_expression": [
                                  { "identifier:c.region": [{ ".": [] }] },
                                  { "=": [] },
                                  { "string:'Asia'": [] }
                                ]
                              },
                              { "THEN": [] },
                              { "string:'APAC'": [] }
                            ]
                          },
                          {
                            "caseelse_clause": [
                              { "ELSE": [] },
                              { "NULL": [{ "NOT_NULL": [] }] }
                            ]
                          },
                          { "END_IF": [] }
                        ]
                      },
                      {
                        "as_alias": [
                          { "AS": [] },
                          { "identifier:macro_region": [] }
                        ]
                      }
                    ]
                  },
                  { ",": [] },
                  { "comment": [] },
                  {
                    "_aliasable_expression": [
                      {
                        "function_call": [
                          { "identifier:IIF": [] },
                          { "(": [] },
                          {
                            "argument": [
                              {
                                "binary_expression": [
                                  { "identifier:a.industry": [{ ".": [] }] },
                                  { "=": [] },
                                  { "string:'Information Technology'": [] }
                                ]
                              }
                            ]
                          },
                          { ",": [] },
                          { "argument": [{ "string:'IT'": [] }] },
                          { ",": [] },
                          { "argument": [{ "string:'Non-IT'": [] }] },
                          { ")": [] }
                        ]
                      },
                      {
                        "as_alias": [
                          { "AS": [] },
                          { "identifier:industry_it": [] }
                        ]
                      }
                    ]
                  },
                  { ",": [] },
                  {
                    "_aliasable_expression": [
                      {
                        "function_call": [
                          { "identifier:SUM": [] },
                          { "(": [] },
                          {
                            "argument": [
                              { "identifier:ar.revenue": [{ ".": [] }] }
                            ]
                          },
                          { ")": [] }
                        ]
                      },
                      {
                        "as_alias": [{ "AS": [] }, { "identifier:revenue": [] }]
                      }
                    ]
                  },
                  { ",": [] },
                  {
                    "_aliasable_expression": [
                      {
                        "function_call": [
                          { "identifier:COUNT": [] },
                          { "(": [] },
                          { "_keyword_distinct": [{ "DISTINCT_FROM": [] }] },
                          {
                            "argument": [
                              { "identifier:ar.account_id": [{ ".": [] }] }
                            ]
                          },
                          { ")": [] }
                        ]
                      },
                      {
                        "as_alias": [
                          { "AS": [] },
                          { "identifier:accounts": [] }
                        ]
                      }
                    ]
                  },
                  { ",": [] },
                  {
                    "_aliasable_expression": [
                      {
                        "binary_expression": [
                          {
                            "function_call": [
                              { "identifier:SUM": [] },
                              { "(": [] },
                              {
                                "argument": [
                                  { "identifier:ar.revenue": [{ ".": [] }] }
                                ]
                              },
                              { ")": [] }
                            ]
                          },
                          { "/": [] },
                          {
                            "function_call": [
                              { "identifier:COUNT": [] },
                              { "(": [] },
                              {
                                "_keyword_distinct": [{ "DISTINCT_FROM": [] }]
                              },
                              {
                                "argument": [
                                  { "identifier:ar.account_id": [{ ".": [] }] }
                                ]
                              },
                              { ")": [] }
                            ]
                          }
                        ]
                      },
                      {
                        "as_alias": [
                          { "AS": [] },
                          { "identifier:revenue_per_account": [] }
                        ]
                      }
                    ]
                  }
                ]
              },
              {
                "from_clause": [
                  { "FROM": [] },
                  {
                    "from_item": [
                      {
                        "join_operation": [
                          {
                            "from_item": [
                              {
                                "join_operation": [
                                  {
                                    "from_item": [
                                      { "identifier:accounts_revenue": [] },
                                      { "as_alias": [{ "identifier:ar": [] }] }
                                    ]
                                  },
                                  { "join_type": [{ "LEFT": [] }] },
                                  { "JOIN": [] },
                                  {
                                    "from_item": [
                                      { "identifier:accounts": [] },
                                      { "as_alias": [{ "identifier:a": [] }] }
                                    ]
                                  },
                                  {
                                    "join_condition": [
                                      { "USING": [] },
                                      { "(": [] },
                                      { "identifier:account_id": [] },
                                      { ")": [] }
                                    ]
                                  }
                                ]
                              }
                            ]
                          },
                          { "join_type": [{ "LEFT": [] }] },
                          { "JOIN": [] },
                          {
                            "from_item": [
                              { "identifier:countries": [] },
                              { "as_alias": [{ "identifier:c": [] }] }
                            ]
                          },
                          {
                            "join_condition": [
                              { "USING": [] },
                              { "(": [] },
                              { "identifier:country": [] },
                              { ")": [] }
                            ]
                          }
                        ]
                      }
                    ]
                  }
                ]
              },
              {
                "where_clause": [
                  { "WHERE": [] },
                  { "comment": [] },
                  {
                    "binary_expression": [
                      {
                        "binary_expression": [
                          { "identifier:a.industry": [{ ".": [] }] },
                          { "IN": [] },
                          {
                            "struct": [
                              { "(": [] },
                              { "string:'Information Technology'": [] },
                              { ",": [] },
                              { "string:'Telecommunication Services'": [] },
                              { ")": [] }
                            ]
                          }
                        ]
                      },
                      { "comment": [] },
                      { "AND": [] },
                      {
                        "between_operator": [
                          { "identifier:date_month": [] },
                          { "BETWEEN": [] },
                          {
                            "_expression": [
                              {
                                "function_call": [
                                  { "identifier:DATE": [{ "DATE": [] }] },
                                  { "(": [] },
                                  { "argument": [{ "string:'now'": [] }] },
                                  { ",": [] },
                                  {
                                    "argument": [{ "string:'-24 months'": [] }]
                                  },
                                  { ")": [] }
                                ]
                              }
                            ]
                          },
                          { "AND": [] },
                          {
                            "_expression": [
                              {
                                "function_call": [
                                  { "identifier:DATE": [{ "DATE": [] }] },
                                  { "(": [] },
                                  { "argument": [{ "string:'now'": [] }] },
                                  { ")": [] }
                                ]
                              }
                            ]
                          }
                        ]
                      }
                    ]
                  }
                ]
              },
              {
                "group_by_clause": [
                  { "GROUP_BY": [] },
                  { "GROUP_BY": [] },
                  { "grouping_item": [{ "identifier:date_year": [] }] },
                  { ",": [] },
                  { "grouping_item": [{ "identifier:macro_region": [] }] },
                  { ",": [] },
                  { "grouping_item": [{ "identifier:industry_it": [] }] }
                ]
              }
            ]
          }
        ]
      },
      "sources": [
        {
          "node": { "identifier:accounts_revenue": [] },
          "dataset": "None",
          "table": "accounts_revenue",
          "alias": "ar"
        },
        {
          "node": { "identifier:accounts": [] },
          "dataset": "None",
          "table": "accounts",
          "alias": "a"
        },
        {
          "node": { "identifier:countries": [] },
          "dataset": "None",
          "table": "countries",
          "alias": "c"
        }
      ],
      "ops": [
        {
          "node": {
            "function_call": [
              { "identifier:date": [{ "DATE": [] }] },
              { "(": [] },
              { "argument": [{ "identifier:date_month": [] }] },
              { ",": [] },
              { "argument": [{ "string:'start of year'": [] }] },
              { ")": [] }
            ]
          },
          "columns": [
            {
              "node": [
                { "identifier:date_month": [] },
                { "identifier:date_month": [] }
              ],
              "dataset": "None",
              "table": "None",
              "column": "date_month"
            }
          ],
          "alias": "date_year"
        },
        {
          "node": {
            "casewhen_expression": [
              { "CASE": [] },
              {
                "casewhen_clause": [
                  { "WHEN_MATCHED": [] },
                  {
                    "binary_expression": [
                      { "identifier:c.region": [{ ".": [] }] },
                      { "IN": [] },
                      { "(": [] },
                      { "string:'Americas'": [] },
                      { ")": [] }
                    ]
                  },
                  { "THEN": [] },
                  { "string:'AMER'": [] }
                ]
              },
              {
                "casewhen_clause": [
                  { "WHEN_MATCHED": [] },
                  {
                    "binary_expression": [
                      { "identifier:c.region": [{ ".": [] }] },
                      { "IN": [] },
                      {
                        "struct": [
                          { "(": [] },
                          { "string:'Europe'": [] },
                          { ",": [] },
                          { "string:'Africa'": [] },
                          { ")": [] }
                        ]
                      }
                    ]
                  },
                  { "THEN": [] },
                  { "string:'EMEA'": [] }
                ]
              },
              {
                "casewhen_clause": [
                  { "WHEN_MATCHED": [] },
                  {
                    "binary_expression": [
                      { "identifier:c.region": [{ ".": [] }] },
                      { "=": [] },
                      { "string:'Asia'": [] }
                    ]
                  },
                  { "THEN": [] },
                  { "string:'APAC'": [] }
                ]
              },
              {
                "caseelse_clause": [
                  { "ELSE": [] },
                  { "NULL": [{ "NOT_NULL": [] }] }
                ]
              },
              { "END_IF": [] }
            ]
          },
          "columns": [
            {
              "node": [
                { "identifier:c.region": [{ ".": [] }] },
                { "identifier:c.region": [{ ".": [] }] },
                { "identifier:c.region": [{ ".": [] }] }
              ],
              "dataset": "None",
              "table": "countries",
              "column": "region"
            }
          ],
          "alias": "macro_region"
        },
        {
          "node": {
            "function_call": [
              { "identifier:IIF": [] },
              { "(": [] },
              {
                "argument": [
                  {
                    "binary_expression": [
                      { "identifier:a.industry": [{ ".": [] }] },
                      { "=": [] },
                      { "string:'Information Technology'": [] }
                    ]
                  }
                ]
              },
              { ",": [] },
              { "argument": [{ "string:'IT'": [] }] },
              { ",": [] },
              { "argument": [{ "string:'Non-IT'": [] }] },
              { ")": [] }
            ]
          },
          "columns": [
            {
              "node": [
                { "identifier:a.industry": [{ ".": [] }] },
                { "identifier:a.industry": [{ ".": [] }] }
              ],
              "dataset": "None",
              "table": "accounts",
              "column": "industry"
            }
          ],
          "alias": "industry_it"
        },
        {
          "node": {
            "function_call": [
              { "identifier:SUM": [] },
              { "(": [] },
              { "argument": [{ "identifier:ar.revenue": [{ ".": [] }] }] },
              { ")": [] }
            ]
          },
          "columns": [
            {
              "node": [
                { "identifier:ar.revenue": [{ ".": [] }] },
                { "identifier:ar.revenue": [{ ".": [] }] }
              ],
              "dataset": "None",
              "table": "accounts_revenue",
              "column": "revenue"
            }
          ],
          "alias": "revenue"
        },
        {
          "node": {
            "function_call": [
              { "identifier:COUNT": [] },
              { "(": [] },
              { "_keyword_distinct": [{ "DISTINCT_FROM": [] }] },
              { "argument": [{ "identifier:ar.account_id": [{ ".": [] }] }] },
              { ")": [] }
            ]
          },
          "columns": [
            {
              "node": [
                { "identifier:ar.account_id": [{ ".": [] }] },
                { "identifier:ar.account_id": [{ ".": [] }] }
              ],
              "dataset": "None",
              "table": "accounts_revenue",
              "column": "account_id"
            }
          ],
          "alias": "accounts"
        },
        {
          "node": {
            "binary_expression": [
              {
                "function_call": [
                  { "identifier:SUM": [] },
                  { "(": [] },
                  { "argument": [{ "identifier:ar.revenue": [{ ".": [] }] }] },
                  { ")": [] }
                ]
              },
              { "/": [] },
              {
                "function_call": [
                  { "identifier:COUNT": [] },
                  { "(": [] },
                  { "_keyword_distinct": [{ "DISTINCT_FROM": [] }] },
                  {
                    "argument": [{ "identifier:ar.account_id": [{ ".": [] }] }]
                  },
                  { ")": [] }
                ]
              }
            ]
          },
          "columns": [
            {
              "node": [
                { "identifier:ar.revenue": [{ ".": [] }] },
                { "identifier:ar.revenue": [{ ".": [] }] }
              ],
              "dataset": "None",
              "table": "accounts_revenue",
              "column": "revenue"
            },
            {
              "node": [
                { "identifier:ar.account_id": [{ ".": [] }] },
                { "identifier:ar.account_id": [{ ".": [] }] }
              ],
              "dataset": "None",
              "table": "accounts_revenue",
              "column": "account_id"
            }
          ],
          "alias": "revenue_per_account"
        },
        {
          "node": { "identifier:account_id": [] },
          "columns": [
            {
              "node": [{ "identifier:account_id": [] }],
              "dataset": "None",
              "table": "None",
              "column": "account_id"
            }
          ],
          "alias": "None"
        },
        {
          "node": { "identifier:country": [] },
          "columns": [
            {
              "node": [{ "identifier:country": [] }],
              "dataset": "None",
              "table": "None",
              "column": "country"
            }
          ],
          "alias": "None"
        },
        {
          "node": { "identifier:date_year": [] },
          "columns": [
            {
              "node": [{ "identifier:date_year": [] }],
              "dataset": "None",
              "table": "None",
              "column": "date_year"
            }
          ],
          "alias": "None"
        },
        {
          "node": { "identifier:macro_region": [] },
          "columns": [
            {
              "node": [{ "identifier:macro_region": [] }],
              "dataset": "None",
              "table": "None",
              "column": "macro_region"
            }
          ],
          "alias": "None"
        },
        {
          "node": { "identifier:industry_it": [] },
          "columns": [
            {
              "node": [{ "identifier:industry_it": [] }],
              "dataset": "None",
              "table": "None",
              "column": "industry_it"
            }
          ],
          "alias": "None"
        }
      ],
      "alias": "None"
    },
    {
      "node": {
        "query_expr": [
          {
            "select": [
              { "SELECT": [] },
              {
                "select_list": [
                  { "select_all": [{ "asterisk_expression": [{ "*": [] }] }] },
                  { ",": [] },
                  {
                    "_aliasable_expression": [
                      {
                        "binary_expression": [
                          { "identifier:revenue": [] },
                          { "/": [] },
                          { "identifier:contract_duration_days": [] }
                        ]
                      },
                      {
                        "as_alias": [
                          { "AS": [] },
                          { "identifier:revenue_day": [] }
                        ]
                      }
                    ]
                  },
                  { ",": [] },
                  {
                    "_aliasable_expression": [
                      {
                        "binary_expression": [
                          { "identifier:revenue_core": [] },
                          { "/": [] },
                          { "identifier:contract_duration_days": [] }
                        ]
                      },
                      {
                        "as_alias": [
                          { "AS": [] },
                          { "identifier:revenue_core_day": [] }
                        ]
                      }
                    ]
                  },
                  { ",": [] },
                  {
                    "_aliasable_expression": [
                      {
                        "binary_expression": [
                          { "identifier:revenue_aux": [] },
                          { "/": [] },
                          { "identifier:contract_duration_days": [] }
                        ]
                      },
                      {
                        "as_alias": [
                          { "AS": [] },
                          { "identifier:revenue_aux_day": [] }
                        ]
                      }
                    ]
                  }
                ]
              },
              {
                "from_clause": [
                  { "FROM": [] },
                  {
                    "from_item": [
                      {
                        "select_subexpression": [
                          { "(": [] },
                          {
                            "query_expr": [
                              {
                                "select": [
                                  { "SELECT": [] },
                                  {
                                    "select_list": [
                                      {
                                        "_aliasable_expression": [
                                          {
                                            "identifier:d.deal_id": [
                                              { ".": [] }
                                            ]
                                          }
                                        ]
                                      },
                                      { ",": [] },
                                      {
                                        "_aliasable_expression": [
                                          {
                                            "identifier:d.account_id": [
                                              { ".": [] }
                                            ]
                                          }
                                        ]
                                      },
                                      { ",": [] },
                                      {
                                        "_aliasable_expression": [
                                          {
                                            "identifier:d.contract_start_date": [
                                              { ".": [] }
                                            ]
                                          }
                                        ]
                                      },
                                      { ",": [] },
                                      {
                                        "_aliasable_expression": [
                                          {
                                            "identifier:d.contract_end_date": [
                                              { ".": [] }
                                            ]
                                          }
                                        ]
                                      },
                                      { ",": [] },
                                      {
                                        "_aliasable_expression": [
                                          {
                                            "binary_expression": [
                                              {
                                                "binary_expression": [
                                                  {
                                                    "function_call": [
                                                      {
                                                        "identifier:julianday": []
                                                      },
                                                      { "(": [] },
                                                      {
                                                        "argument": [
                                                          {
                                                            "identifier:d.contract_end_date": [
                                                              { ".": [] }
                                                            ]
                                                          }
                                                        ]
                                                      },
                                                      { ")": [] }
                                                    ]
                                                  },
                                                  { "-": [] },
                                                  {
                                                    "function_call": [
                                                      {
                                                        "identifier:julianday": []
                                                      },
                                                      { "(": [] },
                                                      {
                                                        "argument": [
                                                          {
                                                            "identifier:d.contract_start_date": [
                                                              { ".": [] }
                                                            ]
                                                          }
                                                        ]
                                                      },
                                                      { ")": [] }
                                                    ]
                                                  }
                                                ]
                                              },
                                              { "+": [] },
                                              { "number:1": [] }
                                            ]
                                          },
                                          {
                                            "as_alias": [
                                              { "AS": [] },
                                              {
                                                "identifier:contract_duration_days": []
                                              }
                                            ]
                                          }
                                        ]
                                      },
                                      { ",": [] },
                                      {
                                        "_aliasable_expression": [
                                          {
                                            "function_call": [
                                              { "identifier:SUM": [] },
                                              { "(": [] },
                                              {
                                                "argument": [
                                                  {
                                                    "casewhen_expression": [
                                                      { "CASE": [] },
                                                      {
                                                        "casewhen_clause": [
                                                          {
                                                            "WHEN_MATCHED": []
                                                          },
                                                          {
                                                            "binary_expression": [
                                                              {
                                                                "identifier:o.product": [
                                                                  { ".": [] }
                                                                ]
                                                              },
                                                              { "IN": [] },
                                                              {
                                                                "struct": [
                                                                  { "(": [] },
                                                                  {
                                                                    "string:'Subscription Base'": []
                                                                  },
                                                                  { ",": [] },
                                                                  {
                                                                    "string:'Subscription Premium'": []
                                                                  },
                                                                  { ")": [] }
                                                                ]
                                                              }
                                                            ]
                                                          },
                                                          { "THEN": [] },
                                                          {
                                                            "identifier:o.value": [
                                                              { ".": [] }
                                                            ]
                                                          }
                                                        ]
                                                      },
                                                      {
                                                        "caseelse_clause": [
                                                          { "ELSE": [] },
                                                          { "number:0": [] }
                                                        ]
                                                      },
                                                      { "END_IF": [] }
                                                    ]
                                                  }
                                                ]
                                              },
                                              { ")": [] }
                                            ]
                                          },
                                          {
                                            "as_alias": [
                                              { "AS": [] },
                                              { "identifier:revenue_core": [] }
                                            ]
                                          }
                                        ]
                                      },
                                      { ",": [] },
                                      {
                                        "_aliasable_expression": [
                                          {
                                            "function_call": [
                                              { "identifier:SUM": [] },
                                              { "(": [] },
                                              {
                                                "argument": [
                                                  {
                                                    "casewhen_expression": [
                                                      { "CASE": [] },
                                                      {
                                                        "casewhen_clause": [
                                                          {
                                                            "WHEN_MATCHED": []
                                                          },
                                                          {
                                                            "binary_expression": [
                                                              {
                                                                "identifier:o.product": [
                                                                  { ".": [] }
                                                                ]
                                                              },
                                                              { "IN": [] },
                                                              {
                                                                "struct": [
                                                                  { "(": [] },
                                                                  {
                                                                    "string:'Training'": []
                                                                  },
                                                                  { ",": [] },
                                                                  {
                                                                    "string:'Consulting'": []
                                                                  },
                                                                  { ")": [] }
                                                                ]
                                                              }
                                                            ]
                                                          },
                                                          { "THEN": [] },
                                                          {
                                                            "identifier:o.value": [
                                                              { ".": [] }
                                                            ]
                                                          }
                                                        ]
                                                      },
                                                      {
                                                        "caseelse_clause": [
                                                          { "ELSE": [] },
                                                          { "number:0": [] }
                                                        ]
                                                      },
                                                      { "END_IF": [] }
                                                    ]
                                                  }
                                                ]
                                              },
                                              { ")": [] }
                                            ]
                                          },
                                          {
                                            "as_alias": [
                                              { "AS": [] },
                                              { "identifier:revenue_aux": [] }
                                            ]
                                          }
                                        ]
                                      },
                                      { ",": [] },
                                      {
                                        "_aliasable_expression": [
                                          {
                                            "function_call": [
                                              { "identifier:SUM": [] },
                                              { "(": [] },
                                              {
                                                "argument": [
                                                  {
                                                    "identifier:o.value": [
                                                      { ".": [] }
                                                    ]
                                                  }
                                                ]
                                              },
                                              { ")": [] }
                                            ]
                                          },
                                          {
                                            "as_alias": [
                                              { "AS": [] },
                                              { "identifier:revenue": [] }
                                            ]
                                          }
                                        ]
                                      }
                                    ]
                                  },
                                  {
                                    "from_clause": [
                                      { "FROM": [] },
                                      {
                                        "from_item": [
                                          {
                                            "join_operation": [
                                              {
                                                "from_item": [
                                                  { "identifier:orders": [] },
                                                  {
                                                    "as_alias": [
                                                      { "identifier:o": [] }
                                                    ]
                                                  }
                                                ]
                                              },
                                              { "JOIN": [] },
                                              {
                                                "from_item": [
                                                  { "identifier:deals": [] },
                                                  {
                                                    "as_alias": [
                                                      { "identifier:d": [] }
                                                    ]
                                                  }
                                                ]
                                              },
                                              {
                                                "join_condition": [
                                                  { "USING": [] },
                                                  { "(": [] },
                                                  { "identifier:deal_id": [] },
                                                  { ",": [] },
                                                  { "identifier:order_id": [] },
                                                  { ")": [] }
                                                ]
                                              }
                                            ]
                                          }
                                        ]
                                      }
                                    ]
                                  },
                                  {
                                    "where_clause": [
                                      { "WHERE": [] },
                                      {
                                        "binary_expression": [
                                          {
                                            "identifier:d.stage": [{ ".": [] }]
                                          },
                                          { "=": [] },
                                          { "number:4": [] }
                                        ]
                                      }
                                    ]
                                  },
                                  {
                                    "group_by_clause": [
                                      { "GROUP_BY": [] },
                                      { "GROUP_BY": [] },
                                      {
                                        "grouping_item": [
                                          {
                                            "identifier:d.deal_id": [
                                              { ".": [] }
                                            ]
                                          }
                                        ]
                                      },
                                      { ",": [] },
                                      {
                                        "grouping_item": [
                                          {
                                            "identifier:d.account_id": [
                                              { ".": [] }
                                            ]
                                          }
                                        ]
                                      },
                                      { ",": [] },
                                      {
                                        "grouping_item": [
                                          {
                                            "identifier:d.contract_start_date": [
                                              { ".": [] }
                                            ]
                                          }
                                        ]
                                      },
                                      { ",": [] },
                                      {
                                        "grouping_item": [
                                          {
                                            "identifier:d.contract_end_date": [
                                              { ".": [] }
                                            ]
                                          }
                                        ]
                                      }
                                    ]
                                  }
                                ]
                              }
                            ]
                          },
                          { ")": [] }
                        ]
                      },
                      { "as_alias": [{ "AS": [] }, { "identifier:t": [] }] }
                    ]
                  }
                ]
              }
            ]
          }
        ]
      },
      "sources": [
        {
          "node": {
            "query_expr": [
              {
                "select": [
                  { "SELECT": [] },
                  {
                    "select_list": [
                      {
                        "_aliasable_expression": [
                          { "identifier:d.deal_id": [{ ".": [] }] }
                        ]
                      },
                      { ",": [] },
                      {
                        "_aliasable_expression": [
                          { "identifier:d.account_id": [{ ".": [] }] }
                        ]
                      },
                      { ",": [] },
                      {
                        "_aliasable_expression": [
                          { "identifier:d.contract_start_date": [{ ".": [] }] }
                        ]
                      },
                      { ",": [] },
                      {
                        "_aliasable_expression": [
                          { "identifier:d.contract_end_date": [{ ".": [] }] }
                        ]
                      },
                      { ",": [] },
                      {
                        "_aliasable_expression": [
                          {
                            "binary_expression": [
                              {
                                "binary_expression": [
                                  {
                                    "function_call": [
                                      { "identifier:julianday": [] },
                                      { "(": [] },
                                      {
                                        "argument": [
                                          {
                                            "identifier:d.contract_end_date": [
                                              { ".": [] }
                                            ]
                                          }
                                        ]
                                      },
                                      { ")": [] }
                                    ]
                                  },
                                  { "-": [] },
                                  {
                                    "function_call": [
                                      { "identifier:julianday": [] },
                                      { "(": [] },
                                      {
                                        "argument": [
                                          {
                                            "identifier:d.contract_start_date": [
                                              { ".": [] }
                                            ]
                                          }
                                        ]
                                      },
                                      { ")": [] }
                                    ]
                                  }
                                ]
                              },
                              { "+": [] },
                              { "number:1": [] }
                            ]
                          },
                          {
                            "as_alias": [
                              { "AS": [] },
                              { "identifier:contract_duration_days": [] }
                            ]
                          }
                        ]
                      },
                      { ",": [] },
                      {
                        "_aliasable_expression": [
                          {
                            "function_call": [
                              { "identifier:SUM": [] },
                              { "(": [] },
                              {
                                "argument": [
                                  {
                                    "casewhen_expression": [
                                      { "CASE": [] },
                                      {
                                        "casewhen_clause": [
                                          { "WHEN_MATCHED": [] },
                                          {
                                            "binary_expression": [
                                              {
                                                "identifier:o.product": [
                                                  { ".": [] }
                                                ]
                                              },
                                              { "IN": [] },
                                              {
                                                "struct": [
                                                  { "(": [] },
                                                  {
                                                    "string:'Subscription Base'": []
                                                  },
                                                  { ",": [] },
                                                  {
                                                    "string:'Subscription Premium'": []
                                                  },
                                                  { ")": [] }
                                                ]
                                              }
                                            ]
                                          },
                                          { "THEN": [] },
                                          {
                                            "identifier:o.value": [{ ".": [] }]
                                          }
                                        ]
                                      },
                                      {
                                        "caseelse_clause": [
                                          { "ELSE": [] },
                                          { "number:0": [] }
                                        ]
                                      },
                                      { "END_IF": [] }
                                    ]
                                  }
                                ]
                              },
                              { ")": [] }
                            ]
                          },
                          {
                            "as_alias": [
                              { "AS": [] },
                              { "identifier:revenue_core": [] }
                            ]
                          }
                        ]
                      },
                      { ",": [] },
                      {
                        "_aliasable_expression": [
                          {
                            "function_call": [
                              { "identifier:SUM": [] },
                              { "(": [] },
                              {
                                "argument": [
                                  {
                                    "casewhen_expression": [
                                      { "CASE": [] },
                                      {
                                        "casewhen_clause": [
                                          { "WHEN_MATCHED": [] },
                                          {
                                            "binary_expression": [
                                              {
                                                "identifier:o.product": [
                                                  { ".": [] }
                                                ]
                                              },
                                              { "IN": [] },
                                              {
                                                "struct": [
                                                  { "(": [] },
                                                  { "string:'Training'": [] },
                                                  { ",": [] },
                                                  { "string:'Consulting'": [] },
                                                  { ")": [] }
                                                ]
                                              }
                                            ]
                                          },
                                          { "THEN": [] },
                                          {
                                            "identifier:o.value": [{ ".": [] }]
                                          }
                                        ]
                                      },
                                      {
                                        "caseelse_clause": [
                                          { "ELSE": [] },
                                          { "number:0": [] }
                                        ]
                                      },
                                      { "END_IF": [] }
                                    ]
                                  }
                                ]
                              },
                              { ")": [] }
                            ]
                          },
                          {
                            "as_alias": [
                              { "AS": [] },
                              { "identifier:revenue_aux": [] }
                            ]
                          }
                        ]
                      },
                      { ",": [] },
                      {
                        "_aliasable_expression": [
                          {
                            "function_call": [
                              { "identifier:SUM": [] },
                              { "(": [] },
                              {
                                "argument": [
                                  { "identifier:o.value": [{ ".": [] }] }
                                ]
                              },
                              { ")": [] }
                            ]
                          },
                          {
                            "as_alias": [
                              { "AS": [] },
                              { "identifier:revenue": [] }
                            ]
                          }
                        ]
                      }
                    ]
                  },
                  {
                    "from_clause": [
                      { "FROM": [] },
                      {
                        "from_item": [
                          {
                            "join_operation": [
                              {
                                "from_item": [
                                  { "identifier:orders": [] },
                                  { "as_alias": [{ "identifier:o": [] }] }
                                ]
                              },
                              { "JOIN": [] },
                              {
                                "from_item": [
                                  { "identifier:deals": [] },
                                  { "as_alias": [{ "identifier:d": [] }] }
                                ]
                              },
                              {
                                "join_condition": [
                                  { "USING": [] },
                                  { "(": [] },
                                  { "identifier:deal_id": [] },
                                  { ",": [] },
                                  { "identifier:order_id": [] },
                                  { ")": [] }
                                ]
                              }
                            ]
                          }
                        ]
                      }
                    ]
                  },
                  {
                    "where_clause": [
                      { "WHERE": [] },
                      {
                        "binary_expression": [
                          { "identifier:d.stage": [{ ".": [] }] },
                          { "=": [] },
                          { "number:4": [] }
                        ]
                      }
                    ]
                  },
                  {
                    "group_by_clause": [
                      { "GROUP_BY": [] },
                      { "GROUP_BY": [] },
                      {
                        "grouping_item": [
                          { "identifier:d.deal_id": [{ ".": [] }] }
                        ]
                      },
                      { ",": [] },
                      {
                        "grouping_item": [
                          { "identifier:d.account_id": [{ ".": [] }] }
                        ]
                      },
                      { ",": [] },
                      {
                        "grouping_item": [
                          { "identifier:d.contract_start_date": [{ ".": [] }] }
                        ]
                      },
                      { ",": [] },
                      {
                        "grouping_item": [
                          { "identifier:d.contract_end_date": [{ ".": [] }] }
                        ]
                      }
                    ]
                  }
                ]
              }
            ]
          },
          "sources": [
            {
              "node": { "identifier:orders": [] },
              "dataset": "None",
              "table": "orders",
              "alias": "o"
            },
            {
              "node": { "identifier:deals": [] },
              "dataset": "None",
              "table": "deals",
              "alias": "d"
            }
          ],
          "ops": [
            {
              "node": {
                "identifier:d.deal_id": [{ ".": [] }]
              },
              "columns": [
                {
                  "node": [
                    { "identifier:d.deal_id": [{ ".": [] }] },
                    { "identifier:d.deal_id": [{ ".": [] }] }
                  ],
                  "dataset": "None",
                  "table": "deals",
                  "column": "deal_id"
                }
              ],
              "alias": "None"
            },
            {
              "node": {
                "identifier:d.account_id": [{ ".": [] }]
              },
              "columns": [
                {
                  "node": [
                    { "identifier:d.account_id": [{ ".": [] }] },
                    { "identifier:d.account_id": [{ ".": [] }] }
                  ],
                  "dataset": "None",
                  "table": "deals",
                  "column": "account_id"
                }
              ],
              "alias": "None"
            },
            {
              "node": {
                "identifier:d.contract_start_date": [{ ".": [] }]
              },
              "columns": [
                {
                  "node": [
                    { "identifier:d.contract_start_date": [{ ".": [] }] },
                    { "identifier:d.contract_start_date": [{ ".": [] }] },
                    { "identifier:d.contract_start_date": [{ ".": [] }] }
                  ],
                  "dataset": "None",
                  "table": "deals",
                  "column": "contract_start_date"
                }
              ],
              "alias": "None"
            },
            {
              "node": {
                "identifier:d.contract_end_date": [{ ".": [] }]
              },
              "columns": [
                {
                  "node": [
                    { "identifier:d.contract_end_date": [{ ".": [] }] },
                    { "identifier:d.contract_end_date": [{ ".": [] }] },
                    { "identifier:d.contract_end_date": [{ ".": [] }] }
                  ],
                  "dataset": "None",
                  "table": "deals",
                  "column": "contract_end_date"
                }
              ],
              "alias": "None"
            },
            {
              "node": {
                "binary_expression": [
                  {
                    "binary_expression": [
                      {
                        "function_call": [
                          { "identifier:julianday": [] },
                          { "(": [] },
                          {
                            "argument": [
                              {
                                "identifier:d.contract_end_date": [{ ".": [] }]
                              }
                            ]
                          },
                          { ")": [] }
                        ]
                      },
                      { "-": [] },
                      {
                        "function_call": [
                          { "identifier:julianday": [] },
                          { "(": [] },
                          {
                            "argument": [
                              {
                                "identifier:d.contract_start_date": [
                                  { ".": [] }
                                ]
                              }
                            ]
                          },
                          { ")": [] }
                        ]
                      }
                    ]
                  },
                  { "+": [] },
                  { "number:1": [] }
                ]
              },
              "columns": [
                {
                  "node": [
                    { "identifier:d.contract_end_date": [{ ".": [] }] },
                    { "identifier:d.contract_end_date": [{ ".": [] }] },
                    { "identifier:d.contract_end_date": [{ ".": [] }] }
                  ],
                  "dataset": "None",
                  "table": "deals",
                  "column": "contract_end_date"
                },
                {
                  "node": [
                    { "identifier:d.contract_start_date": [{ ".": [] }] },
                    { "identifier:d.contract_start_date": [{ ".": [] }] },
                    { "identifier:d.contract_start_date": [{ ".": [] }] }
                  ],
                  "dataset": "None",
                  "table": "deals",
                  "column": "contract_start_date"
                }
              ],
              "alias": "contract_duration_days"
            },
            {
              "node": {
                "function_call": [
                  { "identifier:SUM": [] },
                  { "(": [] },
                  {
                    "argument": [
                      {
                        "casewhen_expression": [
                          { "CASE": [] },
                          {
                            "casewhen_clause": [
                              { "WHEN_MATCHED": [] },
                              {
                                "binary_expression": [
                                  { "identifier:o.product": [{ ".": [] }] },
                                  { "IN": [] },
                                  {
                                    "struct": [
                                      { "(": [] },
                                      { "string:'Subscription Base'": [] },
                                      { ",": [] },
                                      { "string:'Subscription Premium'": [] },
                                      { ")": [] }
                                    ]
                                  }
                                ]
                              },
                              { "THEN": [] },
                              { "identifier:o.value": [{ ".": [] }] }
                            ]
                          },
                          {
                            "caseelse_clause": [
                              { "ELSE": [] },
                              { "number:0": [] }
                            ]
                          },
                          { "END_IF": [] }
                        ]
                      }
                    ]
                  },
                  { ")": [] }
                ]
              },
              "columns": [
                {
                  "node": [
                    { "identifier:o.product": [{ ".": [] }] },
                    { "identifier:o.product": [{ ".": [] }] }
                  ],
                  "dataset": "None",
                  "table": "orders",
                  "column": "product"
                },
                {
                  "node": [
                    { "identifier:o.value": [{ ".": [] }] },
                    { "identifier:o.value": [{ ".": [] }] },
                    { "identifier:o.value": [{ ".": [] }] }
                  ],
                  "dataset": "None",
                  "table": "orders",
                  "column": "value"
                }
              ],
              "alias": "revenue_core"
            },
            {
              "node": {
                "function_call": [
                  { "identifier:SUM": [] },
                  { "(": [] },
                  {
                    "argument": [
                      {
                        "casewhen_expression": [
                          { "CASE": [] },
                          {
                            "casewhen_clause": [
                              { "WHEN_MATCHED": [] },
                              {
                                "binary_expression": [
                                  { "identifier:o.product": [{ ".": [] }] },
                                  { "IN": [] },
                                  {
                                    "struct": [
                                      { "(": [] },
                                      { "string:'Training'": [] },
                                      { ",": [] },
                                      { "string:'Consulting'": [] },
                                      { ")": [] }
                                    ]
                                  }
                                ]
                              },
                              { "THEN": [] },
                              { "identifier:o.value": [{ ".": [] }] }
                            ]
                          },
                          {
                            "caseelse_clause": [
                              { "ELSE": [] },
                              { "number:0": [] }
                            ]
                          },
                          { "END_IF": [] }
                        ]
                      }
                    ]
                  },
                  { ")": [] }
                ]
              },
              "columns": [
                {
                  "node": [
                    { "identifier:o.product": [{ ".": [] }] },
                    { "identifier:o.product": [{ ".": [] }] }
                  ],
                  "dataset": "None",
                  "table": "orders",
                  "column": "product"
                },
                {
                  "node": [
                    { "identifier:o.value": [{ ".": [] }] },
                    { "identifier:o.value": [{ ".": [] }] },
                    { "identifier:o.value": [{ ".": [] }] }
                  ],
                  "dataset": "None",
                  "table": "orders",
                  "column": "value"
                }
              ],
              "alias": "revenue_aux"
            },
            {
              "node": {
                "function_call": [
                  { "identifier:SUM": [] },
                  { "(": [] },
                  { "argument": [{ "identifier:o.value": [{ ".": [] }] }] },
                  { ")": [] }
                ]
              },
              "columns": [
                {
                  "node": [
                    { "identifier:o.value": [{ ".": [] }] },
                    { "identifier:o.value": [{ ".": [] }] },
                    { "identifier:o.value": [{ ".": [] }] }
                  ],
                  "dataset": "None",
                  "table": "orders",
                  "column": "value"
                }
              ],
              "alias": "revenue"
            },
            {
              "node": { "identifier:deal_id": [] },
              "columns": [
                {
                  "node": [{ "identifier:deal_id": [] }],
                  "dataset": "None",
                  "table": "None",
                  "column": "deal_id"
                },
                {
                  "node": [{ "identifier:order_id": [] }],
                  "dataset": "None",
                  "table": "None",
                  "column": "order_id"
                }
              ],
              "alias": "None"
            },
            {
              "node": { "identifier:order_id": [] },
              "columns": [
                {
                  "node": [{ "identifier:deal_id": [] }],
                  "dataset": "None",
                  "table": "None",
                  "column": "deal_id"
                },
                {
                  "node": [{ "identifier:order_id": [] }],
                  "dataset": "None",
                  "table": "None",
                  "column": "order_id"
                }
              ],
              "alias": "None"
            },
            {
              "node": {
                "identifier:d.deal_id": [{ ".": [] }]
              },
              "columns": [
                {
                  "node": [
                    { "identifier:d.deal_id": [{ ".": [] }] },
                    { "identifier:d.deal_id": [{ ".": [] }] }
                  ],
                  "dataset": "None",
                  "table": "deals",
                  "column": "deal_id"
                }
              ],
              "alias": "None"
            },
            {
              "node": {
                "identifier:d.account_id": [{ ".": [] }]
              },
              "columns": [
                {
                  "node": [
                    { "identifier:d.account_id": [{ ".": [] }] },
                    { "identifier:d.account_id": [{ ".": [] }] }
                  ],
                  "dataset": "None",
                  "table": "deals",
                  "column": "account_id"
                }
              ],
              "alias": "None"
            },
            {
              "node": {
                "identifier:d.contract_start_date": [{ ".": [] }]
              },
              "columns": [
                {
                  "node": [
                    { "identifier:d.contract_start_date": [{ ".": [] }] },
                    { "identifier:d.contract_start_date": [{ ".": [] }] },
                    { "identifier:d.contract_start_date": [{ ".": [] }] }
                  ],
                  "dataset": "None",
                  "table": "deals",
                  "column": "contract_start_date"
                }
              ],
              "alias": "None"
            },
            {
              "node": {
                "identifier:d.contract_end_date": [{ ".": [] }]
              },
              "columns": [
                {
                  "node": [
                    { "identifier:d.contract_end_date": [{ ".": [] }] },
                    { "identifier:d.contract_end_date": [{ ".": [] }] },
                    { "identifier:d.contract_end_date": [{ ".": [] }] }
                  ],
                  "dataset": "None",
                  "table": "deals",
                  "column": "contract_end_date"
                }
              ],
              "alias": "None"
            }
          ],
          "alias": "None"
        }
      ],
      "ops": [
        {
          "node": {
            "binary_expression": [
              { "identifier:revenue": [] },
              { "/": [] },
              { "identifier:contract_duration_days": [] }
            ]
          },
          "columns": [
            {
              "node": [{ "identifier:revenue": [] }],
              "dataset": "None",
              "table": "None",
              "column": "revenue"
            },
            {
              "node": [
                { "identifier:contract_duration_days": [] },
                { "identifier:contract_duration_days": [] },
                { "identifier:contract_duration_days": [] }
              ],
              "dataset": "None",
              "table": "None",
              "column": "contract_duration_days"
            }
          ],
          "alias": "revenue_day"
        },
        {
          "node": {
            "binary_expression": [
              { "identifier:revenue_core": [] },
              { "/": [] },
              { "identifier:contract_duration_days": [] }
            ]
          },
          "columns": [
            {
              "node": [{ "identifier:revenue_core": [] }],
              "dataset": "None",
              "table": "None",
              "column": "revenue_core"
            },
            {
              "node": [
                { "identifier:contract_duration_days": [] },
                { "identifier:contract_duration_days": [] },
                { "identifier:contract_duration_days": [] }
              ],
              "dataset": "None",
              "table": "None",
              "column": "contract_duration_days"
            }
          ],
          "alias": "revenue_core_day"
        },
        {
          "node": {
            "binary_expression": [
              { "identifier:revenue_aux": [] },
              { "/": [] },
              { "identifier:contract_duration_days": [] }
            ]
          },
          "columns": [
            {
              "node": [{ "identifier:revenue_aux": [] }],
              "dataset": "None",
              "table": "None",
              "column": "revenue_aux"
            },
            {
              "node": [
                { "identifier:contract_duration_days": [] },
                { "identifier:contract_duration_days": [] },
                { "identifier:contract_duration_days": [] }
              ],
              "dataset": "None",
              "table": "None",
              "column": "contract_duration_days"
            }
          ],
          "alias": "revenue_aux_day"
        }
      ],
      "alias": "None"
    },
    {
      "node": {
        "query_expr": [
          {
            "select": [
              { "SELECT": [] },
              {
                "select_list": [
                  {
                    "_aliasable_expression": [
                      { "identifier:t.date_month": [{ ".": [] }] }
                    ]
                  },
                  { ",": [] },
                  {
                    "_aliasable_expression": [
                      { "identifier:t.account_id": [{ ".": [] }] }
                    ]
                  },
                  { ",": [] },
                  {
                    "_aliasable_expression": [
                      {
                        "function_call": [
                          { "identifier:AVG": [] },
                          { "(": [] },
                          {
                            "argument": [
                              { "identifier:t.deals": [{ ".": [] }] }
                            ]
                          },
                          { ")": [] }
                        ]
                      },
                      { "as_alias": [{ "AS": [] }, { "identifier:deals": [] }] }
                    ]
                  },
                  { ",": [] },
                  {
                    "_aliasable_expression": [
                      {
                        "function_call": [
                          { "identifier:SUM": [] },
                          { "(": [] },
                          {
                            "argument": [
                              { "identifier:t.revenue_core": [{ ".": [] }] }
                            ]
                          },
                          { ")": [] }
                        ]
                      },
                      {
                        "as_alias": [
                          { "AS": [] },
                          { "identifier:revenue_core": [] }
                        ]
                      }
                    ]
                  },
                  { ",": [] },
                  {
                    "_aliasable_expression": [
                      {
                        "function_call": [
                          { "identifier:SUM": [] },
                          { "(": [] },
                          {
                            "argument": [
                              { "identifier:t.revenue_aux": [{ ".": [] }] }
                            ]
                          },
                          { ")": [] }
                        ]
                      },
                      {
                        "as_alias": [
                          { "AS": [] },
                          { "identifier:revenue_aux": [] }
                        ]
                      }
                    ]
                  },
                  { ",": [] },
                  {
                    "_aliasable_expression": [
                      {
                        "function_call": [
                          { "identifier:SUM": [] },
                          { "(": [] },
                          {
                            "argument": [
                              { "identifier:t.revenue": [{ ".": [] }] }
                            ]
                          },
                          { ")": [] }
                        ]
                      },
                      {
                        "as_alias": [{ "AS": [] }, { "identifier:revenue": [] }]
                      }
                    ]
                  }
                ]
              },
              {
                "from_clause": [
                  { "FROM": [] },
                  {
                    "from_item": [
                      {
                        "select_subexpression": [
                          { "(": [] },
                          {
                            "query_expr": [
                              {
                                "select": [
                                  { "SELECT": [] },
                                  {
                                    "select_list": [
                                      {
                                        "_aliasable_expression": [
                                          {
                                            "identifier:dr.date_day": [
                                              { ".": [] }
                                            ]
                                          }
                                        ]
                                      },
                                      { ",": [] },
                                      {
                                        "_aliasable_expression": [
                                          {
                                            "function_call": [
                                              {
                                                "identifier:DATE": [
                                                  { "DATE": [] }
                                                ]
                                              },
                                              { "(": [] },
                                              {
                                                "argument": [
                                                  { "identifier:date_day": [] }
                                                ]
                                              },
                                              { ",": [] },
                                              {
                                                "argument": [
                                                  {
                                                    "string:'start of month'": []
                                                  }
                                                ]
                                              },
                                              { ")": [] }
                                            ]
                                          },
                                          {
                                            "as_alias": [
                                              { "AS": [] },
                                              { "identifier:date_month": [] }
                                            ]
                                          }
                                        ]
                                      },
                                      { ",": [] },
                                      {
                                        "_aliasable_expression": [
                                          {
                                            "identifier:ds.account_id": [
                                              { ".": [] }
                                            ]
                                          }
                                        ]
                                      },
                                      { ",": [] },
                                      {
                                        "_aliasable_expression": [
                                          {
                                            "function_call": [
                                              { "identifier:COUNT": [] },
                                              { "(": [] },
                                              {
                                                "argument": [
                                                  {
                                                    "identifier:ds.deal_id": [
                                                      { ".": [] }
                                                    ]
                                                  }
                                                ]
                                              },
                                              { ")": [] }
                                            ]
                                          },
                                          {
                                            "as_alias": [
                                              { "AS": [] },
                                              { "identifier:deals": [] }
                                            ]
                                          }
                                        ]
                                      },
                                      { ",": [] },
                                      {
                                        "_aliasable_expression": [
                                          {
                                            "function_call": [
                                              { "identifier:SUM": [] },
                                              { "(": [] },
                                              {
                                                "argument": [
                                                  {
                                                    "identifier:ds.revenue_core_day": [
                                                      { ".": [] }
                                                    ]
                                                  }
                                                ]
                                              },
                                              { ")": [] }
                                            ]
                                          },
                                          {
                                            "as_alias": [
                                              { "AS": [] },
                                              { "identifier:revenue_core": [] }
                                            ]
                                          }
                                        ]
                                      },
                                      { ",": [] },
                                      {
                                        "_aliasable_expression": [
                                          {
                                            "function_call": [
                                              { "identifier:SUM": [] },
                                              { "(": [] },
                                              {
                                                "argument": [
                                                  {
                                                    "identifier:ds.revenue_aux_day": [
                                                      { ".": [] }
                                                    ]
                                                  }
                                                ]
                                              },
                                              { ")": [] }
                                            ]
                                          },
                                          {
                                            "as_alias": [
                                              { "AS": [] },
                                              { "identifier:revenue_aux": [] }
                                            ]
                                          }
                                        ]
                                      },
                                      { ",": [] },
                                      {
                                        "_aliasable_expression": [
                                          {
                                            "function_call": [
                                              { "identifier:SUM": [] },
                                              { "(": [] },
                                              {
                                                "argument": [
                                                  {
                                                    "identifier:ds.revenue_day": [
                                                      { ".": [] }
                                                    ]
                                                  }
                                                ]
                                              },
                                              { ")": [] }
                                            ]
                                          },
                                          {
                                            "as_alias": [
                                              { "AS": [] },
                                              { "identifier:revenue": [] }
                                            ]
                                          }
                                        ]
                                      }
                                    ]
                                  },
                                  {
                                    "from_clause": [
                                      { "FROM": [] },
                                      {
                                        "from_item": [
                                          {
                                            "join_operation": [
                                              {
                                                "from_item": [
                                                  {
                                                    "identifier:date_ranges": []
                                                  },
                                                  {
                                                    "as_alias": [
                                                      { "identifier:dr": [] }
                                                    ]
                                                  }
                                                ]
                                              },
                                              { "join_type": [{ "LEFT": [] }] },
                                              { "JOIN": [] },
                                              {
                                                "from_item": [
                                                  {
                                                    "identifier:deals_signed": []
                                                  },
                                                  {
                                                    "as_alias": [
                                                      { "identifier:ds": [] }
                                                    ]
                                                  }
                                                ]
                                              },
                                              {
                                                "join_condition": [
                                                  { "ON": [] },
                                                  {
                                                    "binary_expression": [
                                                      {
                                                        "binary_expression": [
                                                          {
                                                            "identifier:dr.date_day": [
                                                              { ".": [] }
                                                            ]
                                                          },
                                                          { ">=": [] },
                                                          {
                                                            "function_call": [
                                                              {
                                                                "identifier:date": [
                                                                  { "DATE": [] }
                                                                ]
                                                              },
                                                              { "(": [] },
                                                              {
                                                                "argument": [
                                                                  {
                                                                    "identifier:ds.contract_start_date": [
                                                                      {
                                                                        ".": []
                                                                      }
                                                                    ]
                                                                  }
                                                                ]
                                                              },
                                                              { ")": [] }
                                                            ]
                                                          }
                                                        ]
                                                      },
                                                      { "AND": [] },
                                                      {
                                                        "binary_expression": [
                                                          {
                                                            "identifier:dr.date_day": [
                                                              { ".": [] }
                                                            ]
                                                          },
                                                          { "<=": [] },
                                                          {
                                                            "function_call": [
                                                              {
                                                                "identifier:date": [
                                                                  { "DATE": [] }
                                                                ]
                                                              },
                                                              { "(": [] },
                                                              {
                                                                "argument": [
                                                                  {
                                                                    "identifier:ds.contract_end_date": [
                                                                      {
                                                                        ".": []
                                                                      }
                                                                    ]
                                                                  }
                                                                ]
                                                              },
                                                              { ")": [] }
                                                            ]
                                                          }
                                                        ]
                                                      }
                                                    ]
                                                  }
                                                ]
                                              }
                                            ]
                                          }
                                        ]
                                      }
                                    ]
                                  },
                                  {
                                    "group_by_clause": [
                                      { "GROUP_BY": [] },
                                      { "GROUP_BY": [] },
                                      {
                                        "grouping_item": [
                                          {
                                            "identifier:dr.date_day": [
                                              { ".": [] }
                                            ]
                                          }
                                        ]
                                      },
                                      { ",": [] },
                                      {
                                        "grouping_item": [
                                          {
                                            "identifier:ds.account_id": [
                                              { ".": [] }
                                            ]
                                          }
                                        ]
                                      }
                                    ]
                                  }
                                ]
                              }
                            ]
                          },
                          { ")": [] }
                        ]
                      },
                      { "as_alias": [{ "identifier:t": [] }] }
                    ]
                  }
                ]
              },
              {
                "group_by_clause": [
                  { "GROUP_BY": [] },
                  { "GROUP_BY": [] },
                  { "grouping_item": [{ "identifier:account_id": [] }] },
                  { ",": [] },
                  { "grouping_item": [{ "identifier:date_month": [] }] }
                ]
              }
            ]
          }
        ]
      },
      "sources": [
        {
          "node": {
            "query_expr": [
              {
                "select": [
                  { "SELECT": [] },
                  {
                    "select_list": [
                      {
                        "_aliasable_expression": [
                          { "identifier:dr.date_day": [{ ".": [] }] }
                        ]
                      },
                      { ",": [] },
                      {
                        "_aliasable_expression": [
                          {
                            "function_call": [
                              { "identifier:DATE": [{ "DATE": [] }] },
                              { "(": [] },
                              { "argument": [{ "identifier:date_day": [] }] },
                              { ",": [] },
                              {
                                "argument": [{ "string:'start of month'": [] }]
                              },
                              { ")": [] }
                            ]
                          },
                          {
                            "as_alias": [
                              { "AS": [] },
                              { "identifier:date_month": [] }
                            ]
                          }
                        ]
                      },
                      { ",": [] },
                      {
                        "_aliasable_expression": [
                          { "identifier:ds.account_id": [{ ".": [] }] }
                        ]
                      },
                      { ",": [] },
                      {
                        "_aliasable_expression": [
                          {
                            "function_call": [
                              { "identifier:COUNT": [] },
                              { "(": [] },
                              {
                                "argument": [
                                  { "identifier:ds.deal_id": [{ ".": [] }] }
                                ]
                              },
                              { ")": [] }
                            ]
                          },
                          {
                            "as_alias": [
                              { "AS": [] },
                              { "identifier:deals": [] }
                            ]
                          }
                        ]
                      },
                      { ",": [] },
                      {
                        "_aliasable_expression": [
                          {
                            "function_call": [
                              { "identifier:SUM": [] },
                              { "(": [] },
                              {
                                "argument": [
                                  {
                                    "identifier:ds.revenue_core_day": [
                                      { ".": [] }
                                    ]
                                  }
                                ]
                              },
                              { ")": [] }
                            ]
                          },
                          {
                            "as_alias": [
                              { "AS": [] },
                              { "identifier:revenue_core": [] }
                            ]
                          }
                        ]
                      },
                      { ",": [] },
                      {
                        "_aliasable_expression": [
                          {
                            "function_call": [
                              { "identifier:SUM": [] },
                              { "(": [] },
                              {
                                "argument": [
                                  {
                                    "identifier:ds.revenue_aux_day": [
                                      { ".": [] }
                                    ]
                                  }
                                ]
                              },
                              { ")": [] }
                            ]
                          },
                          {
                            "as_alias": [
                              { "AS": [] },
                              { "identifier:revenue_aux": [] }
                            ]
                          }
                        ]
                      },
                      { ",": [] },
                      {
                        "_aliasable_expression": [
                          {
                            "function_call": [
                              { "identifier:SUM": [] },
                              { "(": [] },
                              {
                                "argument": [
                                  { "identifier:ds.revenue_day": [{ ".": [] }] }
                                ]
                              },
                              { ")": [] }
                            ]
                          },
                          {
                            "as_alias": [
                              { "AS": [] },
                              { "identifier:revenue": [] }
                            ]
                          }
                        ]
                      }
                    ]
                  },
                  {
                    "from_clause": [
                      { "FROM": [] },
                      {
                        "from_item": [
                          {
                            "join_operation": [
                              {
                                "from_item": [
                                  { "identifier:date_ranges": [] },
                                  { "as_alias": [{ "identifier:dr": [] }] }
                                ]
                              },
                              { "join_type": [{ "LEFT": [] }] },
                              { "JOIN": [] },
                              {
                                "from_item": [
                                  { "identifier:deals_signed": [] },
                                  { "as_alias": [{ "identifier:ds": [] }] }
                                ]
                              },
                              {
                                "join_condition": [
                                  { "ON": [] },
                                  {
                                    "binary_expression": [
                                      {
                                        "binary_expression": [
                                          {
                                            "identifier:dr.date_day": [
                                              { ".": [] }
                                            ]
                                          },
                                          { ">=": [] },
                                          {
                                            "function_call": [
                                              {
                                                "identifier:date": [
                                                  { "DATE": [] }
                                                ]
                                              },
                                              { "(": [] },
                                              {
                                                "argument": [
                                                  {
                                                    "identifier:ds.contract_start_date": [
                                                      { ".": [] }
                                                    ]
                                                  }
                                                ]
                                              },
                                              { ")": [] }
                                            ]
                                          }
                                        ]
                                      },
                                      { "AND": [] },
                                      {
                                        "binary_expression": [
                                          {
                                            "identifier:dr.date_day": [
                                              { ".": [] }
                                            ]
                                          },
                                          { "<=": [] },
                                          {
                                            "function_call": [
                                              {
                                                "identifier:date": [
                                                  { "DATE": [] }
                                                ]
                                              },
                                              { "(": [] },
                                              {
                                                "argument": [
                                                  {
                                                    "identifier:ds.contract_end_date": [
                                                      { ".": [] }
                                                    ]
                                                  }
                                                ]
                                              },
                                              { ")": [] }
                                            ]
                                          }
                                        ]
                                      }
                                    ]
                                  }
                                ]
                              }
                            ]
                          }
                        ]
                      }
                    ]
                  },
                  {
                    "group_by_clause": [
                      { "GROUP_BY": [] },
                      { "GROUP_BY": [] },
                      {
                        "grouping_item": [
                          { "identifier:dr.date_day": [{ ".": [] }] }
                        ]
                      },
                      { ",": [] },
                      {
                        "grouping_item": [
                          { "identifier:ds.account_id": [{ ".": [] }] }
                        ]
                      }
                    ]
                  }
                ]
              }
            ]
          },
          "sources": [
            {
              "node": { "identifier:date_ranges": [] },
              "dataset": "None",
              "table": "date_ranges",
              "alias": "dr"
            },
            {
              "node": { "identifier:deals_signed": [] },
              "dataset": "None",
              "table": "deals_signed",
              "alias": "ds"
            }
          ],
          "ops": [
            {
              "node": {
                "identifier:dr.date_day": [{ ".": [] }]
              },
              "columns": [
                {
                  "node": [
                    { "identifier:dr.date_day": [{ ".": [] }] },
                    { "identifier:dr.date_day": [{ ".": [] }] },
                    { "identifier:dr.date_day": [{ ".": [] }] },
                    { "identifier:dr.date_day": [{ ".": [] }] }
                  ],
                  "dataset": "None",
                  "table": "date_ranges",
                  "column": "date_day"
                }
              ],
              "alias": "None"
            },
            {
              "node": {
                "function_call": [
                  { "identifier:DATE": [{ "DATE": [] }] },
                  { "(": [] },
                  { "argument": [{ "identifier:date_day": [] }] },
                  { ",": [] },
                  { "argument": [{ "string:'start of month'": [] }] },
                  { ")": [] }
                ]
              },
              "columns": [
                {
                  "node": [{ "identifier:date_day": [] }],
                  "dataset": "None",
                  "table": "None",
                  "column": "date_day"
                }
              ],
              "alias": "date_month"
            },
            {
              "node": {
                "identifier:ds.account_id": [{ ".": [] }]
              },
              "columns": [
                {
                  "node": [
                    { "identifier:ds.account_id": [{ ".": [] }] },
                    { "identifier:ds.account_id": [{ ".": [] }] }
                  ],
                  "dataset": "None",
                  "table": "deals_signed",
                  "column": "account_id"
                }
              ],
              "alias": "None"
            },
            {
              "node": {
                "function_call": [
                  { "identifier:COUNT": [] },
                  { "(": [] },
                  { "argument": [{ "identifier:ds.deal_id": [{ ".": [] }] }] },
                  { ")": [] }
                ]
              },
              "columns": [
                {
                  "node": [{ "identifier:ds.deal_id": [{ ".": [] }] }],
                  "dataset": "None",
                  "table": "deals_signed",
                  "column": "deal_id"
                }
              ],
              "alias": "deals"
            },
            {
              "node": {
                "function_call": [
                  { "identifier:SUM": [] },
                  { "(": [] },
                  {
                    "argument": [
                      { "identifier:ds.revenue_core_day": [{ ".": [] }] }
                    ]
                  },
                  { ")": [] }
                ]
              },
              "columns": [
                {
                  "node": [{ "identifier:ds.revenue_core_day": [{ ".": [] }] }],
                  "dataset": "None",
                  "table": "deals_signed",
                  "column": "revenue_core_day"
                }
              ],
              "alias": "revenue_core"
            },
            {
              "node": {
                "function_call": [
                  { "identifier:SUM": [] },
                  { "(": [] },
                  {
                    "argument": [
                      { "identifier:ds.revenue_aux_day": [{ ".": [] }] }
                    ]
                  },
                  { ")": [] }
                ]
              },
              "columns": [
                {
                  "node": [{ "identifier:ds.revenue_aux_day": [{ ".": [] }] }],
                  "dataset": "None",
                  "table": "deals_signed",
                  "column": "revenue_aux_day"
                }
              ],
              "alias": "revenue_aux"
            },
            {
              "node": {
                "function_call": [
                  { "identifier:SUM": [] },
                  { "(": [] },
                  {
                    "argument": [{ "identifier:ds.revenue_day": [{ ".": [] }] }]
                  },
                  { ")": [] }
                ]
              },
              "columns": [
                {
                  "node": [{ "identifier:ds.revenue_day": [{ ".": [] }] }],
                  "dataset": "None",
                  "table": "deals_signed",
                  "column": "revenue_day"
                }
              ],
              "alias": "revenue"
            },
            {
              "node": {
                "binary_expression": [
                  {
                    "binary_expression": [
                      { "identifier:dr.date_day": [{ ".": [] }] },
                      { ">=": [] },
                      {
                        "function_call": [
                          { "identifier:date": [{ "DATE": [] }] },
                          { "(": [] },
                          {
                            "argument": [
                              {
                                "identifier:ds.contract_start_date": [
                                  { ".": [] }
                                ]
                              }
                            ]
                          },
                          { ")": [] }
                        ]
                      }
                    ]
                  },
                  { "AND": [] },
                  {
                    "binary_expression": [
                      { "identifier:dr.date_day": [{ ".": [] }] },
                      { "<=": [] },
                      {
                        "function_call": [
                          { "identifier:date": [{ "DATE": [] }] },
                          { "(": [] },
                          {
                            "argument": [
                              {
                                "identifier:ds.contract_end_date": [{ ".": [] }]
                              }
                            ]
                          },
                          { ")": [] }
                        ]
                      }
                    ]
                  }
                ]
              },
              "columns": [
                {
                  "node": [
                    { "identifier:dr.date_day": [{ ".": [] }] },
                    { "identifier:dr.date_day": [{ ".": [] }] },
                    { "identifier:dr.date_day": [{ ".": [] }] },
                    { "identifier:dr.date_day": [{ ".": [] }] }
                  ],
                  "dataset": "None",
                  "table": "date_ranges",
                  "column": "date_day"
                },
                {
                  "node": [
                    { "identifier:ds.contract_start_date": [{ ".": [] }] }
                  ],
                  "dataset": "None",
                  "table": "deals_signed",
                  "column": "contract_start_date"
                },
                {
                  "node": [
                    { "identifier:ds.contract_end_date": [{ ".": [] }] }
                  ],
                  "dataset": "None",
                  "table": "deals_signed",
                  "column": "contract_end_date"
                }
              ],
              "alias": "None"
            },
            {
              "node": {
                "identifier:dr.date_day": [{ ".": [] }]
              },
              "columns": [
                {
                  "node": [
                    { "identifier:dr.date_day": [{ ".": [] }] },
                    { "identifier:dr.date_day": [{ ".": [] }] },
                    { "identifier:dr.date_day": [{ ".": [] }] },
                    { "identifier:dr.date_day": [{ ".": [] }] }
                  ],
                  "dataset": "None",
                  "table": "date_ranges",
                  "column": "date_day"
                }
              ],
              "alias": "None"
            },
            {
              "node": {
                "identifier:ds.account_id": [{ ".": [] }]
              },
              "columns": [
                {
                  "node": [
                    { "identifier:ds.account_id": [{ ".": [] }] },
                    { "identifier:ds.account_id": [{ ".": [] }] }
                  ],
                  "dataset": "None",
                  "table": "deals_signed",
                  "column": "account_id"
                }
              ],
              "alias": "None"
            }
          ],
          "alias": "None"
        }
      ],
      "ops": [
        {
          "node": {
            "identifier:t.date_month": [{ ".": [] }]
          },
          "columns": [
            {
              "node": [{ "identifier:t.date_month": [{ ".": [] }] }],
              "dataset": "None",
              "table": "t",
              "column": "date_month"
            }
          ],
          "alias": "None"
        },
        {
          "node": {
            "identifier:t.account_id": [{ ".": [] }]
          },
          "columns": [
            {
              "node": [{ "identifier:t.account_id": [{ ".": [] }] }],
              "dataset": "None",
              "table": "t",
              "column": "account_id"
            }
          ],
          "alias": "None"
        },
        {
          "node": {
            "function_call": [
              { "identifier:AVG": [] },
              { "(": [] },
              { "argument": [{ "identifier:t.deals": [{ ".": [] }] }] },
              { ")": [] }
            ]
          },
          "columns": [
            {
              "node": [{ "identifier:t.deals": [{ ".": [] }] }],
              "dataset": "None",
              "table": "t",
              "column": "deals"
            }
          ],
          "alias": "deals"
        },
        {
          "node": {
            "function_call": [
              { "identifier:SUM": [] },
              { "(": [] },
              { "argument": [{ "identifier:t.revenue_core": [{ ".": [] }] }] },
              { ")": [] }
            ]
          },
          "columns": [
            {
              "node": [{ "identifier:t.revenue_core": [{ ".": [] }] }],
              "dataset": "None",
              "table": "t",
              "column": "revenue_core"
            }
          ],
          "alias": "revenue_core"
        },
        {
          "node": {
            "function_call": [
              { "identifier:SUM": [] },
              { "(": [] },
              { "argument": [{ "identifier:t.revenue_aux": [{ ".": [] }] }] },
              { ")": [] }
            ]
          },
          "columns": [
            {
              "node": [{ "identifier:t.revenue_aux": [{ ".": [] }] }],
              "dataset": "None",
              "table": "t",
              "column": "revenue_aux"
            }
          ],
          "alias": "revenue_aux"
        },
        {
          "node": {
            "function_call": [
              { "identifier:SUM": [] },
              { "(": [] },
              { "argument": [{ "identifier:t.revenue": [{ ".": [] }] }] },
              { ")": [] }
            ]
          },
          "columns": [
            {
              "node": [{ "identifier:t.revenue": [{ ".": [] }] }],
              "dataset": "None",
              "table": "t",
              "column": "revenue"
            }
          ],
          "alias": "revenue"
        },
        {
          "node": { "identifier:account_id": [] },
          "columns": [
            {
              "node": [{ "identifier:account_id": [] }],
              "dataset": "None",
              "table": "None",
              "column": "account_id"
            }
          ],
          "alias": "None"
        },
        {
          "node": { "identifier:date_month": [] },
          "columns": [
            {
              "node": [{ "identifier:date_month": [] }],
              "dataset": "None",
              "table": "None",
              "column": "date_month"
            }
          ],
          "alias": "None"
        }
      ],
      "alias": "None"
    },
    {
      "node": {
        "query_expr": [
          {
            "select": [
              { "SELECT": [] },
              {
                "select_list": [
                  {
                    "select_all": [
                      { "asterisk_expression": [{ ".": [] }, { "*": [] }] }
                    ]
                  },
                  { ",": [] },
                  {
                    "_aliasable_expression": [
                      {
                        "casewhen_expression": [
                          { "CASE": [] },
                          {
                            "casewhen_clause": [
                              { "WHEN_MATCHED": [] },
                              {
                                "binary_expression": [
                                  { "identifier:t.revenue_12m": [{ ".": [] }] },
                                  { "<=": [] },
                                  { "number:300": [] }
                                ]
                              },
                              { "THEN": [] },
                              { "string:'Small'": [] }
                            ]
                          },
                          {
                            "casewhen_clause": [
                              { "WHEN_MATCHED": [] },
                              {
                                "binary_expression": [
                                  {
                                    "binary_expression": [
                                      {
                                        "identifier:t.revenue_12m": [
                                          { ".": [] }
                                        ]
                                      },
                                      { ">": [] },
                                      { "number:300": [] }
                                    ]
                                  },
                                  { "AND": [] },
                                  {
                                    "binary_expression": [
                                      {
                                        "identifier:t.revenue_12m": [
                                          { ".": [] }
                                        ]
                                      },
                                      { "<=": [] },
                                      { "number:600": [] }
                                    ]
                                  }
                                ]
                              },
                              { "THEN": [] },
                              { "string:'Medium'": [] }
                            ]
                          },
                          {
                            "casewhen_clause": [
                              { "WHEN_MATCHED": [] },
                              {
                                "binary_expression": [
                                  { "identifier:t.revenue_12m": [{ ".": [] }] },
                                  { ">": [] },
                                  { "number:600": [] }
                                ]
                              },
                              { "THEN": [] },
                              { "string:'Large'": [] }
                            ]
                          },
                          {
                            "caseelse_clause": [
                              { "ELSE": [] },
                              { "NULL": [{ "NOT_NULL": [] }] }
                            ]
                          },
                          { "END_IF": [] }
                        ]
                      },
                      {
                        "as_alias": [
                          { "AS": [] },
                          { "identifier:account_size": [] }
                        ]
                      }
                    ]
                  }
                ]
              },
              {
                "from_clause": [
                  { "FROM": [] },
                  {
                    "from_item": [
                      {
                        "select_subexpression": [
                          { "(": [] },
                          {
                            "query_expr": [
                              {
                                "select": [
                                  { "SELECT": [] },
                                  {
                                    "select_list": [
                                      {
                                        "_aliasable_expression": [
                                          { "identifier:account_id": [] }
                                        ]
                                      },
                                      { ",": [] },
                                      {
                                        "_aliasable_expression": [
                                          { "identifier:date_month": [] }
                                        ]
                                      },
                                      { ",": [] },
                                      {
                                        "_aliasable_expression": [
                                          { "identifier:revenue": [] }
                                        ]
                                      },
                                      { ",": [] },
                                      {
                                        "_aliasable_expression": [
                                          { "identifier:revenue_core": [] }
                                        ]
                                      },
                                      { ",": [] },
                                      {
                                        "_aliasable_expression": [
                                          { "identifier:revenue_aux": [] }
                                        ]
                                      },
                                      { ",": [] },
                                      {
                                        "_aliasable_expression": [
                                          { "identifier:deals": [] }
                                        ]
                                      },
                                      { ",": [] },
                                      {
                                        "_aliasable_expression": [
                                          {
                                            "identifier:accounts.name": [
                                              { ".": [] }
                                            ]
                                          }
                                        ]
                                      },
                                      { ",": [] },
                                      {
                                        "_aliasable_expression": [
                                          {
                                            "identifier:accounts.industry": [
                                              { ".": [] }
                                            ]
                                          }
                                        ]
                                      },
                                      { ",": [] },
                                      {
                                        "_aliasable_expression": [
                                          {
                                            "identifier:accounts.country": [
                                              { ".": [] }
                                            ]
                                          }
                                        ]
                                      },
                                      { ",": [] },
                                      {
                                        "_aliasable_expression": [
                                          {
                                            "casewhen_expression": [
                                              { "CASE": [] },
                                              {
                                                "casewhen_clause": [
                                                  { "WHEN_MATCHED": [] },
                                                  {
                                                    "binary_expression": [
                                                      {
                                                        "identifier:c.region": [
                                                          { ".": [] }
                                                        ]
                                                      },
                                                      { "IN": [] },
                                                      {
                                                        "struct": [
                                                          { "(": [] },
                                                          {
                                                            "string:'Americas'": []
                                                          },
                                                          { ",": [] },
                                                          {
                                                            "string:'Europe'": []
                                                          },
                                                          { ")": [] }
                                                        ]
                                                      }
                                                    ]
                                                  },
                                                  { "THEN": [] },
                                                  { "string:'North-West'": [] }
                                                ]
                                              },
                                              {
                                                "casewhen_clause": [
                                                  { "WHEN_MATCHED": [] },
                                                  {
                                                    "binary_expression": [
                                                      {
                                                        "identifier:c.region": [
                                                          { ".": [] }
                                                        ]
                                                      },
                                                      { "IN": [] },
                                                      {
                                                        "struct": [
                                                          { "(": [] },
                                                          {
                                                            "string:'Africa'": []
                                                          },
                                                          { ",": [] },
                                                          {
                                                            "string:'Asia'": []
                                                          },
                                                          { ")": [] }
                                                        ]
                                                      }
                                                    ]
                                                  },
                                                  { "THEN": [] },
                                                  { "string:'South-East'": [] }
                                                ]
                                              },
                                              {
                                                "caseelse_clause": [
                                                  { "ELSE": [] },
                                                  {
                                                    "NULL": [{ "NOT_NULL": [] }]
                                                  }
                                                ]
                                              },
                                              { "END_IF": [] }
                                            ]
                                          },
                                          {
                                            "as_alias": [
                                              { "AS": [] },
                                              {
                                                "identifier:region_cluster": []
                                              }
                                            ]
                                          }
                                        ]
                                      },
                                      { ",": [] },
                                      {
                                        "_aliasable_expression": [
                                          {
                                            "identifier:accounts.priority": [
                                              { ".": [] }
                                            ]
                                          }
                                        ]
                                      },
                                      { ",": [] },
                                      {
                                        "_aliasable_expression": [
                                          {
                                            "function_call": [
                                              { "identifier:SUM": [] },
                                              { "(": [] },
                                              {
                                                "argument": [
                                                  { "identifier:revenue": [] }
                                                ]
                                              },
                                              { ")": [] },
                                              {
                                                "analytics_clause": [
                                                  { "OVER": [] },
                                                  {
                                                    "over_clause": [
                                                      {
                                                        "window_specification": [
                                                          { "(": [] },
                                                          {
                                                            "window_partition_clause": [
                                                              {
                                                                "PARTITION_COLUMNS": []
                                                              },
                                                              {
                                                                "GROUP_BY": []
                                                              },
                                                              {
                                                                "_expression": [
                                                                  {
                                                                    "identifier:account_id": []
                                                                  }
                                                                ]
                                                              }
                                                            ]
                                                          },
                                                          {
                                                            "order_by_clause": [
                                                              {
                                                                "ORDER_BY": []
                                                              },
                                                              {
                                                                "GROUP_BY": []
                                                              },
                                                              {
                                                                "order_by_clause_body": [
                                                                  {
                                                                    "identifier:date_month": []
                                                                  }
                                                                ]
                                                              }
                                                            ]
                                                          },
                                                          {
                                                            "window_frame_clause": [
                                                              {
                                                                "rows_range": [
                                                                  { "ROWS": [] }
                                                                ]
                                                              },
                                                              {
                                                                "window_frame_between": [
                                                                  {
                                                                    "BETWEEN": []
                                                                  },
                                                                  {
                                                                    "window_numeric_preceding": [
                                                                      {
                                                                        "number:11": []
                                                                      },
                                                                      {
                                                                        "PRECEDING": []
                                                                      }
                                                                    ]
                                                                  },
                                                                  { "AND": [] },
                                                                  {
                                                                    "between_to": [
                                                                      {
                                                                        "keyword_current_row": [
                                                                          {
                                                                            "CURRENT_ROW": []
                                                                          },
                                                                          {
                                                                            "ROW": []
                                                                          }
                                                                        ]
                                                                      }
                                                                    ]
                                                                  }
                                                                ]
                                                              }
                                                            ]
                                                          },
                                                          { ")": [] }
                                                        ]
                                                      }
                                                    ]
                                                  }
                                                ]
                                              }
                                            ]
                                          },
                                          {
                                            "as_alias": [
                                              { "AS": [] },
                                              { "identifier:revenue_12m": [] }
                                            ]
                                          }
                                        ]
                                      }
                                    ]
                                  },
                                  {
                                    "from_clause": [
                                      { "FROM": [] },
                                      {
                                        "from_item": [
                                          {
                                            "join_operation": [
                                              {
                                                "from_item": [
                                                  {
                                                    "join_operation": [
                                                      {
                                                        "from_item": [
                                                          {
                                                            "identifier:accounts_revenue": []
                                                          }
                                                        ]
                                                      },
                                                      { "JOIN": [] },
                                                      {
                                                        "from_item": [
                                                          {
                                                            "identifier:accounts": []
                                                          }
                                                        ]
                                                      },
                                                      {
                                                        "join_condition": [
                                                          { "USING": [] },
                                                          { "(": [] },
                                                          {
                                                            "identifier:account_id": []
                                                          },
                                                          { ")": [] }
                                                        ]
                                                      }
                                                    ]
                                                  }
                                                ]
                                              },
                                              { "join_type": [{ "LEFT": [] }] },
                                              { "JOIN": [] },
                                              {
                                                "from_item": [
                                                  {
                                                    "identifier:countries": []
                                                  },
                                                  {
                                                    "as_alias": [
                                                      { "identifier:c": [] }
                                                    ]
                                                  }
                                                ]
                                              },
                                              {
                                                "join_condition": [
                                                  { "USING": [] },
                                                  { "(": [] },
                                                  { "identifier:country": [] },
                                                  { ")": [] }
                                                ]
                                              }
                                            ]
                                          }
                                        ]
                                      }
                                    ]
                                  }
                                ]
                              }
                            ]
                          },
                          { ")": [] }
                        ]
                      },
                      { "as_alias": [{ "AS": [] }, { "identifier:t": [] }] }
                    ]
                  }
                ]
              }
            ]
          }
        ]
      },
      "sources": [
        {
          "node": {
            "query_expr": [
              {
                "select": [
                  { "SELECT": [] },
                  {
                    "select_list": [
                      {
                        "_aliasable_expression": [
                          { "identifier:account_id": [] }
                        ]
                      },
                      { ",": [] },
                      {
                        "_aliasable_expression": [
                          { "identifier:date_month": [] }
                        ]
                      },
                      { ",": [] },
                      {
                        "_aliasable_expression": [{ "identifier:revenue": [] }]
                      },
                      { ",": [] },
                      {
                        "_aliasable_expression": [
                          { "identifier:revenue_core": [] }
                        ]
                      },
                      { ",": [] },
                      {
                        "_aliasable_expression": [
                          { "identifier:revenue_aux": [] }
                        ]
                      },
                      { ",": [] },
                      { "_aliasable_expression": [{ "identifier:deals": [] }] },
                      { ",": [] },
                      {
                        "_aliasable_expression": [
                          { "identifier:accounts.name": [{ ".": [] }] }
                        ]
                      },
                      { ",": [] },
                      {
                        "_aliasable_expression": [
                          { "identifier:accounts.industry": [{ ".": [] }] }
                        ]
                      },
                      { ",": [] },
                      {
                        "_aliasable_expression": [
                          { "identifier:accounts.country": [{ ".": [] }] }
                        ]
                      },
                      { ",": [] },
                      {
                        "_aliasable_expression": [
                          {
                            "casewhen_expression": [
                              { "CASE": [] },
                              {
                                "casewhen_clause": [
                                  { "WHEN_MATCHED": [] },
                                  {
                                    "binary_expression": [
                                      { "identifier:c.region": [{ ".": [] }] },
                                      { "IN": [] },
                                      {
                                        "struct": [
                                          { "(": [] },
                                          { "string:'Americas'": [] },
                                          { ",": [] },
                                          { "string:'Europe'": [] },
                                          { ")": [] }
                                        ]
                                      }
                                    ]
                                  },
                                  { "THEN": [] },
                                  { "string:'North-West'": [] }
                                ]
                              },
                              {
                                "casewhen_clause": [
                                  { "WHEN_MATCHED": [] },
                                  {
                                    "binary_expression": [
                                      { "identifier:c.region": [{ ".": [] }] },
                                      { "IN": [] },
                                      {
                                        "struct": [
                                          { "(": [] },
                                          { "string:'Africa'": [] },
                                          { ",": [] },
                                          { "string:'Asia'": [] },
                                          { ")": [] }
                                        ]
                                      }
                                    ]
                                  },
                                  { "THEN": [] },
                                  { "string:'South-East'": [] }
                                ]
                              },
                              {
                                "caseelse_clause": [
                                  { "ELSE": [] },
                                  { "NULL": [{ "NOT_NULL": [] }] }
                                ]
                              },
                              { "END_IF": [] }
                            ]
                          },
                          {
                            "as_alias": [
                              { "AS": [] },
                              { "identifier:region_cluster": [] }
                            ]
                          }
                        ]
                      },
                      { ",": [] },
                      {
                        "_aliasable_expression": [
                          { "identifier:accounts.priority": [{ ".": [] }] }
                        ]
                      },
                      { ",": [] },
                      {
                        "_aliasable_expression": [
                          {
                            "function_call": [
                              { "identifier:SUM": [] },
                              { "(": [] },
                              { "argument": [{ "identifier:revenue": [] }] },
                              { ")": [] },
                              {
                                "analytics_clause": [
                                  { "OVER": [] },
                                  {
                                    "over_clause": [
                                      {
                                        "window_specification": [
                                          { "(": [] },
                                          {
                                            "window_partition_clause": [
                                              { "PARTITION_COLUMNS": [] },
                                              { "GROUP_BY": [] },
                                              {
                                                "_expression": [
                                                  {
                                                    "identifier:account_id": []
                                                  }
                                                ]
                                              }
                                            ]
                                          },
                                          {
                                            "order_by_clause": [
                                              { "ORDER_BY": [] },
                                              { "GROUP_BY": [] },
                                              {
                                                "order_by_clause_body": [
                                                  {
                                                    "identifier:date_month": []
                                                  }
                                                ]
                                              }
                                            ]
                                          },
                                          {
                                            "window_frame_clause": [
                                              {
                                                "rows_range": [{ "ROWS": [] }]
                                              },
                                              {
                                                "window_frame_between": [
                                                  { "BETWEEN": [] },
                                                  {
                                                    "window_numeric_preceding": [
                                                      { "number:11": [] },
                                                      { "PRECEDING": [] }
                                                    ]
                                                  },
                                                  { "AND": [] },
                                                  {
                                                    "between_to": [
                                                      {
                                                        "keyword_current_row": [
                                                          { "CURRENT_ROW": [] },
                                                          { "ROW": [] }
                                                        ]
                                                      }
                                                    ]
                                                  }
                                                ]
                                              }
                                            ]
                                          },
                                          { ")": [] }
                                        ]
                                      }
                                    ]
                                  }
                                ]
                              }
                            ]
                          },
                          {
                            "as_alias": [
                              { "AS": [] },
                              { "identifier:revenue_12m": [] }
                            ]
                          }
                        ]
                      }
                    ]
                  },
                  {
                    "from_clause": [
                      { "FROM": [] },
                      {
                        "from_item": [
                          {
                            "join_operation": [
                              {
                                "from_item": [
                                  {
                                    "join_operation": [
                                      {
                                        "from_item": [
                                          { "identifier:accounts_revenue": [] }
                                        ]
                                      },
                                      { "JOIN": [] },
                                      {
                                        "from_item": [
                                          { "identifier:accounts": [] }
                                        ]
                                      },
                                      {
                                        "join_condition": [
                                          { "USING": [] },
                                          { "(": [] },
                                          { "identifier:account_id": [] },
                                          { ")": [] }
                                        ]
                                      }
                                    ]
                                  }
                                ]
                              },
                              { "join_type": [{ "LEFT": [] }] },
                              { "JOIN": [] },
                              {
                                "from_item": [
                                  { "identifier:countries": [] },
                                  { "as_alias": [{ "identifier:c": [] }] }
                                ]
                              },
                              {
                                "join_condition": [
                                  { "USING": [] },
                                  { "(": [] },
                                  { "identifier:country": [] },
                                  { ")": [] }
                                ]
                              }
                            ]
                          }
                        ]
                      }
                    ]
                  }
                ]
              }
            ]
          },
          "sources": [
            {
              "node": { "identifier:accounts_revenue": [] },
              "dataset": "None",
              "table": "accounts_revenue",
              "alias": "None"
            },
            {
              "node": { "identifier:accounts": [] },
              "dataset": "None",
              "table": "accounts",
              "alias": "None"
            },
            {
              "node": { "identifier:countries": [] },
              "dataset": "None",
              "table": "countries",
              "alias": "c"
            }
          ],
          "ops": [
            {
              "node": { "identifier:account_id": [] },
              "columns": [
                {
                  "node": [
                    { "identifier:account_id": [] },
                    { "identifier:account_id": [] },
                    { "identifier:account_id": [] }
                  ],
                  "dataset": "None",
                  "table": "accounts",
                  "column": "account_id"
                }
              ],
              "alias": "None"
            },
            {
              "node": { "identifier:date_month": [] },
              "columns": [
                {
                  "node": [
                    { "identifier:date_month": [] },
                    { "identifier:date_month": [] }
                  ],
                  "dataset": "None",
                  "table": "accounts",
                  "column": "date_month"
                }
              ],
              "alias": "None"
            },
            {
              "node": { "identifier:revenue": [] },
              "columns": [
                {
                  "node": [
                    { "identifier:revenue": [] },
                    { "identifier:revenue": [] }
                  ],
                  "dataset": "None",
                  "table": "accounts",
                  "column": "revenue"
                }
              ],
              "alias": "None"
            },
            {
              "node": { "identifier:revenue_core": [] },
              "columns": [
                {
                  "node": [{ "identifier:revenue_core": [] }],
                  "dataset": "None",
                  "table": "accounts",
                  "column": "revenue_core"
                }
              ],
              "alias": "None"
            },
            {
              "node": { "identifier:revenue_aux": [] },
              "columns": [
                {
                  "node": [{ "identifier:revenue_aux": [] }],
                  "dataset": "None",
                  "table": "accounts",
                  "column": "revenue_aux"
                }
              ],
              "alias": "None"
            },
            {
              "node": { "identifier:deals": [] },
              "columns": [
                {
                  "node": [{ "identifier:deals": [] }],
                  "dataset": "None",
                  "table": "accounts",
                  "column": "deals"
                }
              ],
              "alias": "None"
            },
            {
              "node": {
                "identifier:accounts.name": [{ ".": [] }]
              },
              "columns": [
                {
                  "node": [{ "identifier:accounts.name": [{ ".": [] }] }],
                  "dataset": "None",
                  "table": "accounts",
                  "column": "name"
                }
              ],
              "alias": "None"
            },
            {
              "node": {
                "identifier:accounts.industry": [{ ".": [] }]
              },
              "columns": [
                {
                  "node": [{ "identifier:accounts.industry": [{ ".": [] }] }],
                  "dataset": "None",
                  "table": "accounts",
                  "column": "industry"
                }
              ],
              "alias": "None"
            },
            {
              "node": {
                "identifier:accounts.country": [{ ".": [] }]
              },
              "columns": [
                {
                  "node": [
                    { "identifier:accounts.country": [{ ".": [] }] },
                    { "identifier:country": [] }
                  ],
                  "dataset": "None",
                  "table": "accounts",
                  "column": "country"
                }
              ],
              "alias": "None"
            },
            {
              "node": {
                "casewhen_expression": [
                  { "CASE": [] },
                  {
                    "casewhen_clause": [
                      { "WHEN_MATCHED": [] },
                      {
                        "binary_expression": [
                          { "identifier:c.region": [{ ".": [] }] },
                          { "IN": [] },
                          {
                            "struct": [
                              { "(": [] },
                              { "string:'Americas'": [] },
                              { ",": [] },
                              { "string:'Europe'": [] },
                              { ")": [] }
                            ]
                          }
                        ]
                      },
                      { "THEN": [] },
                      { "string:'North-West'": [] }
                    ]
                  },
                  {
                    "casewhen_clause": [
                      { "WHEN_MATCHED": [] },
                      {
                        "binary_expression": [
                          { "identifier:c.region": [{ ".": [] }] },
                          { "IN": [] },
                          {
                            "struct": [
                              { "(": [] },
                              { "string:'Africa'": [] },
                              { ",": [] },
                              { "string:'Asia'": [] },
                              { ")": [] }
                            ]
                          }
                        ]
                      },
                      { "THEN": [] },
                      { "string:'South-East'": [] }
                    ]
                  },
                  {
                    "caseelse_clause": [
                      { "ELSE": [] },
                      { "NULL": [{ "NOT_NULL": [] }] }
                    ]
                  },
                  { "END_IF": [] }
                ]
              },
              "columns": [
                {
                  "node": [
                    { "identifier:c.region": [{ ".": [] }] },
                    { "identifier:c.region": [{ ".": [] }] }
                  ],
                  "dataset": "None",
                  "table": "countries",
                  "column": "region"
                }
              ],
              "alias": "region_cluster"
            },
            {
              "node": {
                "identifier:accounts.priority": [{ ".": [] }]
              },
              "columns": [
                {
                  "node": [{ "identifier:accounts.priority": [{ ".": [] }] }],
                  "dataset": "None",
                  "table": "accounts",
                  "column": "priority"
                }
              ],
              "alias": "None"
            },
            {
              "node": {
                "function_call": [
                  { "identifier:SUM": [] },
                  { "(": [] },
                  { "argument": [{ "identifier:revenue": [] }] },
                  { ")": [] },
                  {
                    "analytics_clause": [
                      { "OVER": [] },
                      {
                        "over_clause": [
                          {
                            "window_specification": [
                              { "(": [] },
                              {
                                "window_partition_clause": [
                                  { "PARTITION_COLUMNS": [] },
                                  { "GROUP_BY": [] },
                                  {
                                    "_expression": [
                                      { "identifier:account_id": [] }
                                    ]
                                  }
                                ]
                              },
                              {
                                "order_by_clause": [
                                  { "ORDER_BY": [] },
                                  { "GROUP_BY": [] },
                                  {
                                    "order_by_clause_body": [
                                      { "identifier:date_month": [] }
                                    ]
                                  }
                                ]
                              },
                              {
                                "window_frame_clause": [
                                  { "rows_range": [{ "ROWS": [] }] },
                                  {
                                    "window_frame_between": [
                                      { "BETWEEN": [] },
                                      {
                                        "window_numeric_preceding": [
                                          { "number:11": [] },
                                          { "PRECEDING": [] }
                                        ]
                                      },
                                      { "AND": [] },
                                      {
                                        "between_to": [
                                          {
                                            "keyword_current_row": [
                                              { "CURRENT_ROW": [] },
                                              { "ROW": [] }
                                            ]
                                          }
                                        ]
                                      }
                                    ]
                                  }
                                ]
                              },
                              { ")": [] }
                            ]
                          }
                        ]
                      }
                    ]
                  }
                ]
              },
              "columns": [
                {
                  "node": [
                    { "identifier:revenue": [] },
                    { "identifier:revenue": [] }
                  ],
                  "dataset": "None",
                  "table": "accounts",
                  "column": "revenue"
                },
                {
                  "node": [
                    { "identifier:account_id": [] },
                    { "identifier:account_id": [] },
                    { "identifier:account_id": [] }
                  ],
                  "dataset": "None",
                  "table": "accounts",
                  "column": "account_id"
                },
                {
                  "node": [
                    { "identifier:date_month": [] },
                    { "identifier:date_month": [] }
                  ],
                  "dataset": "None",
                  "table": "accounts",
                  "column": "date_month"
                }
              ],
              "alias": "revenue_12m"
            },
            {
              "node": { "identifier:date_month": [] },
              "columns": [
                {
                  "node": [
                    { "identifier:date_month": [] },
                    { "identifier:date_month": [] }
                  ],
                  "dataset": "None",
                  "table": "accounts",
                  "column": "date_month"
                }
              ],
              "alias": "None"
            },
            {
              "node": { "identifier:account_id": [] },
              "columns": [
                {
                  "node": [
                    { "identifier:account_id": [] },
                    { "identifier:account_id": [] },
                    { "identifier:account_id": [] }
                  ],
                  "dataset": "None",
                  "table": "accounts",
                  "column": "account_id"
                }
              ],
              "alias": "None"
            },
            {
              "node": { "identifier:country": [] },
              "columns": [
                {
                  "node": [
                    { "identifier:accounts.country": [{ ".": [] }] },
                    { "identifier:country": [] }
                  ],
                  "dataset": "None",
                  "table": "accounts",
                  "column": "country"
                }
              ],
              "alias": "None"
            }
          ],
          "alias": "None"
        }
      ],
      "ops": [
        {
          "node": {
            "casewhen_expression": [
              { "CASE": [] },
              {
                "casewhen_clause": [
                  { "WHEN_MATCHED": [] },
                  {
                    "binary_expression": [
                      { "identifier:t.revenue_12m": [{ ".": [] }] },
                      { "<=": [] },
                      { "number:300": [] }
                    ]
                  },
                  { "THEN": [] },
                  { "string:'Small'": [] }
                ]
              },
              {
                "casewhen_clause": [
                  { "WHEN_MATCHED": [] },
                  {
                    "binary_expression": [
                      {
                        "binary_expression": [
                          { "identifier:t.revenue_12m": [{ ".": [] }] },
                          { ">": [] },
                          { "number:300": [] }
                        ]
                      },
                      { "AND": [] },
                      {
                        "binary_expression": [
                          { "identifier:t.revenue_12m": [{ ".": [] }] },
                          { "<=": [] },
                          { "number:600": [] }
                        ]
                      }
                    ]
                  },
                  { "THEN": [] },
                  { "string:'Medium'": [] }
                ]
              },
              {
                "casewhen_clause": [
                  { "WHEN_MATCHED": [] },
                  {
                    "binary_expression": [
                      { "identifier:t.revenue_12m": [{ ".": [] }] },
                      { ">": [] },
                      { "number:600": [] }
                    ]
                  },
                  { "THEN": [] },
                  { "string:'Large'": [] }
                ]
              },
              {
                "caseelse_clause": [
                  { "ELSE": [] },
                  { "NULL": [{ "NOT_NULL": [] }] }
                ]
              },
              { "END_IF": [] }
            ]
          },
          "columns": [
            {
              "node": [
                { "identifier:t.revenue_12m": [{ ".": [] }] },
                { "identifier:t.revenue_12m": [{ ".": [] }] },
                { "identifier:t.revenue_12m": [{ ".": [] }] },
                { "identifier:t.revenue_12m": [{ ".": [] }] }
              ],
              "dataset": "None",
              "table": "t",
              "column": "revenue_12m"
            }
          ],
          "alias": "account_size"
        }
      ],
      "alias": "None"
    },
    {
      "node": {
        "query_expr": [
          {
            "select": [
              { "SELECT": [] },
              {
                "select_list": [
                  {
                    "_aliasable_expression": [
                      {
                        "function_call": [
                          { "identifier:date": [{ "DATE": [] }] },
                          { "(": [] },
                          { "argument": [{ "identifier:date_month": [] }] },
                          { ",": [] },
                          { "argument": [{ "string:'start of year'": [] }] },
                          { ")": [] }
                        ]
                      },
                      {
                        "as_alias": [
                          { "AS": [] },
                          { "identifier:date_year": [] }
                        ]
                      }
                    ]
                  },
                  { ",": [] },
                  {
                    "_aliasable_expression": [
                      {
                        "casewhen_expression": [
                          { "CASE": [] },
                          {
                            "casewhen_clause": [
                              { "WHEN_MATCHED": [] },
                              {
                                "binary_expression": [
                                  { "identifier:c.region": [{ ".": [] }] },
                                  { "IN": [] },
                                  {
                                    "struct": [
                                      { "(": [] },
                                      { "string:'Americas'": [] },
                                      { ",": [] },
                                      { "string:'Europe'": [] },
                                      { ")": [] }
                                    ]
                                  }
                                ]
                              },
                              { "THEN": [] },
                              { "string:'North-West'": [] }
                            ]
                          },
                          {
                            "casewhen_clause": [
                              { "WHEN_MATCHED": [] },
                              {
                                "binary_expression": [
                                  { "identifier:c.region": [{ ".": [] }] },
                                  { "IN": [] },
                                  {
                                    "struct": [
                                      { "(": [] },
                                      { "string:'Africa'": [] },
                                      { ",": [] },
                                      { "string:'Asia'": [] },
                                      { ")": [] }
                                    ]
                                  }
                                ]
                              },
                              { "THEN": [] },
                              { "string:'South-East'": [] }
                            ]
                          },
                          {
                            "caseelse_clause": [
                              { "ELSE": [] },
                              { "NULL": [{ "NOT_NULL": [] }] }
                            ]
                          },
                          { "END_IF": [] }
                        ]
                      },
                      {
                        "as_alias": [
                          { "AS": [] },
                          { "identifier:region_cluster": [] }
                        ]
                      }
                    ]
                  },
                  { ",": [] },
                  {
                    "_aliasable_expression": [
                      {
                        "casewhen_expression": [
                          { "CASE": [] },
                          {
                            "casewhen_clause": [
                              { "WHEN_MATCHED": [] },
                              {
                                "binary_expression": [
                                  { "identifier:a.industry": [{ ".": [] }] },
                                  { "=": [] },
                                  { "string:'Information Technology'": [] }
                                ]
                              },
                              { "THEN": [] },
                              { "string:'Tech'": [] }
                            ]
                          },
                          {
                            "casewhen_clause": [
                              { "WHEN_MATCHED": [] },
                              {
                                "unary_expression": [
                                  { "identifier:a.industry": [{ ".": [] }] },
                                  { "IS": [] },
                                  { "NULL": [{ "NOT_NULL": [] }] }
                                ]
                              },
                              { "THEN": [] },
                              { "NULL": [{ "NOT_NULL": [] }] }
                            ]
                          },
                          {
                            "caseelse_clause": [
                              { "ELSE": [] },
                              { "string:'Other'": [] }
                            ]
                          },
                          { "END_IF": [] }
                        ]
                      },
                      {
                        "as_alias": [
                          { "AS": [] },
                          { "identifier:industry_cluster": [] }
                        ]
                      }
                    ]
                  },
                  { ",": [] },
                  {
                    "_aliasable_expression": [
                      { "identifier:a360.account_size": [{ ".": [] }] }
                    ]
                  },
                  { ",": [] },
                  {
                    "_aliasable_expression": [
                      {
                        "function_call": [
                          { "identifier:SUM": [] },
                          { "(": [] },
                          {
                            "argument": [
                              { "identifier:ar.revenue": [{ ".": [] }] }
                            ]
                          },
                          { ")": [] }
                        ]
                      },
                      {
                        "as_alias": [{ "AS": [] }, { "identifier:revenue": [] }]
                      }
                    ]
                  },
                  { ",": [] },
                  {
                    "_aliasable_expression": [
                      {
                        "function_call": [
                          { "identifier:COUNT": [] },
                          { "(": [] },
                          { "_keyword_distinct": [{ "DISTINCT_FROM": [] }] },
                          {
                            "argument": [
                              { "identifier:ar.account_id": [{ ".": [] }] }
                            ]
                          },
                          { ")": [] }
                        ]
                      },
                      {
                        "as_alias": [
                          { "AS": [] },
                          { "identifier:accounts": [] }
                        ]
                      }
                    ]
                  },
                  { ",": [] },
                  {
                    "_aliasable_expression": [
                      {
                        "binary_expression": [
                          {
                            "function_call": [
                              { "identifier:SUM": [] },
                              { "(": [] },
                              {
                                "argument": [
                                  { "identifier:ar.revenue": [{ ".": [] }] }
                                ]
                              },
                              { ")": [] }
                            ]
                          },
                          { "/": [] },
                          {
                            "function_call": [
                              { "identifier:COUNT": [] },
                              { "(": [] },
                              {
                                "_keyword_distinct": [{ "DISTINCT_FROM": [] }]
                              },
                              {
                                "argument": [
                                  { "identifier:ar.account_id": [{ ".": [] }] }
                                ]
                              },
                              { ")": [] }
                            ]
                          }
                        ]
                      },
                      {
                        "as_alias": [
                          { "AS": [] },
                          { "identifier:revenue_per_account": [] }
                        ]
                      }
                    ]
                  }
                ]
              },
              {
                "from_clause": [
                  { "FROM": [] },
                  {
                    "from_item": [
                      {
                        "join_operation": [
                          {
                            "from_item": [
                              {
                                "join_operation": [
                                  {
                                    "from_item": [
                                      {
                                        "join_operation": [
                                          {
                                            "from_item": [
                                              {
                                                "identifier:accounts_revenue": []
                                              },
                                              {
                                                "as_alias": [
                                                  { "identifier:ar": [] }
                                                ]
                                              }
                                            ]
                                          },
                                          { "join_type": [{ "LEFT": [] }] },
                                          { "JOIN": [] },
                                          {
                                            "from_item": [
                                              { "identifier:accounts": [] },
                                              {
                                                "as_alias": [
                                                  { "identifier:a": [] }
                                                ]
                                              }
                                            ]
                                          },
                                          {
                                            "join_condition": [
                                              { "USING": [] },
                                              { "(": [] },
                                              { "identifier:account_id": [] },
                                              { ")": [] }
                                            ]
                                          }
                                        ]
                                      }
                                    ]
                                  },
                                  { "join_type": [{ "LEFT": [] }] },
                                  { "JOIN": [] },
                                  {
                                    "from_item": [
                                      { "identifier:countries": [] },
                                      { "as_alias": [{ "identifier:c": [] }] }
                                    ]
                                  },
                                  {
                                    "join_condition": [
                                      { "USING": [] },
                                      { "(": [] },
                                      { "identifier:country": [] },
                                      { ")": [] }
                                    ]
                                  }
                                ]
                              }
                            ]
                          },
                          { "join_type": [{ "LEFT": [] }] },
                          { "JOIN": [] },
                          {
                            "from_item": [
                              { "identifier:accounts_360": [] },
                              { "as_alias": [{ "identifier:a360": [] }] }
                            ]
                          },
                          {
                            "join_condition": [
                              { "USING": [] },
                              { "(": [] },
                              { "identifier:account_id": [] },
                              { ",": [] },
                              { "identifier:date_month": [] },
                              { ")": [] }
                            ]
                          }
                        ]
                      }
                    ]
                  }
                ]
              },
              {
                "group_by_clause": [
                  { "GROUP_BY": [] },
                  { "GROUP_BY": [] },
                  { "grouping_item": [{ "identifier:date_year": [] }] },
                  { ",": [] },
                  { "grouping_item": [{ "identifier:region_cluster": [] }] },
                  { ",": [] },
                  { "grouping_item": [{ "identifier:industry_cluster": [] }] },
                  { ",": [] },
                  {
                    "grouping_item": [
                      { "identifier:a360.account_size": [{ ".": [] }] }
                    ]
                  }
                ]
              }
            ]
          },
          {
            "order_by_clause": [
              { "ORDER_BY": [] },
              { "GROUP_BY": [] },
              {
                "order_by_clause_body": [
                  { "identifier:date_year": [] },
                  { ",": [] },
                  { "identifier:region_cluster": [] },
                  { ",": [] },
                  { "identifier:industry_cluster": [] }
                ]
              }
            ]
          }
        ]
      },
      "sources": [
        {
          "node": { "identifier:accounts_revenue": [] },
          "dataset": "None",
          "table": "accounts_revenue",
          "alias": "ar"
        },
        {
          "node": { "identifier:accounts": [] },
          "dataset": "None",
          "table": "accounts",
          "alias": "a"
        },
        {
          "node": { "identifier:countries": [] },
          "dataset": "None",
          "table": "countries",
          "alias": "c"
        },
        {
          "node": { "identifier:accounts_360": [] },
          "dataset": "None",
          "table": "accounts_360",
          "alias": "a360"
        }
      ],
      "ops": [
        {
          "node": {
            "function_call": [
              { "identifier:date": [{ "DATE": [] }] },
              { "(": [] },
              { "argument": [{ "identifier:date_month": [] }] },
              { ",": [] },
              { "argument": [{ "string:'start of year'": [] }] },
              { ")": [] }
            ]
          },
          "columns": [
            {
              "node": [
                { "identifier:date_month": [] },
                { "identifier:date_month": [] }
              ],
              "dataset": "None",
              "table": "None",
              "column": "date_month"
            }
          ],
          "alias": "date_year"
        },
        {
          "node": {
            "casewhen_expression": [
              { "CASE": [] },
              {
                "casewhen_clause": [
                  { "WHEN_MATCHED": [] },
                  {
                    "binary_expression": [
                      { "identifier:c.region": [{ ".": [] }] },
                      { "IN": [] },
                      {
                        "struct": [
                          { "(": [] },
                          { "string:'Americas'": [] },
                          { ",": [] },
                          { "string:'Europe'": [] },
                          { ")": [] }
                        ]
                      }
                    ]
                  },
                  { "THEN": [] },
                  { "string:'North-West'": [] }
                ]
              },
              {
                "casewhen_clause": [
                  { "WHEN_MATCHED": [] },
                  {
                    "binary_expression": [
                      { "identifier:c.region": [{ ".": [] }] },
                      { "IN": [] },
                      {
                        "struct": [
                          { "(": [] },
                          { "string:'Africa'": [] },
                          { ",": [] },
                          { "string:'Asia'": [] },
                          { ")": [] }
                        ]
                      }
                    ]
                  },
                  { "THEN": [] },
                  { "string:'South-East'": [] }
                ]
              },
              {
                "caseelse_clause": [
                  { "ELSE": [] },
                  { "NULL": [{ "NOT_NULL": [] }] }
                ]
              },
              { "END_IF": [] }
            ]
          },
          "columns": [
            {
              "node": [
                { "identifier:c.region": [{ ".": [] }] },
                { "identifier:c.region": [{ ".": [] }] }
              ],
              "dataset": "None",
              "table": "countries",
              "column": "region"
            }
          ],
          "alias": "region_cluster"
        },
        {
          "node": {
            "casewhen_expression": [
              { "CASE": [] },
              {
                "casewhen_clause": [
                  { "WHEN_MATCHED": [] },
                  {
                    "binary_expression": [
                      { "identifier:a.industry": [{ ".": [] }] },
                      { "=": [] },
                      { "string:'Information Technology'": [] }
                    ]
                  },
                  { "THEN": [] },
                  { "string:'Tech'": [] }
                ]
              },
              {
                "casewhen_clause": [
                  { "WHEN_MATCHED": [] },
                  {
                    "unary_expression": [
                      { "identifier:a.industry": [{ ".": [] }] },
                      { "IS": [] },
                      { "NULL": [{ "NOT_NULL": [] }] }
                    ]
                  },
                  { "THEN": [] },
                  { "NULL": [{ "NOT_NULL": [] }] }
                ]
              },
              { "caseelse_clause": [{ "ELSE": [] }, { "string:'Other'": [] }] },
              { "END_IF": [] }
            ]
          },
          "columns": [
            {
              "node": [
                { "identifier:a.industry": [{ ".": [] }] },
                { "identifier:a.industry": [{ ".": [] }] }
              ],
              "dataset": "None",
              "table": "accounts",
              "column": "industry"
            }
          ],
          "alias": "industry_cluster"
        },
        {
          "node": {
            "identifier:a360.account_size": [{ ".": [] }]
          },
          "columns": [
            {
              "node": [
                { "identifier:a360.account_size": [{ ".": [] }] },
                { "identifier:a360.account_size": [{ ".": [] }] }
              ],
              "dataset": "None",
              "table": "accounts_360",
              "column": "account_size"
            }
          ],
          "alias": "None"
        },
        {
          "node": {
            "function_call": [
              { "identifier:SUM": [] },
              { "(": [] },
              { "argument": [{ "identifier:ar.revenue": [{ ".": [] }] }] },
              { ")": [] }
            ]
          },
          "columns": [
            {
              "node": [
                { "identifier:ar.revenue": [{ ".": [] }] },
                { "identifier:ar.revenue": [{ ".": [] }] }
              ],
              "dataset": "None",
              "table": "accounts_revenue",
              "column": "revenue"
            }
          ],
          "alias": "revenue"
        },
        {
          "node": {
            "function_call": [
              { "identifier:COUNT": [] },
              { "(": [] },
              { "_keyword_distinct": [{ "DISTINCT_FROM": [] }] },
              { "argument": [{ "identifier:ar.account_id": [{ ".": [] }] }] },
              { ")": [] }
            ]
          },
          "columns": [
            {
              "node": [
                { "identifier:ar.account_id": [{ ".": [] }] },
                { "identifier:ar.account_id": [{ ".": [] }] }
              ],
              "dataset": "None",
              "table": "accounts_revenue",
              "column": "account_id"
            }
          ],
          "alias": "accounts"
        },
        {
          "node": {
            "binary_expression": [
              {
                "function_call": [
                  { "identifier:SUM": [] },
                  { "(": [] },
                  { "argument": [{ "identifier:ar.revenue": [{ ".": [] }] }] },
                  { ")": [] }
                ]
              },
              { "/": [] },
              {
                "function_call": [
                  { "identifier:COUNT": [] },
                  { "(": [] },
                  { "_keyword_distinct": [{ "DISTINCT_FROM": [] }] },
                  {
                    "argument": [{ "identifier:ar.account_id": [{ ".": [] }] }]
                  },
                  { ")": [] }
                ]
              }
            ]
          },
          "columns": [
            {
              "node": [
                { "identifier:ar.revenue": [{ ".": [] }] },
                { "identifier:ar.revenue": [{ ".": [] }] }
              ],
              "dataset": "None",
              "table": "accounts_revenue",
              "column": "revenue"
            },
            {
              "node": [
                { "identifier:ar.account_id": [{ ".": [] }] },
                { "identifier:ar.account_id": [{ ".": [] }] }
              ],
              "dataset": "None",
              "table": "accounts_revenue",
              "column": "account_id"
            }
          ],
          "alias": "revenue_per_account"
        },
        {
          "node": { "identifier:account_id": [] },
          "columns": [
            {
              "node": [
                { "identifier:account_id": [] },
                { "identifier:account_id": [] }
              ],
              "dataset": "None",
              "table": "None",
              "column": "account_id"
            }
          ],
          "alias": "None"
        },
        {
          "node": { "identifier:country": [] },
          "columns": [
            {
              "node": [{ "identifier:country": [] }],
              "dataset": "None",
              "table": "None",
              "column": "country"
            }
          ],
          "alias": "None"
        },
        {
          "node": { "identifier:account_id": [] },
          "columns": [
            {
              "node": [
                { "identifier:account_id": [] },
                { "identifier:account_id": [] }
              ],
              "dataset": "None",
              "table": "None",
              "column": "account_id"
            },
            {
              "node": [
                { "identifier:date_month": [] },
                { "identifier:date_month": [] }
              ],
              "dataset": "None",
              "table": "None",
              "column": "date_month"
            }
          ],
          "alias": "None"
        },
        {
          "node": { "identifier:date_month": [] },
          "columns": [
            {
              "node": [
                { "identifier:account_id": [] },
                { "identifier:account_id": [] }
              ],
              "dataset": "None",
              "table": "None",
              "column": "account_id"
            },
            {
              "node": [
                { "identifier:date_month": [] },
                { "identifier:date_month": [] }
              ],
              "dataset": "None",
              "table": "None",
              "column": "date_month"
            }
          ],
          "alias": "None"
        },
        {
          "node": { "identifier:date_year": [] },
          "columns": [
            {
              "node": [
                { "identifier:date_year": [] },
                { "identifier:date_year": [] }
              ],
              "dataset": "None",
              "table": "None",
              "column": "date_year"
            }
          ],
          "alias": "None"
        },
        {
          "node": { "identifier:region_cluster": [] },
          "columns": [
            {
              "node": [
                { "identifier:region_cluster": [] },
                { "identifier:region_cluster": [] }
              ],
              "dataset": "None",
              "table": "None",
              "column": "region_cluster"
            }
          ],
          "alias": "None"
        },
        {
          "node": { "identifier:industry_cluster": [] },
          "columns": [
            {
              "node": [
                { "identifier:industry_cluster": [] },
                { "identifier:industry_cluster": [] }
              ],
              "dataset": "None",
              "table": "None",
              "column": "industry_cluster"
            }
          ],
          "alias": "None"
        },
        {
          "node": {
            "identifier:a360.account_size": [{ ".": [] }]
          },
          "columns": [
            {
              "node": [
                { "identifier:a360.account_size": [{ ".": [] }] },
                { "identifier:a360.account_size": [{ ".": [] }] }
              ],
              "dataset": "None",
              "table": "accounts_360",
              "column": "account_size"
            }
          ],
          "alias": "None"
        },
        {
          "node": { "identifier:date_year": [] },
          "columns": [
            {
              "node": [
                { "identifier:date_year": [] },
                { "identifier:date_year": [] }
              ],
              "dataset": "None",
              "table": "None",
              "column": "date_year"
            },
            {
              "node": [
                { "identifier:region_cluster": [] },
                { "identifier:region_cluster": [] }
              ],
              "dataset": "None",
              "table": "None",
              "column": "region_cluster"
            },
            {
              "node": [
                { "identifier:industry_cluster": [] },
                { "identifier:industry_cluster": [] }
              ],
              "dataset": "None",
              "table": "None",
              "column": "industry_cluster"
            }
          ],
          "alias": "None"
        },
        {
          "node": { "identifier:region_cluster": [] },
          "columns": [
            {
              "node": [
                { "identifier:date_year": [] },
                { "identifier:date_year": [] }
              ],
              "dataset": "None",
              "table": "None",
              "column": "date_year"
            },
            {
              "node": [
                { "identifier:region_cluster": [] },
                { "identifier:region_cluster": [] }
              ],
              "dataset": "None",
              "table": "None",
              "column": "region_cluster"
            },
            {
              "node": [
                { "identifier:industry_cluster": [] },
                { "identifier:industry_cluster": [] }
              ],
              "dataset": "None",
              "table": "None",
              "column": "industry_cluster"
            }
          ],
          "alias": "None"
        },
        {
          "node": { "identifier:industry_cluster": [] },
          "columns": [
            {
              "node": [
                { "identifier:date_year": [] },
                { "identifier:date_year": [] }
              ],
              "dataset": "None",
              "table": "None",
              "column": "date_year"
            },
            {
              "node": [
                { "identifier:region_cluster": [] },
                { "identifier:region_cluster": [] }
              ],
              "dataset": "None",
              "table": "None",
              "column": "region_cluster"
            },
            {
              "node": [
                { "identifier:industry_cluster": [] },
                { "identifier:industry_cluster": [] }
              ],
              "dataset": "None",
              "table": "None",
              "column": "industry_cluster"
            }
          ],
          "alias": "None"
        }
      ],
      "alias": "None"
    },
    {
      "node": {
        "query_expr": [
          {
            "select": [
              { "SELECT": [] },
              {
                "select_list": [
                  {
                    "_aliasable_expression": [
                      { "identifier:accounts.name": [{ ".": [] }] }
                    ]
                  },
                  { ",": [] },
                  { "_aliasable_expression": [{ "identifier:region": [] }] },
                  { ",": [] },
                  {
                    "_aliasable_expression": [
                      {
                        "casewhen_expression": [
                          { "CASE": [] },
                          {
                            "casewhen_clause": [
                              { "WHEN_MATCHED": [] },
                              {
                                "binary_expression": [
                                  { "identifier:c.region": [{ ".": [] }] },
                                  { "IN": [] },
                                  {
                                    "struct": [
                                      { "(": [] },
                                      { "string:'Americas'": [] },
                                      { ",": [] },
                                      { "string:'Europe'": [] },
                                      { ")": [] }
                                    ]
                                  }
                                ]
                              },
                              { "THEN": [] },
                              { "string:'North-West'": [] }
                            ]
                          },
                          {
                            "casewhen_clause": [
                              { "WHEN_MATCHED": [] },
                              {
                                "binary_expression": [
                                  { "identifier:c.region": [{ ".": [] }] },
                                  { "IN": [] },
                                  {
                                    "struct": [
                                      { "(": [] },
                                      { "string:'Africa'": [] },
                                      { ",": [] },
                                      { "string:'Asia'": [] },
                                      { ")": [] }
                                    ]
                                  }
                                ]
                              },
                              { "THEN": [] },
                              { "string:'South-East'": [] }
                            ]
                          },
                          {
                            "caseelse_clause": [
                              { "ELSE": [] },
                              { "NULL": [{ "NOT_NULL": [] }] }
                            ]
                          },
                          { "END_IF": [] }
                        ]
                      },
                      {
                        "as_alias": [{ "AS": [] }, { "identifier:cluster": [] }]
                      }
                    ]
                  },
                  { ",": [] },
                  {
                    "_aliasable_expression": [
                      { "identifier:accounts.industry": [{ ".": [] }] },
                      {
                        "as_alias": [
                          { "AS": [] },
                          { "identifier:industry": [] }
                        ]
                      }
                    ]
                  },
                  { ",": [] },
                  {
                    "_aliasable_expression": [
                      {
                        "function_call": [
                          { "identifier:IIF": [] },
                          { "(": [] },
                          {
                            "argument": [
                              {
                                "binary_expression": [
                                  {
                                    "identifier:accounts.industry": [
                                      { ".": [] }
                                    ]
                                  },
                                  { "=": [] },
                                  { "string:'Information Technology'": [] }
                                ]
                              }
                            ]
                          },
                          { ",": [] },
                          { "argument": [{ "string:'Tech'": [] }] },
                          { ",": [] },
                          { "argument": [{ "string:'Other'": [] }] },
                          { ")": [] }
                        ]
                      },
                      {
                        "as_alias": [
                          { "AS": [] },
                          { "identifier:industry_tech": [] }
                        ]
                      }
                    ]
                  },
                  { ",": [] },
                  {
                    "_aliasable_expression": [
                      {
                        "casewhen_expression": [
                          { "CASE": [] },
                          {
                            "casewhen_clause": [
                              { "WHEN_MATCHED": [] },
                              {
                                "binary_expression": [
                                  {
                                    "function_call": [
                                      { "identifier:SUM": [] },
                                      { "(": [] },
                                      {
                                        "argument": [
                                          {
                                            "identifier:accounts_revenue.revenue": [
                                              { ".": [] }
                                            ]
                                          }
                                        ]
                                      },
                                      { ")": [] }
                                    ]
                                  },
                                  { "<=": [] },
                                  { "number:300": [] }
                                ]
                              },
                              { "THEN": [] },
                              { "string:'Small'": [] }
                            ]
                          },
                          {
                            "casewhen_clause": [
                              { "WHEN_MATCHED": [] },
                              {
                                "binary_expression": [
                                  {
                                    "binary_expression": [
                                      {
                                        "function_call": [
                                          { "identifier:SUM": [] },
                                          { "(": [] },
                                          {
                                            "argument": [
                                              {
                                                "identifier:accounts_revenue.revenue": [
                                                  { ".": [] }
                                                ]
                                              }
                                            ]
                                          },
                                          { ")": [] }
                                        ]
                                      },
                                      { ">": [] },
                                      { "number:300": [] }
                                    ]
                                  },
                                  { "AND": [] },
                                  {
                                    "binary_expression": [
                                      {
                                        "function_call": [
                                          { "identifier:SUM": [] },
                                          { "(": [] },
                                          {
                                            "argument": [
                                              {
                                                "identifier:accounts_revenue.revenue": [
                                                  { ".": [] }
                                                ]
                                              }
                                            ]
                                          },
                                          { ")": [] }
                                        ]
                                      },
                                      { "<=": [] },
                                      { "number:600": [] }
                                    ]
                                  }
                                ]
                              },
                              { "THEN": [] },
                              { "string:'Medium'": [] }
                            ]
                          },
                          {
                            "casewhen_clause": [
                              { "WHEN_MATCHED": [] },
                              {
                                "binary_expression": [
                                  {
                                    "function_call": [
                                      { "identifier:SUM": [] },
                                      { "(": [] },
                                      {
                                        "argument": [
                                          {
                                            "identifier:accounts_revenue.revenue": [
                                              { ".": [] }
                                            ]
                                          }
                                        ]
                                      },
                                      { ")": [] }
                                    ]
                                  },
                                  { ">": [] },
                                  { "number:600": [] }
                                ]
                              },
                              { "THEN": [] },
                              { "string:'Large'": [] }
                            ]
                          },
                          {
                            "caseelse_clause": [
                              { "ELSE": [] },
                              { "NULL": [{ "NOT_NULL": [] }] }
                            ]
                          },
                          { "END_IF": [] }
                        ]
                      },
                      {
                        "as_alias": [
                          { "AS": [] },
                          { "identifier:account_size": [] }
                        ]
                      }
                    ]
                  },
                  { ",": [] },
                  {
                    "_aliasable_expression": [
                      {
                        "function_call": [
                          { "identifier:SUM": [] },
                          { "(": [] },
                          {
                            "argument": [
                              {
                                "identifier:accounts_revenue.revenue": [
                                  { ".": [] }
                                ]
                              }
                            ]
                          },
                          { ")": [] }
                        ]
                      },
                      {
                        "as_alias": [
                          { "AS": [] },
                          { "identifier:revenue_12m": [] }
                        ]
                      }
                    ]
                  }
                ]
              },
              {
                "from_clause": [
                  { "FROM": [] },
                  {
                    "from_item": [
                      {
                        "join_operation": [
                          {
                            "from_item": [
                              {
                                "join_operation": [
                                  {
                                    "from_item": [{ "identifier:accounts": [] }]
                                  },
                                  { "join_type": [{ "LEFT": [] }] },
                                  { "JOIN": [] },
                                  {
                                    "from_item": [
                                      { "identifier:accounts_revenue": [] }
                                    ]
                                  },
                                  {
                                    "join_condition": [
                                      { "USING": [] },
                                      { "(": [] },
                                      { "identifier:account_id": [] },
                                      { ")": [] }
                                    ]
                                  }
                                ]
                              }
                            ]
                          },
                          { "join_type": [{ "LEFT": [] }] },
                          { "JOIN": [] },
                          {
                            "from_item": [
                              { "identifier:countries": [] },
                              { "as_alias": [{ "identifier:c": [] }] }
                            ]
                          },
                          {
                            "join_condition": [
                              { "USING": [] },
                              { "(": [] },
                              { "identifier:country": [] },
                              { ")": [] }
                            ]
                          }
                        ]
                      }
                    ]
                  }
                ]
              },
              {
                "where_clause": [
                  { "WHERE": [] },
                  {
                    "between_operator": [
                      {
                        "identifier:accounts_revenue.date_month": [{ ".": [] }]
                      },
                      { "BETWEEN": [] },
                      {
                        "_expression": [
                          {
                            "function_call": [
                              { "identifier:DATE": [{ "DATE": [] }] },
                              { "(": [] },
                              { "argument": [{ "string:'now'": [] }] },
                              { ",": [] },
                              { "argument": [{ "string:'-12 months'": [] }] },
                              { ")": [] }
                            ]
                          }
                        ]
                      },
                      { "AND": [] },
                      {
                        "_expression": [
                          {
                            "function_call": [
                              { "identifier:DATE": [{ "DATE": [] }] },
                              { "(": [] },
                              { "argument": [{ "string:'now'": [] }] },
                              { ")": [] }
                            ]
                          }
                        ]
                      }
                    ]
                  }
                ]
              },
              {
                "group_by_clause": [
                  { "GROUP_BY": [] },
                  { "GROUP_BY": [] },
                  {
                    "grouping_item": [
                      { "identifier:accounts.name": [{ ".": [] }] }
                    ]
                  },
                  { ",": [] },
                  { "grouping_item": [{ "identifier:region": [] }] },
                  { ",": [] },
                  {
                    "grouping_item": [
                      { "identifier:accounts.industry": [{ ".": [] }] }
                    ]
                  }
                ]
              }
            ]
          }
        ]
      },
      "sources": [
        {
          "node": { "identifier:accounts": [] },
          "dataset": "None",
          "table": "accounts",
          "alias": "None"
        },
        {
          "node": { "identifier:accounts_revenue": [] },
          "dataset": "None",
          "table": "accounts_revenue",
          "alias": "None"
        },
        {
          "node": { "identifier:countries": [] },
          "dataset": "None",
          "table": "countries",
          "alias": "c"
        }
      ],
      "ops": [
        {
          "node": {
            "identifier:accounts.name": [{ ".": [] }]
          },
          "columns": [
            {
              "node": [
                { "identifier:accounts.name": [{ ".": [] }] },
                { "identifier:accounts.name": [{ ".": [] }] }
              ],
              "dataset": "None",
              "table": "accounts",
              "column": "name"
            }
          ],
          "alias": "None"
        },
        {
          "node": { "identifier:region": [] },
          "columns": [
            {
              "node": [
                { "identifier:region": [] },
                { "identifier:region": [] }
              ],
              "dataset": "None",
              "table": "accounts_revenue",
              "column": "region"
            }
          ],
          "alias": "None"
        },
        {
          "node": {
            "casewhen_expression": [
              { "CASE": [] },
              {
                "casewhen_clause": [
                  { "WHEN_MATCHED": [] },
                  {
                    "binary_expression": [
                      { "identifier:c.region": [{ ".": [] }] },
                      { "IN": [] },
                      {
                        "struct": [
                          { "(": [] },
                          { "string:'Americas'": [] },
                          { ",": [] },
                          { "string:'Europe'": [] },
                          { ")": [] }
                        ]
                      }
                    ]
                  },
                  { "THEN": [] },
                  { "string:'North-West'": [] }
                ]
              },
              {
                "casewhen_clause": [
                  { "WHEN_MATCHED": [] },
                  {
                    "binary_expression": [
                      { "identifier:c.region": [{ ".": [] }] },
                      { "IN": [] },
                      {
                        "struct": [
                          { "(": [] },
                          { "string:'Africa'": [] },
                          { ",": [] },
                          { "string:'Asia'": [] },
                          { ")": [] }
                        ]
                      }
                    ]
                  },
                  { "THEN": [] },
                  { "string:'South-East'": [] }
                ]
              },
              {
                "caseelse_clause": [
                  { "ELSE": [] },
                  { "NULL": [{ "NOT_NULL": [] }] }
                ]
              },
              { "END_IF": [] }
            ]
          },
          "columns": [
            {
              "node": [
                { "identifier:c.region": [{ ".": [] }] },
                { "identifier:c.region": [{ ".": [] }] }
              ],
              "dataset": "None",
              "table": "countries",
              "column": "region"
            }
          ],
          "alias": "cluster"
        },
        {
          "node": {
            "identifier:accounts.industry": [{ ".": [] }]
          },
          "columns": [
            {
              "node": [
                { "identifier:accounts.industry": [{ ".": [] }] },
                { "identifier:accounts.industry": [{ ".": [] }] },
                { "identifier:accounts.industry": [{ ".": [] }] }
              ],
              "dataset": "None",
              "table": "accounts",
              "column": "industry"
            }
          ],
          "alias": "industry"
        },
        {
          "node": {
            "function_call": [
              { "identifier:IIF": [] },
              { "(": [] },
              {
                "argument": [
                  {
                    "binary_expression": [
                      { "identifier:accounts.industry": [{ ".": [] }] },
                      { "=": [] },
                      { "string:'Information Technology'": [] }
                    ]
                  }
                ]
              },
              { ",": [] },
              { "argument": [{ "string:'Tech'": [] }] },
              { ",": [] },
              { "argument": [{ "string:'Other'": [] }] },
              { ")": [] }
            ]
          },
          "columns": [
            {
              "node": [
                { "identifier:accounts.industry": [{ ".": [] }] },
                { "identifier:accounts.industry": [{ ".": [] }] },
                { "identifier:accounts.industry": [{ ".": [] }] }
              ],
              "dataset": "None",
              "table": "accounts",
              "column": "industry"
            }
          ],
          "alias": "industry_tech"
        },
        {
          "node": {
            "casewhen_expression": [
              { "CASE": [] },
              {
                "casewhen_clause": [
                  { "WHEN_MATCHED": [] },
                  {
                    "binary_expression": [
                      {
                        "function_call": [
                          { "identifier:SUM": [] },
                          { "(": [] },
                          {
                            "argument": [
                              {
                                "identifier:accounts_revenue.revenue": [
                                  { ".": [] }
                                ]
                              }
                            ]
                          },
                          { ")": [] }
                        ]
                      },
                      { "<=": [] },
                      { "number:300": [] }
                    ]
                  },
                  { "THEN": [] },
                  { "string:'Small'": [] }
                ]
              },
              {
                "casewhen_clause": [
                  { "WHEN_MATCHED": [] },
                  {
                    "binary_expression": [
                      {
                        "binary_expression": [
                          {
                            "function_call": [
                              { "identifier:SUM": [] },
                              { "(": [] },
                              {
                                "argument": [
                                  {
                                    "identifier:accounts_revenue.revenue": [
                                      { ".": [] }
                                    ]
                                  }
                                ]
                              },
                              { ")": [] }
                            ]
                          },
                          { ">": [] },
                          { "number:300": [] }
                        ]
                      },
                      { "AND": [] },
                      {
                        "binary_expression": [
                          {
                            "function_call": [
                              { "identifier:SUM": [] },
                              { "(": [] },
                              {
                                "argument": [
                                  {
                                    "identifier:accounts_revenue.revenue": [
                                      { ".": [] }
                                    ]
                                  }
                                ]
                              },
                              { ")": [] }
                            ]
                          },
                          { "<=": [] },
                          { "number:600": [] }
                        ]
                      }
                    ]
                  },
                  { "THEN": [] },
                  { "string:'Medium'": [] }
                ]
              },
              {
                "casewhen_clause": [
                  { "WHEN_MATCHED": [] },
                  {
                    "binary_expression": [
                      {
                        "function_call": [
                          { "identifier:SUM": [] },
                          { "(": [] },
                          {
                            "argument": [
                              {
                                "identifier:accounts_revenue.revenue": [
                                  { ".": [] }
                                ]
                              }
                            ]
                          },
                          { ")": [] }
                        ]
                      },
                      { ">": [] },
                      { "number:600": [] }
                    ]
                  },
                  { "THEN": [] },
                  { "string:'Large'": [] }
                ]
              },
              {
                "caseelse_clause": [
                  { "ELSE": [] },
                  { "NULL": [{ "NOT_NULL": [] }] }
                ]
              },
              { "END_IF": [] }
            ]
          },
          "columns": [
            {
              "node": [
                { "identifier:accounts_revenue.revenue": [{ ".": [] }] },
                { "identifier:accounts_revenue.revenue": [{ ".": [] }] },
                { "identifier:accounts_revenue.revenue": [{ ".": [] }] },
                { "identifier:accounts_revenue.revenue": [{ ".": [] }] },
                { "identifier:accounts_revenue.revenue": [{ ".": [] }] }
              ],
              "dataset": "None",
              "table": "accounts_revenue",
              "column": "revenue"
            }
          ],
          "alias": "account_size"
        },
        {
          "node": {
            "function_call": [
              { "identifier:SUM": [] },
              { "(": [] },
              {
                "argument": [
                  { "identifier:accounts_revenue.revenue": [{ ".": [] }] }
                ]
              },
              { ")": [] }
            ]
          },
          "columns": [
            {
              "node": [
                { "identifier:accounts_revenue.revenue": [{ ".": [] }] },
                { "identifier:accounts_revenue.revenue": [{ ".": [] }] },
                { "identifier:accounts_revenue.revenue": [{ ".": [] }] },
                { "identifier:accounts_revenue.revenue": [{ ".": [] }] },
                { "identifier:accounts_revenue.revenue": [{ ".": [] }] }
              ],
              "dataset": "None",
              "table": "accounts_revenue",
              "column": "revenue"
            }
          ],
          "alias": "revenue_12m"
        },
        {
          "node": { "identifier:account_id": [] },
          "columns": [
            {
              "node": [{ "identifier:account_id": [] }],
              "dataset": "None",
              "table": "accounts_revenue",
              "column": "account_id"
            }
          ],
          "alias": "None"
        },
        {
          "node": { "identifier:country": [] },
          "columns": [
            {
              "node": [{ "identifier:country": [] }],
              "dataset": "None",
              "table": "accounts_revenue",
              "column": "country"
            }
          ],
          "alias": "None"
        },
        {
          "node": {
            "identifier:accounts.name": [{ ".": [] }]
          },
          "columns": [
            {
              "node": [
                { "identifier:accounts.name": [{ ".": [] }] },
                { "identifier:accounts.name": [{ ".": [] }] }
              ],
              "dataset": "None",
              "table": "accounts",
              "column": "name"
            }
          ],
          "alias": "None"
        },
        {
          "node": { "identifier:region": [] },
          "columns": [
            {
              "node": [
                { "identifier:region": [] },
                { "identifier:region": [] }
              ],
              "dataset": "None",
              "table": "accounts_revenue",
              "column": "region"
            }
          ],
          "alias": "None"
        },
        {
          "node": {
            "identifier:accounts.industry": [{ ".": [] }]
          },
          "columns": [
            {
              "node": [
                { "identifier:accounts.industry": [{ ".": [] }] },
                { "identifier:accounts.industry": [{ ".": [] }] },
                { "identifier:accounts.industry": [{ ".": [] }] }
              ],
              "dataset": "None",
              "table": "accounts",
              "column": "industry"
            }
          ],
          "alias": "None"
        }
      ],
      "alias": "None"
    }
  ]
}
