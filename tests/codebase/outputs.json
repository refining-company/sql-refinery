{
  "files:queries": [
    { "editor.sql": {
        "root": [
          { "source_file": [
              { "comment": [] },
              { "query_statement": [
                  { "query_expr": [
                      { "select": [
                          { "SELECT": [] },
                          { "select_list": [
                              { "_aliasable_expression": [
                                  { "function_call": [
                                      { "identifier": "date" },
                                      { "(": [] },
                                      { "argument": [
                                          { "identifier": "date_month" } ] },
                                      { ",": [] },
                                      { "argument": [
                                          { "string": "'start of year'" } ] },
                                      { ")": [] } ] },
                                  { "as_alias": [
                                      { "AS": [] },
                                      { "identifier": "date_year" } ] } ] },
                              { ",": [] },
                              { "comment": [] },
                              { "_aliasable_expression": [
                                  { "casewhen_expression": [
                                      { "CASE": [] },
                                      { "casewhen_clause": [
                                          { "WHEN_MATCHED": [] },
                                          { "binary_expression": [
                                              { "identifier": "c.region" },
                                              { "IN": [] },
                                              { "(": [] },
                                              { "string": "'Americas'" },
                                              { ")": [] } ] },
                                          { "THEN": [] },
                                          { "string": "'AMER'" } ] },
                                      { "casewhen_clause": [
                                          { "WHEN_MATCHED": [] },
                                          { "binary_expression": [
                                              { "identifier": "c.region" },
                                              { "IN": [] },
                                              { "struct": [
                                                  { "(": [] },
                                                  { "string": "'Europe'" },
                                                  { ",": [] },
                                                  { "string": "'Africa'" },
                                                  { ")": [] } ] } ] },
                                          { "THEN": [] },
                                          { "string": "'EMEA'" } ] },
                                      { "casewhen_clause": [
                                          { "WHEN_MATCHED": [] },
                                          { "binary_expression": [
                                              { "identifier": "c.region" },
                                              { "=": [] },
                                              { "string": "'Asia'" } ] },
                                          { "THEN": [] },
                                          { "string": "'APAC'" } ] },
                                      { "caseelse_clause": [
                                          { "ELSE": [] },
                                          { "NULL": [
                                              { "NOT_NULL": [] } ] } ] },
                                      { "END_IF": [] } ] },
                                  { "as_alias": [
                                      { "AS": [] },
                                      { "identifier": "macro_region" } ] } ] },
                              { ",": [] },
                              { "comment": [] },
                              { "_aliasable_expression": [
                                  { "function_call": [
                                      { "identifier": "IIF" },
                                      { "(": [] },
                                      { "argument": [
                                          { "binary_expression": [
                                              { "identifier": "a.industry" },
                                              { "=": [] },
                                              { "string": "'Information Technology'" } ] } ] },
                                      { ",": [] },
                                      { "argument": [
                                          { "string": "'IT'" } ] },
                                      { ",": [] },
                                      { "argument": [
                                          { "string": "'Non-IT'" } ] },
                                      { ")": [] } ] },
                                  { "as_alias": [
                                      { "AS": [] },
                                      { "identifier": "industry_it" } ] } ] },
                              { ",": [] },
                              { "_aliasable_expression": [
                                  { "function_call": [
                                      { "identifier": "SUM" },
                                      { "(": [] },
                                      { "argument": [
                                          { "identifier": "ar.revenue" } ] },
                                      { ")": [] } ] },
                                  { "as_alias": [
                                      { "AS": [] },
                                      { "identifier": "revenue" } ] } ] },
                              { ",": [] },
                              { "_aliasable_expression": [
                                  { "function_call": [
                                      { "identifier": "COUNT" },
                                      { "(": [] },
                                      { "_keyword_distinct": [
                                          { "DISTINCT_FROM": [] } ] },
                                      { "argument": [
                                          { "identifier": "ar.account_id" } ] },
                                      { ")": [] } ] },
                                  { "as_alias": [
                                      { "AS": [] },
                                      { "identifier": "accounts" } ] } ] },
                              { ",": [] },
                              { "_aliasable_expression": [
                                  { "binary_expression": [
                                      { "function_call": [
                                          { "identifier": "SUM" },
                                          { "(": [] },
                                          { "argument": [
                                              { "identifier": "ar.revenue" } ] },
                                          { ")": [] } ] },
                                      { "/": [] },
                                      { "function_call": [
                                          { "identifier": "COUNT" },
                                          { "(": [] },
                                          { "_keyword_distinct": [
                                              { "DISTINCT_FROM": [] } ] },
                                          { "argument": [
                                              { "identifier": "ar.account_id" } ] },
                                          { ")": [] } ] } ] },
                                  { "as_alias": [
                                      { "AS": [] },
                                      { "identifier": "revenue_per_account" } ] } ] } ] },
                          { "from_clause": [
                              { "FROM": [] },
                              { "from_item": [
                                  { "join_operation": [
                                      { "from_item": [
                                          { "join_operation": [
                                              { "from_item": [
                                                  { "identifier": "accounts_revenue" },
                                                  { "as_alias": [
                                                      { "identifier": "ar" } ] } ] },
                                              { "join_type": [
                                                  { "LEFT": [] } ] },
                                              { "JOIN": [] },
                                              { "from_item": [
                                                  { "identifier": "accounts" },
                                                  { "as_alias": [
                                                      { "identifier": "a" } ] } ] },
                                              { "join_condition": [
                                                  { "USING": [] },
                                                  { "(": [] },
                                                  { "identifier": "account_id" },
                                                  { ")": [] } ] } ] } ] },
                                      { "join_type": [
                                          { "LEFT": [] } ] },
                                      { "JOIN": [] },
                                      { "from_item": [
                                          { "identifier": "countries" },
                                          { "as_alias": [
                                              { "identifier": "c" } ] } ] },
                                      { "join_condition": [
                                          { "USING": [] },
                                          { "(": [] },
                                          { "identifier": "country" },
                                          { ")": [] } ] } ] } ] } ] },
                          { "where_clause": [
                              { "WHERE": [] },
                              { "comment": [] },
                              { "binary_expression": [
                                  { "binary_expression": [
                                      { "identifier": "a.industry" },
                                      { "IN": [] },
                                      { "struct": [
                                          { "(": [] },
                                          { "string": "'Information Technology'" },
                                          { ",": [] },
                                          { "string": "'Telecommunication Services'" },
                                          { ")": [] } ] } ] },
                                  { "comment": [] },
                                  { "AND": [] },
                                  { "between_operator": [
                                      { "identifier": "date_month" },
                                      { "BETWEEN": [] },
                                      { "_expression": [
                                          { "function_call": [
                                              { "identifier": "DATE" },
                                              { "(": [] },
                                              { "argument": [
                                                  { "string": "'now'" } ] },
                                              { ",": [] },
                                              { "argument": [
                                                  { "string": "'-24 months'" } ] },
                                              { ")": [] } ] } ] },
                                      { "AND": [] },
                                      { "_expression": [
                                          { "function_call": [
                                              { "identifier": "DATE" },
                                              { "(": [] },
                                              { "argument": [
                                                  { "string": "'now'" } ] },
                                              { ")": [] } ] } ] } ] } ] } ] },
                          { "group_by_clause": [
                              { "GROUP_BY": [] },
                              { "GROUP_BY": [] },
                              { "grouping_item": [
                                  { "identifier": "date_year" } ] },
                              { ",": [] },
                              { "grouping_item": [
                                  { "identifier": "macro_region" } ] },
                              { ",": [] },
                              { "grouping_item": [
                                  { "identifier": "industry_it" } ] } ] } ] } ] } ] } ] } ] },
      "0-accounts.sql": {
        "root": [
          { "source_file": [
              { "comment": [] },
              { "comment": [] },
              { "drop_table_statement": [
                  { "DROP_PRIMARY_KEY": [] },
                  { "TABLE": [] },
                  { "keyword_if_exists": [
                      { "IF": [] },
                      { "IF_NOT_EXISTS": [] } ] },
                  { "identifier": "date_ranges" } ] },
              { ";": [] },
              { "create_table_statement": [
                  { "CREATE": [] },
                  { "TABLE": [] },
                  { "identifier": "date_ranges" },
                  { "AS": [] },
                  { "query_statement": [
                      { "query_expr": [
                          { "cte_clause": [
                              { "REMOTE_WITH_CONNECTION": [] },
                              { "with_recursive_keyword": [] },
                              { "cte": [
                                  { "identifier": "date_ranges" },
                                  { "ERROR": [
                                      { "(": [] },
                                      { ")": [] } ] },
                                  { "AS": [] },
                                  { "(": [] },
                                  { "query_expr": [
                                      { "set_operation": [
                                          { "query_expr": [
                                              { "select": [
                                                  { "SELECT": [] },
                                                  { "select_list": [
                                                      { "_aliasable_expression": [
                                                          { "function_call": [
                                                              { "identifier": "date" },
                                                              { "(": [] },
                                                              { "argument": [
                                                                  { "function_call": [
                                                                      { "identifier": "MIN" },
                                                                      { "(": [] },
                                                                      { "argument": [
                                                                          { "casewhen_expression": [
                                                                              { "CASE": [] },
                                                                              { "casewhen_clause": [
                                                                                  { "WHEN_MATCHED": [] },
                                                                                  { "binary_expression": [
                                                                                      { "identifier": "d.stage_date" },
                                                                                      { "<": [] },
                                                                                      { "identifier": "d.contract_start_date" } ] },
                                                                                  { "THEN": [] },
                                                                                  { "identifier": "d.stage_date" } ] },
                                                                              { "caseelse_clause": [
                                                                                  { "ELSE": [] },
                                                                                  { "identifier": "d.contract_start_date" } ] },
                                                                              { "END_IF": [] } ] } ] },
                                                                      { ")": [] } ] } ] },
                                                              { ")": [] } ] },
                                                          { "as_alias": [
                                                              { "AS": [] },
                                                              { "identifier": "date_month" } ] } ] } ] },
                                                  { "from_clause": [
                                                      { "FROM": [] },
                                                      { "from_item": [
                                                          { "identifier": "deals" },
                                                          { "as_alias": [
                                                              { "identifier": "d" } ] } ] } ] } ] } ] },
                                          { "UNION_ALL": [] },
                                          { "ALL": [] },
                                          { "query_expr": [
                                              { "select": [
                                                  { "SELECT": [] },
                                                  { "select_list": [
                                                      { "_aliasable_expression": [
                                                          { "function_call": [
                                                              { "identifier": "date" },
                                                              { "(": [] },
                                                              { "argument": [
                                                                  { "identifier": "date_day" } ] },
                                                              { ",": [] },
                                                              { "argument": [
                                                                  { "string": "'+1 day'" } ] },
                                                              { ")": [] } ] } ] } ] },
                                                  { "from_clause": [
                                                      { "FROM": [] },
                                                      { "from_item": [
                                                          { "identifier": "date_ranges" } ] } ] },
                                                  { "where_clause": [
                                                      { "WHERE": [] },
                                                      { "binary_expression": [
                                                          { "identifier": "date_day" },
                                                          { "<": [] },
                                                          { "select_subexpression": [
                                                              { "(": [] },
                                                              { "query_expr": [
                                                                  { "select": [
                                                                      { "SELECT": [] },
                                                                      { "select_list": [
                                                                          { "_aliasable_expression": [
                                                                              { "function_call": [
                                                                                  { "identifier": "date" },
                                                                                  { "(": [] },
                                                                                  { "argument": [
                                                                                      { "function_call": [
                                                                                          { "identifier": "MAX" },
                                                                                          { "(": [] },
                                                                                          { "argument": [
                                                                                              { "casewhen_expression": [
                                                                                                  { "CASE": [] },
                                                                                                  { "casewhen_clause": [
                                                                                                      { "WHEN_MATCHED": [] },
                                                                                                      { "binary_expression": [
                                                                                                          { "identifier": "d.contract_end_date" },
                                                                                                          { ">": [] },
                                                                                                          { "identifier": "d.stage_date" } ] },
                                                                                                      { "THEN": [] },
                                                                                                      { "identifier": "d.contract_end_date" } ] },
                                                                                                  { "caseelse_clause": [
                                                                                                      { "ELSE": [] },
                                                                                                      { "identifier": "d.stage_date" } ] },
                                                                                                  { "END_IF": [] } ] } ] },
                                                                                          { ")": [] } ] } ] },
                                                                                  { ")": [] } ] } ] } ] },
                                                                      { "from_clause": [
                                                                          { "FROM": [] },
                                                                          { "from_item": [
                                                                              { "identifier": "deals" },
                                                                              { "as_alias": [
                                                                                  { "identifier": "d" } ] } ] } ] } ] } ] },
                                                              { ")": [] } ] } ] } ] } ] } ] } ] } ] },
                                  { ")": [] } ] } ] },
                          { "select": [
                              { "SELECT": [] },
                              { "select_list": [
                                  { "_aliasable_expression": [
                                      { "identifier": "date_day" } ] } ] },
                              { "from_clause": [
                                  { "FROM": [] },
                                  { "from_item": [
                                      { "identifier": "date_ranges" } ] } ] },
                              { "group_by_clause": [
                                  { "GROUP_BY": [] },
                                  { "GROUP_BY": [] },
                                  { "grouping_item": [
                                      { "identifier": "date_day" } ] } ] } ] } ] } ] } ] },
              { ";": [] },
              { "comment": [] },
              { "drop_table_statement": [
                  { "DROP_PRIMARY_KEY": [] },
                  { "TABLE": [] },
                  { "keyword_if_exists": [
                      { "IF": [] },
                      { "IF_NOT_EXISTS": [] } ] },
                  { "identifier": "deals_signed" } ] },
              { ";": [] },
              { "create_table_statement": [
                  { "CREATE": [] },
                  { "TABLE": [] },
                  { "identifier": "deals_signed" },
                  { "AS": [] },
                  { "query_statement": [
                      { "query_expr": [
                          { "select": [
                              { "SELECT": [] },
                              { "select_list": [
                                  { "select_all": [
                                      { "asterisk_expression": [
                                          { "*": [] } ] } ] },
                                  { ",": [] },
                                  { "_aliasable_expression": [
                                      { "binary_expression": [
                                          { "identifier": "revenue" },
                                          { "/": [] },
                                          { "identifier": "contract_duration_days" } ] },
                                      { "as_alias": [
                                          { "AS": [] },
                                          { "identifier": "revenue_day" } ] } ] },
                                  { ",": [] },
                                  { "_aliasable_expression": [
                                      { "binary_expression": [
                                          { "identifier": "revenue_core" },
                                          { "/": [] },
                                          { "identifier": "contract_duration_days" } ] },
                                      { "as_alias": [
                                          { "AS": [] },
                                          { "identifier": "revenue_core_day" } ] } ] },
                                  { ",": [] },
                                  { "_aliasable_expression": [
                                      { "binary_expression": [
                                          { "identifier": "revenue_aux" },
                                          { "/": [] },
                                          { "identifier": "contract_duration_days" } ] },
                                      { "as_alias": [
                                          { "AS": [] },
                                          { "identifier": "revenue_aux_day" } ] } ] } ] },
                              { "from_clause": [
                                  { "FROM": [] },
                                  { "from_item": [
                                      { "select_subexpression": [
                                          { "(": [] },
                                          { "query_expr": [
                                              { "select": [
                                                  { "SELECT": [] },
                                                  { "select_list": [
                                                      { "_aliasable_expression": [
                                                          { "identifier": "d.deal_id" } ] },
                                                      { ",": [] },
                                                      { "_aliasable_expression": [
                                                          { "identifier": "d.account_id" } ] },
                                                      { ",": [] },
                                                      { "_aliasable_expression": [
                                                          { "identifier": "d.contract_start_date" } ] },
                                                      { ",": [] },
                                                      { "_aliasable_expression": [
                                                          { "identifier": "d.contract_end_date" } ] },
                                                      { ",": [] },
                                                      { "_aliasable_expression": [
                                                          { "binary_expression": [
                                                              { "binary_expression": [
                                                                  { "function_call": [
                                                                      { "identifier": "julianday" },
                                                                      { "(": [] },
                                                                      { "argument": [
                                                                          { "identifier": "d.contract_end_date" } ] },
                                                                      { ")": [] } ] },
                                                                  { "-": [] },
                                                                  { "function_call": [
                                                                      { "identifier": "julianday" },
                                                                      { "(": [] },
                                                                      { "argument": [
                                                                          { "identifier": "d.contract_start_date" } ] },
                                                                      { ")": [] } ] } ] },
                                                              { "+": [] },
                                                              { "number": "1" } ] },
                                                          { "as_alias": [
                                                              { "AS": [] },
                                                              { "identifier": "contract_duration_days" } ] } ] },
                                                      { ",": [] },
                                                      { "_aliasable_expression": [
                                                          { "function_call": [
                                                              { "identifier": "SUM" },
                                                              { "(": [] },
                                                              { "argument": [
                                                                  { "casewhen_expression": [
                                                                      { "CASE": [] },
                                                                      { "casewhen_clause": [
                                                                          { "WHEN_MATCHED": [] },
                                                                          { "binary_expression": [
                                                                              { "identifier": "o.product" },
                                                                              { "IN": [] },
                                                                              { "struct": [
                                                                                  { "(": [] },
                                                                                  { "string": "'Subscription Base'" },
                                                                                  { ",": [] },
                                                                                  { "string": "'Subscription Premium'" },
                                                                                  { ")": [] } ] } ] },
                                                                          { "THEN": [] },
                                                                          { "identifier": "o.value" } ] },
                                                                      { "caseelse_clause": [
                                                                          { "ELSE": [] },
                                                                          { "number": "0" } ] },
                                                                      { "END_IF": [] } ] } ] },
                                                              { ")": [] } ] },
                                                          { "as_alias": [
                                                              { "AS": [] },
                                                              { "identifier": "revenue_core" } ] } ] },
                                                      { ",": [] },
                                                      { "_aliasable_expression": [
                                                          { "function_call": [
                                                              { "identifier": "SUM" },
                                                              { "(": [] },
                                                              { "argument": [
                                                                  { "casewhen_expression": [
                                                                      { "CASE": [] },
                                                                      { "casewhen_clause": [
                                                                          { "WHEN_MATCHED": [] },
                                                                          { "binary_expression": [
                                                                              { "identifier": "o.product" },
                                                                              { "IN": [] },
                                                                              { "struct": [
                                                                                  { "(": [] },
                                                                                  { "string": "'Training'" },
                                                                                  { ",": [] },
                                                                                  { "string": "'Consulting'" },
                                                                                  { ")": [] } ] } ] },
                                                                          { "THEN": [] },
                                                                          { "identifier": "o.value" } ] },
                                                                      { "caseelse_clause": [
                                                                          { "ELSE": [] },
                                                                          { "number": "0" } ] },
                                                                      { "END_IF": [] } ] } ] },
                                                              { ")": [] } ] },
                                                          { "as_alias": [
                                                              { "AS": [] },
                                                              { "identifier": "revenue_aux" } ] } ] },
                                                      { ",": [] },
                                                      { "_aliasable_expression": [
                                                          { "function_call": [
                                                              { "identifier": "SUM" },
                                                              { "(": [] },
                                                              { "argument": [
                                                                  { "identifier": "o.value" } ] },
                                                              { ")": [] } ] },
                                                          { "as_alias": [
                                                              { "AS": [] },
                                                              { "identifier": "revenue" } ] } ] } ] },
                                                  { "from_clause": [
                                                      { "FROM": [] },
                                                      { "from_item": [
                                                          { "join_operation": [
                                                              { "from_item": [
                                                                  { "identifier": "orders" },
                                                                  { "as_alias": [
                                                                      { "identifier": "o" } ] } ] },
                                                              { "JOIN": [] },
                                                              { "from_item": [
                                                                  { "identifier": "deals" },
                                                                  { "as_alias": [
                                                                      { "identifier": "d" } ] } ] },
                                                              { "join_condition": [
                                                                  { "USING": [] },
                                                                  { "(": [] },
                                                                  { "identifier": "deal_id" },
                                                                  { ",": [] },
                                                                  { "identifier": "order_id" },
                                                                  { ")": [] } ] } ] } ] } ] },
                                                  { "where_clause": [
                                                      { "WHERE": [] },
                                                      { "binary_expression": [
                                                          { "identifier": "d.stage" },
                                                          { "=": [] },
                                                          { "number": "4" } ] } ] },
                                                  { "group_by_clause": [
                                                      { "GROUP_BY": [] },
                                                      { "GROUP_BY": [] },
                                                      { "grouping_item": [
                                                          { "identifier": "d.deal_id" } ] },
                                                      { ",": [] },
                                                      { "grouping_item": [
                                                          { "identifier": "d.account_id" } ] },
                                                      { ",": [] },
                                                      { "grouping_item": [
                                                          { "identifier": "d.contract_start_date" } ] },
                                                      { ",": [] },
                                                      { "grouping_item": [
                                                          { "identifier": "d.contract_end_date" } ] } ] } ] } ] },
                                          { ")": [] } ] },
                                      { "as_alias": [
                                          { "AS": [] },
                                          { "identifier": "t" } ] } ] } ] } ] } ] } ] } ] },
              { ";": [] },
              { "comment": [] },
              { "drop_table_statement": [
                  { "DROP_PRIMARY_KEY": [] },
                  { "TABLE": [] },
                  { "keyword_if_exists": [
                      { "IF": [] },
                      { "IF_NOT_EXISTS": [] } ] },
                  { "identifier": "accounts_revenue" } ] },
              { ";": [] },
              { "create_table_statement": [
                  { "CREATE": [] },
                  { "TABLE": [] },
                  { "identifier": "accounts_revenue" },
                  { "AS": [] },
                  { "query_statement": [
                      { "query_expr": [
                          { "select": [
                              { "SELECT": [] },
                              { "select_list": [
                                  { "_aliasable_expression": [
                                      { "identifier": "t.date_month" } ] },
                                  { ",": [] },
                                  { "_aliasable_expression": [
                                      { "identifier": "t.account_id" } ] },
                                  { ",": [] },
                                  { "_aliasable_expression": [
                                      { "function_call": [
                                          { "identifier": "AVG" },
                                          { "(": [] },
                                          { "argument": [
                                              { "identifier": "t.deals" } ] },
                                          { ")": [] } ] },
                                      { "as_alias": [
                                          { "AS": [] },
                                          { "identifier": "deals" } ] } ] },
                                  { ",": [] },
                                  { "_aliasable_expression": [
                                      { "function_call": [
                                          { "identifier": "SUM" },
                                          { "(": [] },
                                          { "argument": [
                                              { "identifier": "t.revenue_core" } ] },
                                          { ")": [] } ] },
                                      { "as_alias": [
                                          { "AS": [] },
                                          { "identifier": "revenue_core" } ] } ] },
                                  { ",": [] },
                                  { "_aliasable_expression": [
                                      { "function_call": [
                                          { "identifier": "SUM" },
                                          { "(": [] },
                                          { "argument": [
                                              { "identifier": "t.revenue_aux" } ] },
                                          { ")": [] } ] },
                                      { "as_alias": [
                                          { "AS": [] },
                                          { "identifier": "revenue_aux" } ] } ] },
                                  { ",": [] },
                                  { "_aliasable_expression": [
                                      { "function_call": [
                                          { "identifier": "SUM" },
                                          { "(": [] },
                                          { "argument": [
                                              { "identifier": "t.revenue" } ] },
                                          { ")": [] } ] },
                                      { "as_alias": [
                                          { "AS": [] },
                                          { "identifier": "revenue" } ] } ] } ] },
                              { "from_clause": [
                                  { "FROM": [] },
                                  { "from_item": [
                                      { "select_subexpression": [
                                          { "(": [] },
                                          { "query_expr": [
                                              { "select": [
                                                  { "SELECT": [] },
                                                  { "select_list": [
                                                      { "_aliasable_expression": [
                                                          { "identifier": "dr.date_day" } ] },
                                                      { ",": [] },
                                                      { "_aliasable_expression": [
                                                          { "function_call": [
                                                              { "identifier": "DATE" },
                                                              { "(": [] },
                                                              { "argument": [
                                                                  { "identifier": "date_day" } ] },
                                                              { ",": [] },
                                                              { "argument": [
                                                                  { "string": "'start of month'" } ] },
                                                              { ")": [] } ] },
                                                          { "as_alias": [
                                                              { "AS": [] },
                                                              { "identifier": "date_month" } ] } ] },
                                                      { ",": [] },
                                                      { "_aliasable_expression": [
                                                          { "identifier": "ds.account_id" } ] },
                                                      { ",": [] },
                                                      { "_aliasable_expression": [
                                                          { "function_call": [
                                                              { "identifier": "COUNT" },
                                                              { "(": [] },
                                                              { "argument": [
                                                                  { "identifier": "ds.deal_id" } ] },
                                                              { ")": [] } ] },
                                                          { "as_alias": [
                                                              { "AS": [] },
                                                              { "identifier": "deals" } ] } ] },
                                                      { ",": [] },
                                                      { "_aliasable_expression": [
                                                          { "function_call": [
                                                              { "identifier": "SUM" },
                                                              { "(": [] },
                                                              { "argument": [
                                                                  { "identifier": "ds.revenue_core_day" } ] },
                                                              { ")": [] } ] },
                                                          { "as_alias": [
                                                              { "AS": [] },
                                                              { "identifier": "revenue_core" } ] } ] },
                                                      { ",": [] },
                                                      { "_aliasable_expression": [
                                                          { "function_call": [
                                                              { "identifier": "SUM" },
                                                              { "(": [] },
                                                              { "argument": [
                                                                  { "identifier": "ds.revenue_aux_day" } ] },
                                                              { ")": [] } ] },
                                                          { "as_alias": [
                                                              { "AS": [] },
                                                              { "identifier": "revenue_aux" } ] } ] },
                                                      { ",": [] },
                                                      { "_aliasable_expression": [
                                                          { "function_call": [
                                                              { "identifier": "SUM" },
                                                              { "(": [] },
                                                              { "argument": [
                                                                  { "identifier": "ds.revenue_day" } ] },
                                                              { ")": [] } ] },
                                                          { "as_alias": [
                                                              { "AS": [] },
                                                              { "identifier": "revenue" } ] } ] } ] },
                                                  { "from_clause": [
                                                      { "FROM": [] },
                                                      { "from_item": [
                                                          { "join_operation": [
                                                              { "from_item": [
                                                                  { "identifier": "date_ranges" },
                                                                  { "as_alias": [
                                                                      { "identifier": "dr" } ] } ] },
                                                              { "join_type": [
                                                                  { "LEFT": [] } ] },
                                                              { "JOIN": [] },
                                                              { "from_item": [
                                                                  { "identifier": "deals_signed" },
                                                                  { "as_alias": [
                                                                      { "identifier": "ds" } ] } ] },
                                                              { "join_condition": [
                                                                  { "ON": [] },
                                                                  { "binary_expression": [
                                                                      { "binary_expression": [
                                                                          { "identifier": "dr.date_day" },
                                                                          { ">=": [] },
                                                                          { "function_call": [
                                                                              { "identifier": "date" },
                                                                              { "(": [] },
                                                                              { "argument": [
                                                                                  { "identifier": "ds.contract_start_date" } ] },
                                                                              { ")": [] } ] } ] },
                                                                      { "AND": [] },
                                                                      { "binary_expression": [
                                                                          { "identifier": "dr.date_day" },
                                                                          { "<=": [] },
                                                                          { "function_call": [
                                                                              { "identifier": "date" },
                                                                              { "(": [] },
                                                                              { "argument": [
                                                                                  { "identifier": "ds.contract_end_date" } ] },
                                                                              { ")": [] } ] } ] } ] } ] } ] } ] } ] },
                                                  { "group_by_clause": [
                                                      { "GROUP_BY": [] },
                                                      { "GROUP_BY": [] },
                                                      { "grouping_item": [
                                                          { "identifier": "dr.date_day" } ] },
                                                      { ",": [] },
                                                      { "grouping_item": [
                                                          { "identifier": "ds.account_id" } ] } ] } ] } ] },
                                          { ")": [] } ] },
                                      { "as_alias": [
                                          { "identifier": "t" } ] } ] } ] },
                              { "group_by_clause": [
                                  { "GROUP_BY": [] },
                                  { "GROUP_BY": [] },
                                  { "grouping_item": [
                                      { "identifier": "account_id" } ] },
                                  { ",": [] },
                                  { "grouping_item": [
                                      { "identifier": "date_month" } ] } ] } ] } ] } ] } ] },
              { ";": [] },
              { "comment": [] },
              { "drop_table_statement": [
                  { "DROP_PRIMARY_KEY": [] },
                  { "TABLE": [] },
                  { "keyword_if_exists": [
                      { "IF": [] },
                      { "IF_NOT_EXISTS": [] } ] },
                  { "identifier": "accounts_360" } ] },
              { ";": [] },
              { "create_table_statement": [
                  { "CREATE": [] },
                  { "TABLE": [] },
                  { "identifier": "accounts_360" },
                  { "AS": [] },
                  { "query_statement": [
                      { "query_expr": [
                          { "select": [
                              { "SELECT": [] },
                              { "select_list": [
                                  { "select_all": [
                                      { "asterisk_expression": [
                                          { ".": [] },
                                          { "*": [] } ] } ] },
                                  { ",": [] },
                                  { "_aliasable_expression": [
                                      { "casewhen_expression": [
                                          { "CASE": [] },
                                          { "casewhen_clause": [
                                              { "WHEN_MATCHED": [] },
                                              { "binary_expression": [
                                                  { "identifier": "t.revenue_12m" },
                                                  { "<=": [] },
                                                  { "number": "300" } ] },
                                              { "THEN": [] },
                                              { "string": "'Small'" } ] },
                                          { "casewhen_clause": [
                                              { "WHEN_MATCHED": [] },
                                              { "binary_expression": [
                                                  { "binary_expression": [
                                                      { "identifier": "t.revenue_12m" },
                                                      { ">": [] },
                                                      { "number": "300" } ] },
                                                  { "AND": [] },
                                                  { "binary_expression": [
                                                      { "identifier": "t.revenue_12m" },
                                                      { "<=": [] },
                                                      { "number": "600" } ] } ] },
                                              { "THEN": [] },
                                              { "string": "'Medium'" } ] },
                                          { "casewhen_clause": [
                                              { "WHEN_MATCHED": [] },
                                              { "binary_expression": [
                                                  { "identifier": "t.revenue_12m" },
                                                  { ">": [] },
                                                  { "number": "600" } ] },
                                              { "THEN": [] },
                                              { "string": "'Large'" } ] },
                                          { "caseelse_clause": [
                                              { "ELSE": [] },
                                              { "NULL": [
                                                  { "NOT_NULL": [] } ] } ] },
                                          { "END_IF": [] } ] },
                                      { "as_alias": [
                                          { "AS": [] },
                                          { "identifier": "account_size" } ] } ] } ] },
                              { "from_clause": [
                                  { "FROM": [] },
                                  { "from_item": [
                                      { "select_subexpression": [
                                          { "(": [] },
                                          { "query_expr": [
                                              { "select": [
                                                  { "SELECT": [] },
                                                  { "select_list": [
                                                      { "_aliasable_expression": [
                                                          { "identifier": "account_id" } ] },
                                                      { ",": [] },
                                                      { "_aliasable_expression": [
                                                          { "identifier": "date_month" } ] },
                                                      { ",": [] },
                                                      { "_aliasable_expression": [
                                                          { "identifier": "revenue" } ] },
                                                      { ",": [] },
                                                      { "_aliasable_expression": [
                                                          { "identifier": "revenue_core" } ] },
                                                      { ",": [] },
                                                      { "_aliasable_expression": [
                                                          { "identifier": "revenue_aux" } ] },
                                                      { ",": [] },
                                                      { "_aliasable_expression": [
                                                          { "identifier": "deals" } ] },
                                                      { ",": [] },
                                                      { "_aliasable_expression": [
                                                          { "identifier": "accounts.name" } ] },
                                                      { ",": [] },
                                                      { "_aliasable_expression": [
                                                          { "identifier": "accounts.industry" } ] },
                                                      { ",": [] },
                                                      { "_aliasable_expression": [
                                                          { "identifier": "accounts.country" } ] },
                                                      { ",": [] },
                                                      { "_aliasable_expression": [
                                                          { "casewhen_expression": [
                                                              { "CASE": [] },
                                                              { "casewhen_clause": [
                                                                  { "WHEN_MATCHED": [] },
                                                                  { "binary_expression": [
                                                                      { "identifier": "c.region" },
                                                                      { "IN": [] },
                                                                      { "struct": [
                                                                          { "(": [] },
                                                                          { "string": "'Americas'" },
                                                                          { ",": [] },
                                                                          { "string": "'Europe'" },
                                                                          { ")": [] } ] } ] },
                                                                  { "THEN": [] },
                                                                  { "string": "'North-West'" } ] },
                                                              { "casewhen_clause": [
                                                                  { "WHEN_MATCHED": [] },
                                                                  { "binary_expression": [
                                                                      { "identifier": "c.region" },
                                                                      { "IN": [] },
                                                                      { "struct": [
                                                                          { "(": [] },
                                                                          { "string": "'Africa'" },
                                                                          { ",": [] },
                                                                          { "string": "'Asia'" },
                                                                          { ")": [] } ] } ] },
                                                                  { "THEN": [] },
                                                                  { "string": "'South-East'" } ] },
                                                              { "caseelse_clause": [
                                                                  { "ELSE": [] },
                                                                  { "NULL": [
                                                                      { "NOT_NULL": [] } ] } ] },
                                                              { "END_IF": [] } ] },
                                                          { "as_alias": [
                                                              { "AS": [] },
                                                              { "identifier": "region_cluster" } ] } ] },
                                                      { ",": [] },
                                                      { "_aliasable_expression": [
                                                          { "identifier": "accounts.priority" } ] },
                                                      { ",": [] },
                                                      { "_aliasable_expression": [
                                                          { "function_call": [
                                                              { "identifier": "SUM" },
                                                              { "(": [] },
                                                              { "argument": [
                                                                  { "identifier": "revenue" } ] },
                                                              { ")": [] },
                                                              { "analytics_clause": [
                                                                  { "OVER": [] },
                                                                  { "over_clause": [
                                                                      { "window_specification": [
                                                                          { "(": [] },
                                                                          { "window_partition_clause": [
                                                                              { "PARTITION_COLUMNS": [] },
                                                                              { "GROUP_BY": [] },
                                                                              { "_expression": [
                                                                                  { "identifier": "account_id" } ] } ] },
                                                                          { "order_by_clause": [
                                                                              { "ORDER_BY": [] },
                                                                              { "GROUP_BY": [] },
                                                                              { "order_by_clause_body": [
                                                                                  { "identifier": "date_month" } ] } ] },
                                                                          { "window_frame_clause": [
                                                                              { "rows_range": [
                                                                                  { "ROWS": [] } ] },
                                                                              { "window_frame_between": [
                                                                                  { "BETWEEN": [] },
                                                                                  { "window_numeric_preceding": [
                                                                                      { "number": "11" },
                                                                                      { "PRECEDING": [] } ] },
                                                                                  { "AND": [] },
                                                                                  { "between_to": [
                                                                                      { "keyword_current_row": [
                                                                                          { "CURRENT_ROW": [] },
                                                                                          { "ROW": [] } ] } ] } ] } ] },
                                                                          { ")": [] } ] } ] } ] } ] },
                                                          { "as_alias": [
                                                              { "AS": [] },
                                                              { "identifier": "revenue_12m" } ] } ] } ] },
                                                  { "from_clause": [
                                                      { "FROM": [] },
                                                      { "from_item": [
                                                          { "join_operation": [
                                                              { "from_item": [
                                                                  { "join_operation": [
                                                                      { "from_item": [
                                                                          { "identifier": "accounts_revenue" } ] },
                                                                      { "join_type": [
                                                                          { "LEFT": [] } ] },
                                                                      { "JOIN": [] },
                                                                      { "from_item": [
                                                                          { "identifier": "accounts" } ] },
                                                                      { "join_condition": [
                                                                          { "USING": [] },
                                                                          { "(": [] },
                                                                          { "identifier": "account_id" },
                                                                          { ")": [] } ] } ] } ] },
                                                              { "join_type": [
                                                                  { "LEFT": [] } ] },
                                                              { "JOIN": [] },
                                                              { "from_item": [
                                                                  { "identifier": "countries" },
                                                                  { "as_alias": [
                                                                      { "identifier": "c" } ] } ] },
                                                              { "join_condition": [
                                                                  { "USING": [] },
                                                                  { "(": [] },
                                                                  { "identifier": "country" },
                                                                  { ")": [] } ] } ] } ] } ] } ] } ] },
                                          { ")": [] } ] },
                                      { "as_alias": [
                                          { "AS": [] },
                                          { "identifier": "t" } ] } ] } ] } ] } ] } ] } ] },
              { ";": [] } ] } ] },
      "1-revenue.sql": {
        "root": [
          { "source_file": [
              { "comment": [] },
              { "comment": [] },
              { "query_statement": [
                  { "query_expr": [
                      { "select": [
                          { "SELECT": [] },
                          { "select_list": [
                              { "_aliasable_expression": [
                                  { "function_call": [
                                      { "identifier": "date" },
                                      { "(": [] },
                                      { "argument": [
                                          { "identifier": "date_month" } ] },
                                      { ",": [] },
                                      { "argument": [
                                          { "string": "'start of year'" } ] },
                                      { ")": [] } ] },
                                  { "as_alias": [
                                      { "AS": [] },
                                      { "identifier": "date_year" } ] } ] },
                              { ",": [] },
                              { "_aliasable_expression": [
                                  { "casewhen_expression": [
                                      { "CASE": [] },
                                      { "casewhen_clause": [
                                          { "WHEN_MATCHED": [] },
                                          { "binary_expression": [
                                              { "identifier": "c.region" },
                                              { "IN": [] },
                                              { "struct": [
                                                  { "(": [] },
                                                  { "string": "'Americas'" },
                                                  { ",": [] },
                                                  { "string": "'Europe'" },
                                                  { ")": [] } ] } ] },
                                          { "THEN": [] },
                                          { "string": "'North-West'" } ] },
                                      { "casewhen_clause": [
                                          { "WHEN_MATCHED": [] },
                                          { "binary_expression": [
                                              { "identifier": "c.region" },
                                              { "IN": [] },
                                              { "struct": [
                                                  { "(": [] },
                                                  { "string": "'Africa'" },
                                                  { ",": [] },
                                                  { "string": "'Asia'" },
                                                  { ")": [] } ] } ] },
                                          { "THEN": [] },
                                          { "string": "'South-East'" } ] },
                                      { "caseelse_clause": [
                                          { "ELSE": [] },
                                          { "NULL": [
                                              { "NOT_NULL": [] } ] } ] },
                                      { "END_IF": [] } ] },
                                  { "as_alias": [
                                      { "AS": [] },
                                      { "identifier": "region_cluster" } ] } ] },
                              { ",": [] },
                              { "_aliasable_expression": [
                                  { "casewhen_expression": [
                                      { "CASE": [] },
                                      { "casewhen_clause": [
                                          { "WHEN_MATCHED": [] },
                                          { "binary_expression": [
                                              { "identifier": "a.industry" },
                                              { "=": [] },
                                              { "string": "'Information Technology'" } ] },
                                          { "THEN": [] },
                                          { "string": "'Tech'" } ] },
                                      { "casewhen_clause": [
                                          { "WHEN_MATCHED": [] },
                                          { "unary_expression": [
                                              { "identifier": "a.industry" },
                                              { "IS": [] },
                                              { "NULL": [
                                                  { "NOT_NULL": [] } ] } ] },
                                          { "THEN": [] },
                                          { "NULL": [
                                              { "NOT_NULL": [] } ] } ] },
                                      { "caseelse_clause": [
                                          { "ELSE": [] },
                                          { "string": "'Other'" } ] },
                                      { "END_IF": [] } ] },
                                  { "as_alias": [
                                      { "AS": [] },
                                      { "identifier": "industry_cluster" } ] } ] },
                              { ",": [] },
                              { "_aliasable_expression": [
                                  { "identifier": "a360.account_size" } ] },
                              { ",": [] },
                              { "_aliasable_expression": [
                                  { "function_call": [
                                      { "identifier": "SUM" },
                                      { "(": [] },
                                      { "argument": [
                                          { "identifier": "ar.revenue" } ] },
                                      { ")": [] } ] },
                                  { "as_alias": [
                                      { "AS": [] },
                                      { "identifier": "revenue" } ] } ] },
                              { ",": [] },
                              { "_aliasable_expression": [
                                  { "function_call": [
                                      { "identifier": "COUNT" },
                                      { "(": [] },
                                      { "_keyword_distinct": [
                                          { "DISTINCT_FROM": [] } ] },
                                      { "argument": [
                                          { "identifier": "ar.account_id" } ] },
                                      { ")": [] } ] },
                                  { "as_alias": [
                                      { "AS": [] },
                                      { "identifier": "accounts" } ] } ] },
                              { ",": [] },
                              { "_aliasable_expression": [
                                  { "binary_expression": [
                                      { "function_call": [
                                          { "identifier": "SUM" },
                                          { "(": [] },
                                          { "argument": [
                                              { "identifier": "ar.revenue" } ] },
                                          { ")": [] } ] },
                                      { "/": [] },
                                      { "function_call": [
                                          { "identifier": "COUNT" },
                                          { "(": [] },
                                          { "_keyword_distinct": [
                                              { "DISTINCT_FROM": [] } ] },
                                          { "argument": [
                                              { "identifier": "ar.account_id" } ] },
                                          { ")": [] } ] } ] },
                                  { "as_alias": [
                                      { "AS": [] },
                                      { "identifier": "revenue_per_account" } ] } ] } ] },
                          { "from_clause": [
                              { "FROM": [] },
                              { "from_item": [
                                  { "join_operation": [
                                      { "from_item": [
                                          { "join_operation": [
                                              { "from_item": [
                                                  { "join_operation": [
                                                      { "from_item": [
                                                          { "identifier": "accounts_revenue" },
                                                          { "as_alias": [
                                                              { "identifier": "ar" } ] } ] },
                                                      { "join_type": [
                                                          { "LEFT": [] } ] },
                                                      { "JOIN": [] },
                                                      { "from_item": [
                                                          { "identifier": "accounts" },
                                                          { "as_alias": [
                                                              { "identifier": "a" } ] } ] },
                                                      { "join_condition": [
                                                          { "USING": [] },
                                                          { "(": [] },
                                                          { "identifier": "account_id" },
                                                          { ")": [] } ] } ] } ] },
                                              { "join_type": [
                                                  { "LEFT": [] } ] },
                                              { "JOIN": [] },
                                              { "from_item": [
                                                  { "identifier": "countries" },
                                                  { "as_alias": [
                                                      { "identifier": "c" } ] } ] },
                                              { "join_condition": [
                                                  { "USING": [] },
                                                  { "(": [] },
                                                  { "identifier": "country" },
                                                  { ")": [] } ] } ] } ] },
                                      { "join_type": [
                                          { "LEFT": [] } ] },
                                      { "JOIN": [] },
                                      { "from_item": [
                                          { "identifier": "accounts_360" },
                                          { "as_alias": [
                                              { "identifier": "a360" } ] } ] },
                                      { "join_condition": [
                                          { "USING": [] },
                                          { "(": [] },
                                          { "identifier": "account_id" },
                                          { ",": [] },
                                          { "identifier": "date_month" },
                                          { ")": [] } ] } ] } ] } ] },
                          { "group_by_clause": [
                              { "GROUP_BY": [] },
                              { "GROUP_BY": [] },
                              { "grouping_item": [
                                  { "identifier": "date_year" } ] },
                              { ",": [] },
                              { "grouping_item": [
                                  { "identifier": "region_cluster" } ] },
                              { ",": [] },
                              { "grouping_item": [
                                  { "identifier": "industry_cluster" } ] },
                              { ",": [] },
                              { "grouping_item": [
                                  { "identifier": "a360.account_size" } ] } ] } ] },
                      { "order_by_clause": [
                          { "ORDER_BY": [] },
                          { "GROUP_BY": [] },
                          { "order_by_clause_body": [
                              { "identifier": "date_year" },
                              { ",": [] },
                              { "identifier": "region_cluster" },
                              { ",": [] },
                              { "identifier": "industry_cluster" } ] } ] } ] } ] },
              { ";": [] },
              { "comment": [] },
              { "query_statement": [
                  { "query_expr": [
                      { "select": [
                          { "SELECT": [] },
                          { "select_list": [
                              { "_aliasable_expression": [
                                  { "identifier": "accounts.name" } ] },
                              { ",": [] },
                              { "_aliasable_expression": [
                                  { "identifier": "region" } ] },
                              { ",": [] },
                              { "_aliasable_expression": [
                                  { "casewhen_expression": [
                                      { "CASE": [] },
                                      { "casewhen_clause": [
                                          { "WHEN_MATCHED": [] },
                                          { "binary_expression": [
                                              { "identifier": "c.region" },
                                              { "IN": [] },
                                              { "struct": [
                                                  { "(": [] },
                                                  { "string": "'Americas'" },
                                                  { ",": [] },
                                                  { "string": "'Europe'" },
                                                  { ")": [] } ] } ] },
                                          { "THEN": [] },
                                          { "string": "'North-West'" } ] },
                                      { "casewhen_clause": [
                                          { "WHEN_MATCHED": [] },
                                          { "binary_expression": [
                                              { "identifier": "c.region" },
                                              { "IN": [] },
                                              { "struct": [
                                                  { "(": [] },
                                                  { "string": "'Africa'" },
                                                  { ",": [] },
                                                  { "string": "'Asia'" },
                                                  { ")": [] } ] } ] },
                                          { "THEN": [] },
                                          { "string": "'South-East'" } ] },
                                      { "caseelse_clause": [
                                          { "ELSE": [] },
                                          { "NULL": [
                                              { "NOT_NULL": [] } ] } ] },
                                      { "END_IF": [] } ] },
                                  { "as_alias": [
                                      { "AS": [] },
                                      { "identifier": "cluster" } ] } ] },
                              { ",": [] },
                              { "_aliasable_expression": [
                                  { "identifier": "accounts.industry" },
                                  { "as_alias": [
                                      { "AS": [] },
                                      { "identifier": "industry" } ] } ] },
                              { ",": [] },
                              { "_aliasable_expression": [
                                  { "function_call": [
                                      { "identifier": "IIF" },
                                      { "(": [] },
                                      { "argument": [
                                          { "binary_expression": [
                                              { "identifier": "accounts.industry" },
                                              { "=": [] },
                                              { "string": "'Information Technology'" } ] } ] },
                                      { ",": [] },
                                      { "argument": [
                                          { "string": "'Tech'" } ] },
                                      { ",": [] },
                                      { "argument": [
                                          { "string": "'Other'" } ] },
                                      { ")": [] } ] },
                                  { "as_alias": [
                                      { "AS": [] },
                                      { "identifier": "industry_tech" } ] } ] },
                              { ",": [] },
                              { "_aliasable_expression": [
                                  { "casewhen_expression": [
                                      { "CASE": [] },
                                      { "casewhen_clause": [
                                          { "WHEN_MATCHED": [] },
                                          { "binary_expression": [
                                              { "function_call": [
                                                  { "identifier": "SUM" },
                                                  { "(": [] },
                                                  { "argument": [
                                                      { "identifier": "accounts_revenue.revenue" } ] },
                                                  { ")": [] } ] },
                                              { "<=": [] },
                                              { "number": "300" } ] },
                                          { "THEN": [] },
                                          { "string": "'Small'" } ] },
                                      { "casewhen_clause": [
                                          { "WHEN_MATCHED": [] },
                                          { "binary_expression": [
                                              { "binary_expression": [
                                                  { "function_call": [
                                                      { "identifier": "SUM" },
                                                      { "(": [] },
                                                      { "argument": [
                                                          { "identifier": "accounts_revenue.revenue" } ] },
                                                      { ")": [] } ] },
                                                  { ">": [] },
                                                  { "number": "300" } ] },
                                              { "AND": [] },
                                              { "binary_expression": [
                                                  { "function_call": [
                                                      { "identifier": "SUM" },
                                                      { "(": [] },
                                                      { "argument": [
                                                          { "identifier": "accounts_revenue.revenue" } ] },
                                                      { ")": [] } ] },
                                                  { "<=": [] },
                                                  { "number": "600" } ] } ] },
                                          { "THEN": [] },
                                          { "string": "'Medium'" } ] },
                                      { "casewhen_clause": [
                                          { "WHEN_MATCHED": [] },
                                          { "binary_expression": [
                                              { "function_call": [
                                                  { "identifier": "SUM" },
                                                  { "(": [] },
                                                  { "argument": [
                                                      { "identifier": "accounts_revenue.revenue" } ] },
                                                  { ")": [] } ] },
                                              { ">": [] },
                                              { "number": "600" } ] },
                                          { "THEN": [] },
                                          { "string": "'Large'" } ] },
                                      { "caseelse_clause": [
                                          { "ELSE": [] },
                                          { "NULL": [
                                              { "NOT_NULL": [] } ] } ] },
                                      { "END_IF": [] } ] },
                                  { "as_alias": [
                                      { "AS": [] },
                                      { "identifier": "account_size" } ] } ] },
                              { ",": [] },
                              { "_aliasable_expression": [
                                  { "function_call": [
                                      { "identifier": "SUM" },
                                      { "(": [] },
                                      { "argument": [
                                          { "identifier": "accounts_revenue.revenue" } ] },
                                      { ")": [] } ] },
                                  { "as_alias": [
                                      { "AS": [] },
                                      { "identifier": "revenue_12m" } ] } ] } ] },
                          { "from_clause": [
                              { "FROM": [] },
                              { "from_item": [
                                  { "join_operation": [
                                      { "from_item": [
                                          { "join_operation": [
                                              { "from_item": [
                                                  { "identifier": "accounts" } ] },
                                              { "join_type": [
                                                  { "LEFT": [] } ] },
                                              { "JOIN": [] },
                                              { "from_item": [
                                                  { "identifier": "accounts_revenue" } ] },
                                              { "join_condition": [
                                                  { "USING": [] },
                                                  { "(": [] },
                                                  { "identifier": "account_id" },
                                                  { ")": [] } ] } ] } ] },
                                      { "join_type": [
                                          { "LEFT": [] } ] },
                                      { "JOIN": [] },
                                      { "from_item": [
                                          { "identifier": "countries" },
                                          { "as_alias": [
                                              { "identifier": "c" } ] } ] },
                                      { "join_condition": [
                                          { "USING": [] },
                                          { "(": [] },
                                          { "identifier": "country" },
                                          { ")": [] } ] } ] } ] } ] },
                          { "where_clause": [
                              { "WHERE": [] },
                              { "between_operator": [
                                  { "identifier": "accounts_revenue.date_month" },
                                  { "BETWEEN": [] },
                                  { "_expression": [
                                      { "function_call": [
                                          { "identifier": "DATE" },
                                          { "(": [] },
                                          { "argument": [
                                              { "string": "'now'" } ] },
                                          { ",": [] },
                                          { "argument": [
                                              { "string": "'-12 months'" } ] },
                                          { ")": [] } ] } ] },
                                  { "AND": [] },
                                  { "_expression": [
                                      { "function_call": [
                                          { "identifier": "DATE" },
                                          { "(": [] },
                                          { "argument": [
                                              { "string": "'now'" } ] },
                                          { ")": [] } ] } ] } ] } ] },
                          { "group_by_clause": [
                              { "GROUP_BY": [] },
                              { "GROUP_BY": [] },
                              { "grouping_item": [
                                  { "identifier": "accounts.name" } ] },
                              { ",": [] },
                              { "grouping_item": [
                                  { "identifier": "region" } ] },
                              { ",": [] },
                              { "grouping_item": [
                                  { "identifier": "accounts.industry" } ] } ] } ] } ] } ] },
              { ";": [] } ] } ] } },
    [
      { "node:sources:ops:alias": [
          { "query_expr": [
              { "select": [
                  { "SELECT": [] },
                  { "select_list": [
                      { "_aliasable_expression": [
                          { "function_call": [
                              { "identifier": "date" },
                              { "(": [] },
                              { "argument": [
                                  { "identifier": "date_month" } ] },
                              { ",": [] },
                              { "argument": [
                                  { "string": "'start of year'" } ] },
                              { ")": [] } ] },
                          { "as_alias": [
                              { "AS": [] },
                              { "identifier": "date_year" } ] } ] },
                      { ",": [] },
                      { "comment": [] },
                      { "_aliasable_expression": [
                          { "casewhen_expression": [
                              { "CASE": [] },
                              { "casewhen_clause": [
                                  { "WHEN_MATCHED": [] },
                                  { "binary_expression": [
                                      { "identifier": "c.region" },
                                      { "IN": [] },
                                      { "(": [] },
                                      { "string": "'Americas'" },
                                      { ")": [] } ] },
                                  { "THEN": [] },
                                  { "string": "'AMER'" } ] },
                              { "casewhen_clause": [
                                  { "WHEN_MATCHED": [] },
                                  { "binary_expression": [
                                      { "identifier": "c.region" },
                                      { "IN": [] },
                                      { "struct": [
                                          { "(": [] },
                                          { "string": "'Europe'" },
                                          { ",": [] },
                                          { "string": "'Africa'" },
                                          { ")": [] } ] } ] },
                                  { "THEN": [] },
                                  { "string": "'EMEA'" } ] },
                              { "casewhen_clause": [
                                  { "WHEN_MATCHED": [] },
                                  { "binary_expression": [
                                      { "identifier": "c.region" },
                                      { "=": [] },
                                      { "string": "'Asia'" } ] },
                                  { "THEN": [] },
                                  { "string": "'APAC'" } ] },
                              { "caseelse_clause": [
                                  { "ELSE": [] },
                                  { "NULL": [
                                      { "NOT_NULL": [] } ] } ] },
                              { "END_IF": [] } ] },
                          { "as_alias": [
                              { "AS": [] },
                              { "identifier": "macro_region" } ] } ] },
                      { ",": [] },
                      { "comment": [] },
                      { "_aliasable_expression": [
                          { "function_call": [
                              { "identifier": "IIF" },
                              { "(": [] },
                              { "argument": [
                                  { "binary_expression": [
                                      { "identifier": "a.industry" },
                                      { "=": [] },
                                      { "string": "'Information Technology'" } ] } ] },
                              { ",": [] },
                              { "argument": [
                                  { "string": "'IT'" } ] },
                              { ",": [] },
                              { "argument": [
                                  { "string": "'Non-IT'" } ] },
                              { ")": [] } ] },
                          { "as_alias": [
                              { "AS": [] },
                              { "identifier": "industry_it" } ] } ] },
                      { ",": [] },
                      { "_aliasable_expression": [
                          { "function_call": [
                              { "identifier": "SUM" },
                              { "(": [] },
                              { "argument": [
                                  { "identifier": "ar.revenue" } ] },
                              { ")": [] } ] },
                          { "as_alias": [
                              { "AS": [] },
                              { "identifier": "revenue" } ] } ] },
                      { ",": [] },
                      { "_aliasable_expression": [
                          { "function_call": [
                              { "identifier": "COUNT" },
                              { "(": [] },
                              { "_keyword_distinct": [
                                  { "DISTINCT_FROM": [] } ] },
                              { "argument": [
                                  { "identifier": "ar.account_id" } ] },
                              { ")": [] } ] },
                          { "as_alias": [
                              { "AS": [] },
                              { "identifier": "accounts" } ] } ] },
                      { ",": [] },
                      { "_aliasable_expression": [
                          { "binary_expression": [
                              { "function_call": [
                                  { "identifier": "SUM" },
                                  { "(": [] },
                                  { "argument": [
                                      { "identifier": "ar.revenue" } ] },
                                  { ")": [] } ] },
                              { "/": [] },
                              { "function_call": [
                                  { "identifier": "COUNT" },
                                  { "(": [] },
                                  { "_keyword_distinct": [
                                      { "DISTINCT_FROM": [] } ] },
                                  { "argument": [
                                      { "identifier": "ar.account_id" } ] },
                                  { ")": [] } ] } ] },
                          { "as_alias": [
                              { "AS": [] },
                              { "identifier": "revenue_per_account" } ] } ] } ] },
                  { "from_clause": [
                      { "FROM": [] },
                      { "from_item": [
                          { "join_operation": [
                              { "from_item": [
                                  { "join_operation": [
                                      { "from_item": [
                                          { "identifier": "accounts_revenue" },
                                          { "as_alias": [
                                              { "identifier": "ar" } ] } ] },
                                      { "join_type": [
                                          { "LEFT": [] } ] },
                                      { "JOIN": [] },
                                      { "from_item": [
                                          { "identifier": "accounts" },
                                          { "as_alias": [
                                              { "identifier": "a" } ] } ] },
                                      { "join_condition": [
                                          { "USING": [] },
                                          { "(": [] },
                                          { "identifier": "account_id" },
                                          { ")": [] } ] } ] } ] },
                              { "join_type": [
                                  { "LEFT": [] } ] },
                              { "JOIN": [] },
                              { "from_item": [
                                  { "identifier": "countries" },
                                  { "as_alias": [
                                      { "identifier": "c" } ] } ] },
                              { "join_condition": [
                                  { "USING": [] },
                                  { "(": [] },
                                  { "identifier": "country" },
                                  { ")": [] } ] } ] } ] } ] },
                  { "where_clause": [
                      { "WHERE": [] },
                      { "comment": [] },
                      { "binary_expression": [
                          { "binary_expression": [
                              { "identifier": "a.industry" },
                              { "IN": [] },
                              { "struct": [
                                  { "(": [] },
                                  { "string": "'Information Technology'" },
                                  { ",": [] },
                                  { "string": "'Telecommunication Services'" },
                                  { ")": [] } ] } ] },
                          { "comment": [] },
                          { "AND": [] },
                          { "between_operator": [
                              { "identifier": "date_month" },
                              { "BETWEEN": [] },
                              { "_expression": [
                                  { "function_call": [
                                      { "identifier": "DATE" },
                                      { "(": [] },
                                      { "argument": [
                                          { "string": "'now'" } ] },
                                      { ",": [] },
                                      { "argument": [
                                          { "string": "'-24 months'" } ] },
                                      { ")": [] } ] } ] },
                              { "AND": [] },
                              { "_expression": [
                                  { "function_call": [
                                      { "identifier": "DATE" },
                                      { "(": [] },
                                      { "argument": [
                                          { "string": "'now'" } ] },
                                      { ")": [] } ] } ] } ] } ] } ] },
                  { "group_by_clause": [
                      { "GROUP_BY": [] },
                      { "GROUP_BY": [] },
                      { "grouping_item": [
                          { "identifier": "date_year" } ] },
                      { ",": [] },
                      { "grouping_item": [
                          { "identifier": "macro_region" } ] },
                      { ",": [] },
                      { "grouping_item": [
                          { "identifier": "industry_it" } ] } ] } ] } ] },
          [
            { "node:dataset:table:alias": [
                { "identifier": "accounts_revenue" },
                "None",
                "accounts_revenue",
                "ar" ] },
            { "node:dataset:table:alias": [
                { "identifier": "accounts" },
                "None",
                "accounts",
                "a" ] },
            { "node:dataset:table:alias": [
                { "identifier": "countries" },
                "None",
                "countries",
                "c" ] } ],
          [
            { "node:columns:alias": [
                { "function_call": [
                    { "identifier": "date" },
                    { "(": [] },
                    { "argument": [
                        { "identifier": "date_month" } ] },
                    { ",": [] },
                    { "argument": [
                        { "string": "'start of year'" } ] },
                    { ")": [] } ] },
                [
                  { "nodes:dataset:table:column": [
                      [
                        { "identifier": "date_month" },
                        { "identifier": "date_month" } ],
                      "None",
                      "None",
                      "date_month" ] } ],
                "date_year" ] },
            { "node:columns:alias": [
                { "casewhen_expression": [
                    { "CASE": [] },
                    { "casewhen_clause": [
                        { "WHEN_MATCHED": [] },
                        { "binary_expression": [
                            { "identifier": "c.region" },
                            { "IN": [] },
                            { "(": [] },
                            { "string": "'Americas'" },
                            { ")": [] } ] },
                        { "THEN": [] },
                        { "string": "'AMER'" } ] },
                    { "casewhen_clause": [
                        { "WHEN_MATCHED": [] },
                        { "binary_expression": [
                            { "identifier": "c.region" },
                            { "IN": [] },
                            { "struct": [
                                { "(": [] },
                                { "string": "'Europe'" },
                                { ",": [] },
                                { "string": "'Africa'" },
                                { ")": [] } ] } ] },
                        { "THEN": [] },
                        { "string": "'EMEA'" } ] },
                    { "casewhen_clause": [
                        { "WHEN_MATCHED": [] },
                        { "binary_expression": [
                            { "identifier": "c.region" },
                            { "=": [] },
                            { "string": "'Asia'" } ] },
                        { "THEN": [] },
                        { "string": "'APAC'" } ] },
                    { "caseelse_clause": [
                        { "ELSE": [] },
                        { "NULL": [
                            { "NOT_NULL": [] } ] } ] },
                    { "END_IF": [] } ] },
                [
                  { "nodes:dataset:table:column": [
                      [
                        { "identifier": "c.region" },
                        { "identifier": "c.region" },
                        { "identifier": "c.region" } ],
                      "None",
                      "countries",
                      "region" ] } ],
                "macro_region" ] },
            { "node:columns:alias": [
                { "function_call": [
                    { "identifier": "IIF" },
                    { "(": [] },
                    { "argument": [
                        { "binary_expression": [
                            { "identifier": "a.industry" },
                            { "=": [] },
                            { "string": "'Information Technology'" } ] } ] },
                    { ",": [] },
                    { "argument": [
                        { "string": "'IT'" } ] },
                    { ",": [] },
                    { "argument": [
                        { "string": "'Non-IT'" } ] },
                    { ")": [] } ] },
                [
                  { "nodes:dataset:table:column": [
                      [
                        { "identifier": "a.industry" },
                        { "identifier": "a.industry" } ],
                      "None",
                      "accounts",
                      "industry" ] } ],
                "industry_it" ] },
            { "node:columns:alias": [
                { "function_call": [
                    { "identifier": "SUM" },
                    { "(": [] },
                    { "argument": [
                        { "identifier": "ar.revenue" } ] },
                    { ")": [] } ] },
                [
                  { "nodes:dataset:table:column": [
                      [
                        { "identifier": "ar.revenue" },
                        { "identifier": "ar.revenue" } ],
                      "None",
                      "accounts_revenue",
                      "revenue" ] } ],
                "revenue" ] },
            { "node:columns:alias": [
                { "function_call": [
                    { "identifier": "COUNT" },
                    { "(": [] },
                    { "_keyword_distinct": [
                        { "DISTINCT_FROM": [] } ] },
                    { "argument": [
                        { "identifier": "ar.account_id" } ] },
                    { ")": [] } ] },
                [
                  { "nodes:dataset:table:column": [
                      [
                        { "identifier": "ar.account_id" },
                        { "identifier": "ar.account_id" } ],
                      "None",
                      "accounts_revenue",
                      "account_id" ] } ],
                "accounts" ] },
            { "node:columns:alias": [
                { "binary_expression": [
                    { "function_call": [
                        { "identifier": "SUM" },
                        { "(": [] },
                        { "argument": [
                            { "identifier": "ar.revenue" } ] },
                        { ")": [] } ] },
                    { "/": [] },
                    { "function_call": [
                        { "identifier": "COUNT" },
                        { "(": [] },
                        { "_keyword_distinct": [
                            { "DISTINCT_FROM": [] } ] },
                        { "argument": [
                            { "identifier": "ar.account_id" } ] },
                        { ")": [] } ] } ] },
                [
                  { "nodes:dataset:table:column": [
                      [
                        { "identifier": "ar.revenue" },
                        { "identifier": "ar.revenue" } ],
                      "None",
                      "accounts_revenue",
                      "revenue" ] },
                  { "nodes:dataset:table:column": [
                      [
                        { "identifier": "ar.account_id" },
                        { "identifier": "ar.account_id" } ],
                      "None",
                      "accounts_revenue",
                      "account_id" ] } ],
                "revenue_per_account" ] },
            { "node:columns:alias": [
                { "identifier": "account_id" },
                [
                  { "nodes:dataset:table:column": [
                      [
                        { "identifier": "account_id" } ],
                      "None",
                      "None",
                      "account_id" ] } ],
                "None" ] },
            { "node:columns:alias": [
                { "identifier": "country" },
                [
                  { "nodes:dataset:table:column": [
                      [
                        { "identifier": "country" } ],
                      "None",
                      "None",
                      "country" ] } ],
                "None" ] },
            { "node:columns:alias": [
                { "identifier": "date_year" },
                [
                  { "nodes:dataset:table:column": [
                      [
                        { "identifier": "date_year" } ],
                      "None",
                      "None",
                      "date_year" ] } ],
                "None" ] },
            { "node:columns:alias": [
                { "identifier": "macro_region" },
                [
                  { "nodes:dataset:table:column": [
                      [
                        { "identifier": "macro_region" } ],
                      "None",
                      "None",
                      "macro_region" ] } ],
                "None" ] },
            { "node:columns:alias": [
                { "identifier": "industry_it" },
                [
                  { "nodes:dataset:table:column": [
                      [
                        { "identifier": "industry_it" } ],
                      "None",
                      "None",
                      "industry_it" ] } ],
                "None" ] } ],
          "None" ] },
      { "node:sources:ops:alias": [
          { "query_expr": [
              { "select": [
                  { "SELECT": [] },
                  { "select_list": [
                      { "select_all": [
                          { "asterisk_expression": [
                              { "*": [] } ] } ] },
                      { ",": [] },
                      { "_aliasable_expression": [
                          { "binary_expression": [
                              { "identifier": "revenue" },
                              { "/": [] },
                              { "identifier": "contract_duration_days" } ] },
                          { "as_alias": [
                              { "AS": [] },
                              { "identifier": "revenue_day" } ] } ] },
                      { ",": [] },
                      { "_aliasable_expression": [
                          { "binary_expression": [
                              { "identifier": "revenue_core" },
                              { "/": [] },
                              { "identifier": "contract_duration_days" } ] },
                          { "as_alias": [
                              { "AS": [] },
                              { "identifier": "revenue_core_day" } ] } ] },
                      { ",": [] },
                      { "_aliasable_expression": [
                          { "binary_expression": [
                              { "identifier": "revenue_aux" },
                              { "/": [] },
                              { "identifier": "contract_duration_days" } ] },
                          { "as_alias": [
                              { "AS": [] },
                              { "identifier": "revenue_aux_day" } ] } ] } ] },
                  { "from_clause": [
                      { "FROM": [] },
                      { "from_item": [
                          { "select_subexpression": [
                              { "(": [] },
                              { "query_expr": [
                                  { "select": [
                                      { "SELECT": [] },
                                      { "select_list": [
                                          { "_aliasable_expression": [
                                              { "identifier": "d.deal_id" } ] },
                                          { ",": [] },
                                          { "_aliasable_expression": [
                                              { "identifier": "d.account_id" } ] },
                                          { ",": [] },
                                          { "_aliasable_expression": [
                                              { "identifier": "d.contract_start_date" } ] },
                                          { ",": [] },
                                          { "_aliasable_expression": [
                                              { "identifier": "d.contract_end_date" } ] },
                                          { ",": [] },
                                          { "_aliasable_expression": [
                                              { "binary_expression": [
                                                  { "binary_expression": [
                                                      { "function_call": [
                                                          { "identifier": "julianday" },
                                                          { "(": [] },
                                                          { "argument": [
                                                              { "identifier": "d.contract_end_date" } ] },
                                                          { ")": [] } ] },
                                                      { "-": [] },
                                                      { "function_call": [
                                                          { "identifier": "julianday" },
                                                          { "(": [] },
                                                          { "argument": [
                                                              { "identifier": "d.contract_start_date" } ] },
                                                          { ")": [] } ] } ] },
                                                  { "+": [] },
                                                  { "number": "1" } ] },
                                              { "as_alias": [
                                                  { "AS": [] },
                                                  { "identifier": "contract_duration_days" } ] } ] },
                                          { ",": [] },
                                          { "_aliasable_expression": [
                                              { "function_call": [
                                                  { "identifier": "SUM" },
                                                  { "(": [] },
                                                  { "argument": [
                                                      { "casewhen_expression": [
                                                          { "CASE": [] },
                                                          { "casewhen_clause": [
                                                              { "WHEN_MATCHED": [] },
                                                              { "binary_expression": [
                                                                  { "identifier": "o.product" },
                                                                  { "IN": [] },
                                                                  { "struct": [
                                                                      { "(": [] },
                                                                      { "string": "'Subscription Base'" },
                                                                      { ",": [] },
                                                                      { "string": "'Subscription Premium'" },
                                                                      { ")": [] } ] } ] },
                                                              { "THEN": [] },
                                                              { "identifier": "o.value" } ] },
                                                          { "caseelse_clause": [
                                                              { "ELSE": [] },
                                                              { "number": "0" } ] },
                                                          { "END_IF": [] } ] } ] },
                                                  { ")": [] } ] },
                                              { "as_alias": [
                                                  { "AS": [] },
                                                  { "identifier": "revenue_core" } ] } ] },
                                          { ",": [] },
                                          { "_aliasable_expression": [
                                              { "function_call": [
                                                  { "identifier": "SUM" },
                                                  { "(": [] },
                                                  { "argument": [
                                                      { "casewhen_expression": [
                                                          { "CASE": [] },
                                                          { "casewhen_clause": [
                                                              { "WHEN_MATCHED": [] },
                                                              { "binary_expression": [
                                                                  { "identifier": "o.product" },
                                                                  { "IN": [] },
                                                                  { "struct": [
                                                                      { "(": [] },
                                                                      { "string": "'Training'" },
                                                                      { ",": [] },
                                                                      { "string": "'Consulting'" },
                                                                      { ")": [] } ] } ] },
                                                              { "THEN": [] },
                                                              { "identifier": "o.value" } ] },
                                                          { "caseelse_clause": [
                                                              { "ELSE": [] },
                                                              { "number": "0" } ] },
                                                          { "END_IF": [] } ] } ] },
                                                  { ")": [] } ] },
                                              { "as_alias": [
                                                  { "AS": [] },
                                                  { "identifier": "revenue_aux" } ] } ] },
                                          { ",": [] },
                                          { "_aliasable_expression": [
                                              { "function_call": [
                                                  { "identifier": "SUM" },
                                                  { "(": [] },
                                                  { "argument": [
                                                      { "identifier": "o.value" } ] },
                                                  { ")": [] } ] },
                                              { "as_alias": [
                                                  { "AS": [] },
                                                  { "identifier": "revenue" } ] } ] } ] },
                                      { "from_clause": [
                                          { "FROM": [] },
                                          { "from_item": [
                                              { "join_operation": [
                                                  { "from_item": [
                                                      { "identifier": "orders" },
                                                      { "as_alias": [
                                                          { "identifier": "o" } ] } ] },
                                                  { "JOIN": [] },
                                                  { "from_item": [
                                                      { "identifier": "deals" },
                                                      { "as_alias": [
                                                          { "identifier": "d" } ] } ] },
                                                  { "join_condition": [
                                                      { "USING": [] },
                                                      { "(": [] },
                                                      { "identifier": "deal_id" },
                                                      { ",": [] },
                                                      { "identifier": "order_id" },
                                                      { ")": [] } ] } ] } ] } ] },
                                      { "where_clause": [
                                          { "WHERE": [] },
                                          { "binary_expression": [
                                              { "identifier": "d.stage" },
                                              { "=": [] },
                                              { "number": "4" } ] } ] },
                                      { "group_by_clause": [
                                          { "GROUP_BY": [] },
                                          { "GROUP_BY": [] },
                                          { "grouping_item": [
                                              { "identifier": "d.deal_id" } ] },
                                          { ",": [] },
                                          { "grouping_item": [
                                              { "identifier": "d.account_id" } ] },
                                          { ",": [] },
                                          { "grouping_item": [
                                              { "identifier": "d.contract_start_date" } ] },
                                          { ",": [] },
                                          { "grouping_item": [
                                              { "identifier": "d.contract_end_date" } ] } ] } ] } ] },
                              { ")": [] } ] },
                          { "as_alias": [
                              { "AS": [] },
                              { "identifier": "t" } ] } ] } ] } ] } ] },
          [
            { "node:sources:ops:alias": [
                { "query_expr": [
                    { "select": [
                        { "SELECT": [] },
                        { "select_list": [
                            { "_aliasable_expression": [
                                { "identifier": "d.deal_id" } ] },
                            { ",": [] },
                            { "_aliasable_expression": [
                                { "identifier": "d.account_id" } ] },
                            { ",": [] },
                            { "_aliasable_expression": [
                                { "identifier": "d.contract_start_date" } ] },
                            { ",": [] },
                            { "_aliasable_expression": [
                                { "identifier": "d.contract_end_date" } ] },
                            { ",": [] },
                            { "_aliasable_expression": [
                                { "binary_expression": [
                                    { "binary_expression": [
                                        { "function_call": [
                                            { "identifier": "julianday" },
                                            { "(": [] },
                                            { "argument": [
                                                { "identifier": "d.contract_end_date" } ] },
                                            { ")": [] } ] },
                                        { "-": [] },
                                        { "function_call": [
                                            { "identifier": "julianday" },
                                            { "(": [] },
                                            { "argument": [
                                                { "identifier": "d.contract_start_date" } ] },
                                            { ")": [] } ] } ] },
                                    { "+": [] },
                                    { "number": "1" } ] },
                                { "as_alias": [
                                    { "AS": [] },
                                    { "identifier": "contract_duration_days" } ] } ] },
                            { ",": [] },
                            { "_aliasable_expression": [
                                { "function_call": [
                                    { "identifier": "SUM" },
                                    { "(": [] },
                                    { "argument": [
                                        { "casewhen_expression": [
                                            { "CASE": [] },
                                            { "casewhen_clause": [
                                                { "WHEN_MATCHED": [] },
                                                { "binary_expression": [
                                                    { "identifier": "o.product" },
                                                    { "IN": [] },
                                                    { "struct": [
                                                        { "(": [] },
                                                        { "string": "'Subscription Base'" },
                                                        { ",": [] },
                                                        { "string": "'Subscription Premium'" },
                                                        { ")": [] } ] } ] },
                                                { "THEN": [] },
                                                { "identifier": "o.value" } ] },
                                            { "caseelse_clause": [
                                                { "ELSE": [] },
                                                { "number": "0" } ] },
                                            { "END_IF": [] } ] } ] },
                                    { ")": [] } ] },
                                { "as_alias": [
                                    { "AS": [] },
                                    { "identifier": "revenue_core" } ] } ] },
                            { ",": [] },
                            { "_aliasable_expression": [
                                { "function_call": [
                                    { "identifier": "SUM" },
                                    { "(": [] },
                                    { "argument": [
                                        { "casewhen_expression": [
                                            { "CASE": [] },
                                            { "casewhen_clause": [
                                                { "WHEN_MATCHED": [] },
                                                { "binary_expression": [
                                                    { "identifier": "o.product" },
                                                    { "IN": [] },
                                                    { "struct": [
                                                        { "(": [] },
                                                        { "string": "'Training'" },
                                                        { ",": [] },
                                                        { "string": "'Consulting'" },
                                                        { ")": [] } ] } ] },
                                                { "THEN": [] },
                                                { "identifier": "o.value" } ] },
                                            { "caseelse_clause": [
                                                { "ELSE": [] },
                                                { "number": "0" } ] },
                                            { "END_IF": [] } ] } ] },
                                    { ")": [] } ] },
                                { "as_alias": [
                                    { "AS": [] },
                                    { "identifier": "revenue_aux" } ] } ] },
                            { ",": [] },
                            { "_aliasable_expression": [
                                { "function_call": [
                                    { "identifier": "SUM" },
                                    { "(": [] },
                                    { "argument": [
                                        { "identifier": "o.value" } ] },
                                    { ")": [] } ] },
                                { "as_alias": [
                                    { "AS": [] },
                                    { "identifier": "revenue" } ] } ] } ] },
                        { "from_clause": [
                            { "FROM": [] },
                            { "from_item": [
                                { "join_operation": [
                                    { "from_item": [
                                        { "identifier": "orders" },
                                        { "as_alias": [
                                            { "identifier": "o" } ] } ] },
                                    { "JOIN": [] },
                                    { "from_item": [
                                        { "identifier": "deals" },
                                        { "as_alias": [
                                            { "identifier": "d" } ] } ] },
                                    { "join_condition": [
                                        { "USING": [] },
                                        { "(": [] },
                                        { "identifier": "deal_id" },
                                        { ",": [] },
                                        { "identifier": "order_id" },
                                        { ")": [] } ] } ] } ] } ] },
                        { "where_clause": [
                            { "WHERE": [] },
                            { "binary_expression": [
                                { "identifier": "d.stage" },
                                { "=": [] },
                                { "number": "4" } ] } ] },
                        { "group_by_clause": [
                            { "GROUP_BY": [] },
                            { "GROUP_BY": [] },
                            { "grouping_item": [
                                { "identifier": "d.deal_id" } ] },
                            { ",": [] },
                            { "grouping_item": [
                                { "identifier": "d.account_id" } ] },
                            { ",": [] },
                            { "grouping_item": [
                                { "identifier": "d.contract_start_date" } ] },
                            { ",": [] },
                            { "grouping_item": [
                                { "identifier": "d.contract_end_date" } ] } ] } ] } ] },
                [
                  { "node:dataset:table:alias": [
                      { "identifier": "orders" },
                      "None",
                      "orders",
                      "o" ] },
                  { "node:dataset:table:alias": [
                      { "identifier": "deals" },
                      "None",
                      "deals",
                      "d" ] } ],
                [
                  { "node:columns:alias": [
                      { "identifier": "d.deal_id" },
                      [
                        { "nodes:dataset:table:column": [
                            [
                              { "identifier": "d.deal_id" },
                              { "identifier": "d.deal_id" } ],
                            "None",
                            "deals",
                            "deal_id" ] } ],
                      "None" ] },
                  { "node:columns:alias": [
                      { "identifier": "d.account_id" },
                      [
                        { "nodes:dataset:table:column": [
                            [
                              { "identifier": "d.account_id" },
                              { "identifier": "d.account_id" } ],
                            "None",
                            "deals",
                            "account_id" ] } ],
                      "None" ] },
                  { "node:columns:alias": [
                      { "identifier": "d.contract_start_date" },
                      [
                        { "nodes:dataset:table:column": [
                            [
                              { "identifier": "d.contract_start_date" },
                              { "identifier": "d.contract_start_date" },
                              { "identifier": "d.contract_start_date" } ],
                            "None",
                            "deals",
                            "contract_start_date" ] } ],
                      "None" ] },
                  { "node:columns:alias": [
                      { "identifier": "d.contract_end_date" },
                      [
                        { "nodes:dataset:table:column": [
                            [
                              { "identifier": "d.contract_end_date" },
                              { "identifier": "d.contract_end_date" },
                              { "identifier": "d.contract_end_date" } ],
                            "None",
                            "deals",
                            "contract_end_date" ] } ],
                      "None" ] },
                  { "node:columns:alias": [
                      { "binary_expression": [
                          { "binary_expression": [
                              { "function_call": [
                                  { "identifier": "julianday" },
                                  { "(": [] },
                                  { "argument": [
                                      { "identifier": "d.contract_end_date" } ] },
                                  { ")": [] } ] },
                              { "-": [] },
                              { "function_call": [
                                  { "identifier": "julianday" },
                                  { "(": [] },
                                  { "argument": [
                                      { "identifier": "d.contract_start_date" } ] },
                                  { ")": [] } ] } ] },
                          { "+": [] },
                          { "number": "1" } ] },
                      [
                        { "nodes:dataset:table:column": [
                            [
                              { "identifier": "d.contract_end_date" },
                              { "identifier": "d.contract_end_date" },
                              { "identifier": "d.contract_end_date" } ],
                            "None",
                            "deals",
                            "contract_end_date" ] },
                        { "nodes:dataset:table:column": [
                            [
                              { "identifier": "d.contract_start_date" },
                              { "identifier": "d.contract_start_date" },
                              { "identifier": "d.contract_start_date" } ],
                            "None",
                            "deals",
                            "contract_start_date" ] } ],
                      "contract_duration_days" ] },
                  { "node:columns:alias": [
                      { "function_call": [
                          { "identifier": "SUM" },
                          { "(": [] },
                          { "argument": [
                              { "casewhen_expression": [
                                  { "CASE": [] },
                                  { "casewhen_clause": [
                                      { "WHEN_MATCHED": [] },
                                      { "binary_expression": [
                                          { "identifier": "o.product" },
                                          { "IN": [] },
                                          { "struct": [
                                              { "(": [] },
                                              { "string": "'Subscription Base'" },
                                              { ",": [] },
                                              { "string": "'Subscription Premium'" },
                                              { ")": [] } ] } ] },
                                      { "THEN": [] },
                                      { "identifier": "o.value" } ] },
                                  { "caseelse_clause": [
                                      { "ELSE": [] },
                                      { "number": "0" } ] },
                                  { "END_IF": [] } ] } ] },
                          { ")": [] } ] },
                      [
                        { "nodes:dataset:table:column": [
                            [
                              { "identifier": "o.product" },
                              { "identifier": "o.product" } ],
                            "None",
                            "orders",
                            "product" ] },
                        { "nodes:dataset:table:column": [
                            [
                              { "identifier": "o.value" },
                              { "identifier": "o.value" },
                              { "identifier": "o.value" } ],
                            "None",
                            "orders",
                            "value" ] } ],
                      "revenue_core" ] },
                  { "node:columns:alias": [
                      { "function_call": [
                          { "identifier": "SUM" },
                          { "(": [] },
                          { "argument": [
                              { "casewhen_expression": [
                                  { "CASE": [] },
                                  { "casewhen_clause": [
                                      { "WHEN_MATCHED": [] },
                                      { "binary_expression": [
                                          { "identifier": "o.product" },
                                          { "IN": [] },
                                          { "struct": [
                                              { "(": [] },
                                              { "string": "'Training'" },
                                              { ",": [] },
                                              { "string": "'Consulting'" },
                                              { ")": [] } ] } ] },
                                      { "THEN": [] },
                                      { "identifier": "o.value" } ] },
                                  { "caseelse_clause": [
                                      { "ELSE": [] },
                                      { "number": "0" } ] },
                                  { "END_IF": [] } ] } ] },
                          { ")": [] } ] },
                      [
                        { "nodes:dataset:table:column": [
                            [
                              { "identifier": "o.product" },
                              { "identifier": "o.product" } ],
                            "None",
                            "orders",
                            "product" ] },
                        { "nodes:dataset:table:column": [
                            [
                              { "identifier": "o.value" },
                              { "identifier": "o.value" },
                              { "identifier": "o.value" } ],
                            "None",
                            "orders",
                            "value" ] } ],
                      "revenue_aux" ] },
                  { "node:columns:alias": [
                      { "function_call": [
                          { "identifier": "SUM" },
                          { "(": [] },
                          { "argument": [
                              { "identifier": "o.value" } ] },
                          { ")": [] } ] },
                      [
                        { "nodes:dataset:table:column": [
                            [
                              { "identifier": "o.value" },
                              { "identifier": "o.value" },
                              { "identifier": "o.value" } ],
                            "None",
                            "orders",
                            "value" ] } ],
                      "revenue" ] },
                  { "node:columns:alias": [
                      { "identifier": "deal_id" },
                      [
                        { "nodes:dataset:table:column": [
                            [
                              { "identifier": "deal_id" } ],
                            "None",
                            "None",
                            "deal_id" ] },
                        { "nodes:dataset:table:column": [
                            [
                              { "identifier": "order_id" } ],
                            "None",
                            "None",
                            "order_id" ] } ],
                      "None" ] },
                  { "node:columns:alias": [
                      { "identifier": "order_id" },
                      [
                        { "nodes:dataset:table:column": [
                            [
                              { "identifier": "deal_id" } ],
                            "None",
                            "None",
                            "deal_id" ] },
                        { "nodes:dataset:table:column": [
                            [
                              { "identifier": "order_id" } ],
                            "None",
                            "None",
                            "order_id" ] } ],
                      "None" ] },
                  { "node:columns:alias": [
                      { "identifier": "d.deal_id" },
                      [
                        { "nodes:dataset:table:column": [
                            [
                              { "identifier": "d.deal_id" },
                              { "identifier": "d.deal_id" } ],
                            "None",
                            "deals",
                            "deal_id" ] } ],
                      "None" ] },
                  { "node:columns:alias": [
                      { "identifier": "d.account_id" },
                      [
                        { "nodes:dataset:table:column": [
                            [
                              { "identifier": "d.account_id" },
                              { "identifier": "d.account_id" } ],
                            "None",
                            "deals",
                            "account_id" ] } ],
                      "None" ] },
                  { "node:columns:alias": [
                      { "identifier": "d.contract_start_date" },
                      [
                        { "nodes:dataset:table:column": [
                            [
                              { "identifier": "d.contract_start_date" },
                              { "identifier": "d.contract_start_date" },
                              { "identifier": "d.contract_start_date" } ],
                            "None",
                            "deals",
                            "contract_start_date" ] } ],
                      "None" ] },
                  { "node:columns:alias": [
                      { "identifier": "d.contract_end_date" },
                      [
                        { "nodes:dataset:table:column": [
                            [
                              { "identifier": "d.contract_end_date" },
                              { "identifier": "d.contract_end_date" },
                              { "identifier": "d.contract_end_date" } ],
                            "None",
                            "deals",
                            "contract_end_date" ] } ],
                      "None" ] } ],
                "None" ] } ],
          [
            { "node:columns:alias": [
                { "binary_expression": [
                    { "identifier": "revenue" },
                    { "/": [] },
                    { "identifier": "contract_duration_days" } ] },
                [
                  { "nodes:dataset:table:column": [
                      [
                        { "identifier": "revenue" } ],
                      "None",
                      "None",
                      "revenue" ] },
                  { "nodes:dataset:table:column": [
                      [
                        { "identifier": "contract_duration_days" },
                        { "identifier": "contract_duration_days" },
                        { "identifier": "contract_duration_days" } ],
                      "None",
                      "None",
                      "contract_duration_days" ] } ],
                "revenue_day" ] },
            { "node:columns:alias": [
                { "binary_expression": [
                    { "identifier": "revenue_core" },
                    { "/": [] },
                    { "identifier": "contract_duration_days" } ] },
                [
                  { "nodes:dataset:table:column": [
                      [
                        { "identifier": "revenue_core" } ],
                      "None",
                      "None",
                      "revenue_core" ] },
                  { "nodes:dataset:table:column": [
                      [
                        { "identifier": "contract_duration_days" },
                        { "identifier": "contract_duration_days" },
                        { "identifier": "contract_duration_days" } ],
                      "None",
                      "None",
                      "contract_duration_days" ] } ],
                "revenue_core_day" ] },
            { "node:columns:alias": [
                { "binary_expression": [
                    { "identifier": "revenue_aux" },
                    { "/": [] },
                    { "identifier": "contract_duration_days" } ] },
                [
                  { "nodes:dataset:table:column": [
                      [
                        { "identifier": "revenue_aux" } ],
                      "None",
                      "None",
                      "revenue_aux" ] },
                  { "nodes:dataset:table:column": [
                      [
                        { "identifier": "contract_duration_days" },
                        { "identifier": "contract_duration_days" },
                        { "identifier": "contract_duration_days" } ],
                      "None",
                      "None",
                      "contract_duration_days" ] } ],
                "revenue_aux_day" ] } ],
          "None" ] },
      { "node:sources:ops:alias": [
          { "query_expr": [
              { "select": [
                  { "SELECT": [] },
                  { "select_list": [
                      { "_aliasable_expression": [
                          { "identifier": "t.date_month" } ] },
                      { ",": [] },
                      { "_aliasable_expression": [
                          { "identifier": "t.account_id" } ] },
                      { ",": [] },
                      { "_aliasable_expression": [
                          { "function_call": [
                              { "identifier": "AVG" },
                              { "(": [] },
                              { "argument": [
                                  { "identifier": "t.deals" } ] },
                              { ")": [] } ] },
                          { "as_alias": [
                              { "AS": [] },
                              { "identifier": "deals" } ] } ] },
                      { ",": [] },
                      { "_aliasable_expression": [
                          { "function_call": [
                              { "identifier": "SUM" },
                              { "(": [] },
                              { "argument": [
                                  { "identifier": "t.revenue_core" } ] },
                              { ")": [] } ] },
                          { "as_alias": [
                              { "AS": [] },
                              { "identifier": "revenue_core" } ] } ] },
                      { ",": [] },
                      { "_aliasable_expression": [
                          { "function_call": [
                              { "identifier": "SUM" },
                              { "(": [] },
                              { "argument": [
                                  { "identifier": "t.revenue_aux" } ] },
                              { ")": [] } ] },
                          { "as_alias": [
                              { "AS": [] },
                              { "identifier": "revenue_aux" } ] } ] },
                      { ",": [] },
                      { "_aliasable_expression": [
                          { "function_call": [
                              { "identifier": "SUM" },
                              { "(": [] },
                              { "argument": [
                                  { "identifier": "t.revenue" } ] },
                              { ")": [] } ] },
                          { "as_alias": [
                              { "AS": [] },
                              { "identifier": "revenue" } ] } ] } ] },
                  { "from_clause": [
                      { "FROM": [] },
                      { "from_item": [
                          { "select_subexpression": [
                              { "(": [] },
                              { "query_expr": [
                                  { "select": [
                                      { "SELECT": [] },
                                      { "select_list": [
                                          { "_aliasable_expression": [
                                              { "identifier": "dr.date_day" } ] },
                                          { ",": [] },
                                          { "_aliasable_expression": [
                                              { "function_call": [
                                                  { "identifier": "DATE" },
                                                  { "(": [] },
                                                  { "argument": [
                                                      { "identifier": "date_day" } ] },
                                                  { ",": [] },
                                                  { "argument": [
                                                      { "string": "'start of month'" } ] },
                                                  { ")": [] } ] },
                                              { "as_alias": [
                                                  { "AS": [] },
                                                  { "identifier": "date_month" } ] } ] },
                                          { ",": [] },
                                          { "_aliasable_expression": [
                                              { "identifier": "ds.account_id" } ] },
                                          { ",": [] },
                                          { "_aliasable_expression": [
                                              { "function_call": [
                                                  { "identifier": "COUNT" },
                                                  { "(": [] },
                                                  { "argument": [
                                                      { "identifier": "ds.deal_id" } ] },
                                                  { ")": [] } ] },
                                              { "as_alias": [
                                                  { "AS": [] },
                                                  { "identifier": "deals" } ] } ] },
                                          { ",": [] },
                                          { "_aliasable_expression": [
                                              { "function_call": [
                                                  { "identifier": "SUM" },
                                                  { "(": [] },
                                                  { "argument": [
                                                      { "identifier": "ds.revenue_core_day" } ] },
                                                  { ")": [] } ] },
                                              { "as_alias": [
                                                  { "AS": [] },
                                                  { "identifier": "revenue_core" } ] } ] },
                                          { ",": [] },
                                          { "_aliasable_expression": [
                                              { "function_call": [
                                                  { "identifier": "SUM" },
                                                  { "(": [] },
                                                  { "argument": [
                                                      { "identifier": "ds.revenue_aux_day" } ] },
                                                  { ")": [] } ] },
                                              { "as_alias": [
                                                  { "AS": [] },
                                                  { "identifier": "revenue_aux" } ] } ] },
                                          { ",": [] },
                                          { "_aliasable_expression": [
                                              { "function_call": [
                                                  { "identifier": "SUM" },
                                                  { "(": [] },
                                                  { "argument": [
                                                      { "identifier": "ds.revenue_day" } ] },
                                                  { ")": [] } ] },
                                              { "as_alias": [
                                                  { "AS": [] },
                                                  { "identifier": "revenue" } ] } ] } ] },
                                      { "from_clause": [
                                          { "FROM": [] },
                                          { "from_item": [
                                              { "join_operation": [
                                                  { "from_item": [
                                                      { "identifier": "date_ranges" },
                                                      { "as_alias": [
                                                          { "identifier": "dr" } ] } ] },
                                                  { "join_type": [
                                                      { "LEFT": [] } ] },
                                                  { "JOIN": [] },
                                                  { "from_item": [
                                                      { "identifier": "deals_signed" },
                                                      { "as_alias": [
                                                          { "identifier": "ds" } ] } ] },
                                                  { "join_condition": [
                                                      { "ON": [] },
                                                      { "binary_expression": [
                                                          { "binary_expression": [
                                                              { "identifier": "dr.date_day" },
                                                              { ">=": [] },
                                                              { "function_call": [
                                                                  { "identifier": "date" },
                                                                  { "(": [] },
                                                                  { "argument": [
                                                                      { "identifier": "ds.contract_start_date" } ] },
                                                                  { ")": [] } ] } ] },
                                                          { "AND": [] },
                                                          { "binary_expression": [
                                                              { "identifier": "dr.date_day" },
                                                              { "<=": [] },
                                                              { "function_call": [
                                                                  { "identifier": "date" },
                                                                  { "(": [] },
                                                                  { "argument": [
                                                                      { "identifier": "ds.contract_end_date" } ] },
                                                                  { ")": [] } ] } ] } ] } ] } ] } ] } ] },
                                      { "group_by_clause": [
                                          { "GROUP_BY": [] },
                                          { "GROUP_BY": [] },
                                          { "grouping_item": [
                                              { "identifier": "dr.date_day" } ] },
                                          { ",": [] },
                                          { "grouping_item": [
                                              { "identifier": "ds.account_id" } ] } ] } ] } ] },
                              { ")": [] } ] },
                          { "as_alias": [
                              { "identifier": "t" } ] } ] } ] },
                  { "group_by_clause": [
                      { "GROUP_BY": [] },
                      { "GROUP_BY": [] },
                      { "grouping_item": [
                          { "identifier": "account_id" } ] },
                      { ",": [] },
                      { "grouping_item": [
                          { "identifier": "date_month" } ] } ] } ] } ] },
          [
            { "node:sources:ops:alias": [
                { "query_expr": [
                    { "select": [
                        { "SELECT": [] },
                        { "select_list": [
                            { "_aliasable_expression": [
                                { "identifier": "dr.date_day" } ] },
                            { ",": [] },
                            { "_aliasable_expression": [
                                { "function_call": [
                                    { "identifier": "DATE" },
                                    { "(": [] },
                                    { "argument": [
                                        { "identifier": "date_day" } ] },
                                    { ",": [] },
                                    { "argument": [
                                        { "string": "'start of month'" } ] },
                                    { ")": [] } ] },
                                { "as_alias": [
                                    { "AS": [] },
                                    { "identifier": "date_month" } ] } ] },
                            { ",": [] },
                            { "_aliasable_expression": [
                                { "identifier": "ds.account_id" } ] },
                            { ",": [] },
                            { "_aliasable_expression": [
                                { "function_call": [
                                    { "identifier": "COUNT" },
                                    { "(": [] },
                                    { "argument": [
                                        { "identifier": "ds.deal_id" } ] },
                                    { ")": [] } ] },
                                { "as_alias": [
                                    { "AS": [] },
                                    { "identifier": "deals" } ] } ] },
                            { ",": [] },
                            { "_aliasable_expression": [
                                { "function_call": [
                                    { "identifier": "SUM" },
                                    { "(": [] },
                                    { "argument": [
                                        { "identifier": "ds.revenue_core_day" } ] },
                                    { ")": [] } ] },
                                { "as_alias": [
                                    { "AS": [] },
                                    { "identifier": "revenue_core" } ] } ] },
                            { ",": [] },
                            { "_aliasable_expression": [
                                { "function_call": [
                                    { "identifier": "SUM" },
                                    { "(": [] },
                                    { "argument": [
                                        { "identifier": "ds.revenue_aux_day" } ] },
                                    { ")": [] } ] },
                                { "as_alias": [
                                    { "AS": [] },
                                    { "identifier": "revenue_aux" } ] } ] },
                            { ",": [] },
                            { "_aliasable_expression": [
                                { "function_call": [
                                    { "identifier": "SUM" },
                                    { "(": [] },
                                    { "argument": [
                                        { "identifier": "ds.revenue_day" } ] },
                                    { ")": [] } ] },
                                { "as_alias": [
                                    { "AS": [] },
                                    { "identifier": "revenue" } ] } ] } ] },
                        { "from_clause": [
                            { "FROM": [] },
                            { "from_item": [
                                { "join_operation": [
                                    { "from_item": [
                                        { "identifier": "date_ranges" },
                                        { "as_alias": [
                                            { "identifier": "dr" } ] } ] },
                                    { "join_type": [
                                        { "LEFT": [] } ] },
                                    { "JOIN": [] },
                                    { "from_item": [
                                        { "identifier": "deals_signed" },
                                        { "as_alias": [
                                            { "identifier": "ds" } ] } ] },
                                    { "join_condition": [
                                        { "ON": [] },
                                        { "binary_expression": [
                                            { "binary_expression": [
                                                { "identifier": "dr.date_day" },
                                                { ">=": [] },
                                                { "function_call": [
                                                    { "identifier": "date" },
                                                    { "(": [] },
                                                    { "argument": [
                                                        { "identifier": "ds.contract_start_date" } ] },
                                                    { ")": [] } ] } ] },
                                            { "AND": [] },
                                            { "binary_expression": [
                                                { "identifier": "dr.date_day" },
                                                { "<=": [] },
                                                { "function_call": [
                                                    { "identifier": "date" },
                                                    { "(": [] },
                                                    { "argument": [
                                                        { "identifier": "ds.contract_end_date" } ] },
                                                    { ")": [] } ] } ] } ] } ] } ] } ] } ] },
                        { "group_by_clause": [
                            { "GROUP_BY": [] },
                            { "GROUP_BY": [] },
                            { "grouping_item": [
                                { "identifier": "dr.date_day" } ] },
                            { ",": [] },
                            { "grouping_item": [
                                { "identifier": "ds.account_id" } ] } ] } ] } ] },
                [
                  { "node:dataset:table:alias": [
                      { "identifier": "date_ranges" },
                      "None",
                      "date_ranges",
                      "dr" ] },
                  { "node:dataset:table:alias": [
                      { "identifier": "deals_signed" },
                      "None",
                      "deals_signed",
                      "ds" ] } ],
                [
                  { "node:columns:alias": [
                      { "identifier": "dr.date_day" },
                      [
                        { "nodes:dataset:table:column": [
                            [
                              { "identifier": "dr.date_day" },
                              { "identifier": "dr.date_day" },
                              { "identifier": "dr.date_day" },
                              { "identifier": "dr.date_day" } ],
                            "None",
                            "date_ranges",
                            "date_day" ] } ],
                      "None" ] },
                  { "node:columns:alias": [
                      { "function_call": [
                          { "identifier": "DATE" },
                          { "(": [] },
                          { "argument": [
                              { "identifier": "date_day" } ] },
                          { ",": [] },
                          { "argument": [
                              { "string": "'start of month'" } ] },
                          { ")": [] } ] },
                      [
                        { "nodes:dataset:table:column": [
                            [
                              { "identifier": "date_day" } ],
                            "None",
                            "None",
                            "date_day" ] } ],
                      "date_month" ] },
                  { "node:columns:alias": [
                      { "identifier": "ds.account_id" },
                      [
                        { "nodes:dataset:table:column": [
                            [
                              { "identifier": "ds.account_id" },
                              { "identifier": "ds.account_id" } ],
                            "None",
                            "deals_signed",
                            "account_id" ] } ],
                      "None" ] },
                  { "node:columns:alias": [
                      { "function_call": [
                          { "identifier": "COUNT" },
                          { "(": [] },
                          { "argument": [
                              { "identifier": "ds.deal_id" } ] },
                          { ")": [] } ] },
                      [
                        { "nodes:dataset:table:column": [
                            [
                              { "identifier": "ds.deal_id" } ],
                            "None",
                            "deals_signed",
                            "deal_id" ] } ],
                      "deals" ] },
                  { "node:columns:alias": [
                      { "function_call": [
                          { "identifier": "SUM" },
                          { "(": [] },
                          { "argument": [
                              { "identifier": "ds.revenue_core_day" } ] },
                          { ")": [] } ] },
                      [
                        { "nodes:dataset:table:column": [
                            [
                              { "identifier": "ds.revenue_core_day" } ],
                            "None",
                            "deals_signed",
                            "revenue_core_day" ] } ],
                      "revenue_core" ] },
                  { "node:columns:alias": [
                      { "function_call": [
                          { "identifier": "SUM" },
                          { "(": [] },
                          { "argument": [
                              { "identifier": "ds.revenue_aux_day" } ] },
                          { ")": [] } ] },
                      [
                        { "nodes:dataset:table:column": [
                            [
                              { "identifier": "ds.revenue_aux_day" } ],
                            "None",
                            "deals_signed",
                            "revenue_aux_day" ] } ],
                      "revenue_aux" ] },
                  { "node:columns:alias": [
                      { "function_call": [
                          { "identifier": "SUM" },
                          { "(": [] },
                          { "argument": [
                              { "identifier": "ds.revenue_day" } ] },
                          { ")": [] } ] },
                      [
                        { "nodes:dataset:table:column": [
                            [
                              { "identifier": "ds.revenue_day" } ],
                            "None",
                            "deals_signed",
                            "revenue_day" ] } ],
                      "revenue" ] },
                  { "node:columns:alias": [
                      { "binary_expression": [
                          { "binary_expression": [
                              { "identifier": "dr.date_day" },
                              { ">=": [] },
                              { "function_call": [
                                  { "identifier": "date" },
                                  { "(": [] },
                                  { "argument": [
                                      { "identifier": "ds.contract_start_date" } ] },
                                  { ")": [] } ] } ] },
                          { "AND": [] },
                          { "binary_expression": [
                              { "identifier": "dr.date_day" },
                              { "<=": [] },
                              { "function_call": [
                                  { "identifier": "date" },
                                  { "(": [] },
                                  { "argument": [
                                      { "identifier": "ds.contract_end_date" } ] },
                                  { ")": [] } ] } ] } ] },
                      [
                        { "nodes:dataset:table:column": [
                            [
                              { "identifier": "dr.date_day" },
                              { "identifier": "dr.date_day" },
                              { "identifier": "dr.date_day" },
                              { "identifier": "dr.date_day" } ],
                            "None",
                            "date_ranges",
                            "date_day" ] },
                        { "nodes:dataset:table:column": [
                            [
                              { "identifier": "ds.contract_start_date" } ],
                            "None",
                            "deals_signed",
                            "contract_start_date" ] },
                        { "nodes:dataset:table:column": [
                            [
                              { "identifier": "ds.contract_end_date" } ],
                            "None",
                            "deals_signed",
                            "contract_end_date" ] } ],
                      "None" ] },
                  { "node:columns:alias": [
                      { "identifier": "dr.date_day" },
                      [
                        { "nodes:dataset:table:column": [
                            [
                              { "identifier": "dr.date_day" },
                              { "identifier": "dr.date_day" },
                              { "identifier": "dr.date_day" },
                              { "identifier": "dr.date_day" } ],
                            "None",
                            "date_ranges",
                            "date_day" ] } ],
                      "None" ] },
                  { "node:columns:alias": [
                      { "identifier": "ds.account_id" },
                      [
                        { "nodes:dataset:table:column": [
                            [
                              { "identifier": "ds.account_id" },
                              { "identifier": "ds.account_id" } ],
                            "None",
                            "deals_signed",
                            "account_id" ] } ],
                      "None" ] } ],
                "None" ] } ],
          [
            { "node:columns:alias": [
                { "identifier": "t.date_month" },
                [
                  { "nodes:dataset:table:column": [
                      [
                        { "identifier": "t.date_month" } ],
                      "None",
                      "t",
                      "date_month" ] } ],
                "None" ] },
            { "node:columns:alias": [
                { "identifier": "t.account_id" },
                [
                  { "nodes:dataset:table:column": [
                      [
                        { "identifier": "t.account_id" } ],
                      "None",
                      "t",
                      "account_id" ] } ],
                "None" ] },
            { "node:columns:alias": [
                { "function_call": [
                    { "identifier": "AVG" },
                    { "(": [] },
                    { "argument": [
                        { "identifier": "t.deals" } ] },
                    { ")": [] } ] },
                [
                  { "nodes:dataset:table:column": [
                      [
                        { "identifier": "t.deals" } ],
                      "None",
                      "t",
                      "deals" ] } ],
                "deals" ] },
            { "node:columns:alias": [
                { "function_call": [
                    { "identifier": "SUM" },
                    { "(": [] },
                    { "argument": [
                        { "identifier": "t.revenue_core" } ] },
                    { ")": [] } ] },
                [
                  { "nodes:dataset:table:column": [
                      [
                        { "identifier": "t.revenue_core" } ],
                      "None",
                      "t",
                      "revenue_core" ] } ],
                "revenue_core" ] },
            { "node:columns:alias": [
                { "function_call": [
                    { "identifier": "SUM" },
                    { "(": [] },
                    { "argument": [
                        { "identifier": "t.revenue_aux" } ] },
                    { ")": [] } ] },
                [
                  { "nodes:dataset:table:column": [
                      [
                        { "identifier": "t.revenue_aux" } ],
                      "None",
                      "t",
                      "revenue_aux" ] } ],
                "revenue_aux" ] },
            { "node:columns:alias": [
                { "function_call": [
                    { "identifier": "SUM" },
                    { "(": [] },
                    { "argument": [
                        { "identifier": "t.revenue" } ] },
                    { ")": [] } ] },
                [
                  { "nodes:dataset:table:column": [
                      [
                        { "identifier": "t.revenue" } ],
                      "None",
                      "t",
                      "revenue" ] } ],
                "revenue" ] },
            { "node:columns:alias": [
                { "identifier": "account_id" },
                [
                  { "nodes:dataset:table:column": [
                      [
                        { "identifier": "account_id" } ],
                      "None",
                      "None",
                      "account_id" ] } ],
                "None" ] },
            { "node:columns:alias": [
                { "identifier": "date_month" },
                [
                  { "nodes:dataset:table:column": [
                      [
                        { "identifier": "date_month" } ],
                      "None",
                      "None",
                      "date_month" ] } ],
                "None" ] } ],
          "None" ] },
      { "node:sources:ops:alias": [
          { "query_expr": [
              { "select": [
                  { "SELECT": [] },
                  { "select_list": [
                      { "select_all": [
                          { "asterisk_expression": [
                              { ".": [] },
                              { "*": [] } ] } ] },
                      { ",": [] },
                      { "_aliasable_expression": [
                          { "casewhen_expression": [
                              { "CASE": [] },
                              { "casewhen_clause": [
                                  { "WHEN_MATCHED": [] },
                                  { "binary_expression": [
                                      { "identifier": "t.revenue_12m" },
                                      { "<=": [] },
                                      { "number": "300" } ] },
                                  { "THEN": [] },
                                  { "string": "'Small'" } ] },
                              { "casewhen_clause": [
                                  { "WHEN_MATCHED": [] },
                                  { "binary_expression": [
                                      { "binary_expression": [
                                          { "identifier": "t.revenue_12m" },
                                          { ">": [] },
                                          { "number": "300" } ] },
                                      { "AND": [] },
                                      { "binary_expression": [
                                          { "identifier": "t.revenue_12m" },
                                          { "<=": [] },
                                          { "number": "600" } ] } ] },
                                  { "THEN": [] },
                                  { "string": "'Medium'" } ] },
                              { "casewhen_clause": [
                                  { "WHEN_MATCHED": [] },
                                  { "binary_expression": [
                                      { "identifier": "t.revenue_12m" },
                                      { ">": [] },
                                      { "number": "600" } ] },
                                  { "THEN": [] },
                                  { "string": "'Large'" } ] },
                              { "caseelse_clause": [
                                  { "ELSE": [] },
                                  { "NULL": [
                                      { "NOT_NULL": [] } ] } ] },
                              { "END_IF": [] } ] },
                          { "as_alias": [
                              { "AS": [] },
                              { "identifier": "account_size" } ] } ] } ] },
                  { "from_clause": [
                      { "FROM": [] },
                      { "from_item": [
                          { "select_subexpression": [
                              { "(": [] },
                              { "query_expr": [
                                  { "select": [
                                      { "SELECT": [] },
                                      { "select_list": [
                                          { "_aliasable_expression": [
                                              { "identifier": "account_id" } ] },
                                          { ",": [] },
                                          { "_aliasable_expression": [
                                              { "identifier": "date_month" } ] },
                                          { ",": [] },
                                          { "_aliasable_expression": [
                                              { "identifier": "revenue" } ] },
                                          { ",": [] },
                                          { "_aliasable_expression": [
                                              { "identifier": "revenue_core" } ] },
                                          { ",": [] },
                                          { "_aliasable_expression": [
                                              { "identifier": "revenue_aux" } ] },
                                          { ",": [] },
                                          { "_aliasable_expression": [
                                              { "identifier": "deals" } ] },
                                          { ",": [] },
                                          { "_aliasable_expression": [
                                              { "identifier": "accounts.name" } ] },
                                          { ",": [] },
                                          { "_aliasable_expression": [
                                              { "identifier": "accounts.industry" } ] },
                                          { ",": [] },
                                          { "_aliasable_expression": [
                                              { "identifier": "accounts.country" } ] },
                                          { ",": [] },
                                          { "_aliasable_expression": [
                                              { "casewhen_expression": [
                                                  { "CASE": [] },
                                                  { "casewhen_clause": [
                                                      { "WHEN_MATCHED": [] },
                                                      { "binary_expression": [
                                                          { "identifier": "c.region" },
                                                          { "IN": [] },
                                                          { "struct": [
                                                              { "(": [] },
                                                              { "string": "'Americas'" },
                                                              { ",": [] },
                                                              { "string": "'Europe'" },
                                                              { ")": [] } ] } ] },
                                                      { "THEN": [] },
                                                      { "string": "'North-West'" } ] },
                                                  { "casewhen_clause": [
                                                      { "WHEN_MATCHED": [] },
                                                      { "binary_expression": [
                                                          { "identifier": "c.region" },
                                                          { "IN": [] },
                                                          { "struct": [
                                                              { "(": [] },
                                                              { "string": "'Africa'" },
                                                              { ",": [] },
                                                              { "string": "'Asia'" },
                                                              { ")": [] } ] } ] },
                                                      { "THEN": [] },
                                                      { "string": "'South-East'" } ] },
                                                  { "caseelse_clause": [
                                                      { "ELSE": [] },
                                                      { "NULL": [
                                                          { "NOT_NULL": [] } ] } ] },
                                                  { "END_IF": [] } ] },
                                              { "as_alias": [
                                                  { "AS": [] },
                                                  { "identifier": "region_cluster" } ] } ] },
                                          { ",": [] },
                                          { "_aliasable_expression": [
                                              { "identifier": "accounts.priority" } ] },
                                          { ",": [] },
                                          { "_aliasable_expression": [
                                              { "function_call": [
                                                  { "identifier": "SUM" },
                                                  { "(": [] },
                                                  { "argument": [
                                                      { "identifier": "revenue" } ] },
                                                  { ")": [] },
                                                  { "analytics_clause": [
                                                      { "OVER": [] },
                                                      { "over_clause": [
                                                          { "window_specification": [
                                                              { "(": [] },
                                                              { "window_partition_clause": [
                                                                  { "PARTITION_COLUMNS": [] },
                                                                  { "GROUP_BY": [] },
                                                                  { "_expression": [
                                                                      { "identifier": "account_id" } ] } ] },
                                                              { "order_by_clause": [
                                                                  { "ORDER_BY": [] },
                                                                  { "GROUP_BY": [] },
                                                                  { "order_by_clause_body": [
                                                                      { "identifier": "date_month" } ] } ] },
                                                              { "window_frame_clause": [
                                                                  { "rows_range": [
                                                                      { "ROWS": [] } ] },
                                                                  { "window_frame_between": [
                                                                      { "BETWEEN": [] },
                                                                      { "window_numeric_preceding": [
                                                                          { "number": "11" },
                                                                          { "PRECEDING": [] } ] },
                                                                      { "AND": [] },
                                                                      { "between_to": [
                                                                          { "keyword_current_row": [
                                                                              { "CURRENT_ROW": [] },
                                                                              { "ROW": [] } ] } ] } ] } ] },
                                                              { ")": [] } ] } ] } ] } ] },
                                              { "as_alias": [
                                                  { "AS": [] },
                                                  { "identifier": "revenue_12m" } ] } ] } ] },
                                      { "from_clause": [
                                          { "FROM": [] },
                                          { "from_item": [
                                              { "join_operation": [
                                                  { "from_item": [
                                                      { "join_operation": [
                                                          { "from_item": [
                                                              { "identifier": "accounts_revenue" } ] },
                                                          { "join_type": [
                                                              { "LEFT": [] } ] },
                                                          { "JOIN": [] },
                                                          { "from_item": [
                                                              { "identifier": "accounts" } ] },
                                                          { "join_condition": [
                                                              { "USING": [] },
                                                              { "(": [] },
                                                              { "identifier": "account_id" },
                                                              { ")": [] } ] } ] } ] },
                                                  { "join_type": [
                                                      { "LEFT": [] } ] },
                                                  { "JOIN": [] },
                                                  { "from_item": [
                                                      { "identifier": "countries" },
                                                      { "as_alias": [
                                                          { "identifier": "c" } ] } ] },
                                                  { "join_condition": [
                                                      { "USING": [] },
                                                      { "(": [] },
                                                      { "identifier": "country" },
                                                      { ")": [] } ] } ] } ] } ] } ] } ] },
                              { ")": [] } ] },
                          { "as_alias": [
                              { "AS": [] },
                              { "identifier": "t" } ] } ] } ] } ] } ] },
          [
            { "node:sources:ops:alias": [
                { "query_expr": [
                    { "select": [
                        { "SELECT": [] },
                        { "select_list": [
                            { "_aliasable_expression": [
                                { "identifier": "account_id" } ] },
                            { ",": [] },
                            { "_aliasable_expression": [
                                { "identifier": "date_month" } ] },
                            { ",": [] },
                            { "_aliasable_expression": [
                                { "identifier": "revenue" } ] },
                            { ",": [] },
                            { "_aliasable_expression": [
                                { "identifier": "revenue_core" } ] },
                            { ",": [] },
                            { "_aliasable_expression": [
                                { "identifier": "revenue_aux" } ] },
                            { ",": [] },
                            { "_aliasable_expression": [
                                { "identifier": "deals" } ] },
                            { ",": [] },
                            { "_aliasable_expression": [
                                { "identifier": "accounts.name" } ] },
                            { ",": [] },
                            { "_aliasable_expression": [
                                { "identifier": "accounts.industry" } ] },
                            { ",": [] },
                            { "_aliasable_expression": [
                                { "identifier": "accounts.country" } ] },
                            { ",": [] },
                            { "_aliasable_expression": [
                                { "casewhen_expression": [
                                    { "CASE": [] },
                                    { "casewhen_clause": [
                                        { "WHEN_MATCHED": [] },
                                        { "binary_expression": [
                                            { "identifier": "c.region" },
                                            { "IN": [] },
                                            { "struct": [
                                                { "(": [] },
                                                { "string": "'Americas'" },
                                                { ",": [] },
                                                { "string": "'Europe'" },
                                                { ")": [] } ] } ] },
                                        { "THEN": [] },
                                        { "string": "'North-West'" } ] },
                                    { "casewhen_clause": [
                                        { "WHEN_MATCHED": [] },
                                        { "binary_expression": [
                                            { "identifier": "c.region" },
                                            { "IN": [] },
                                            { "struct": [
                                                { "(": [] },
                                                { "string": "'Africa'" },
                                                { ",": [] },
                                                { "string": "'Asia'" },
                                                { ")": [] } ] } ] },
                                        { "THEN": [] },
                                        { "string": "'South-East'" } ] },
                                    { "caseelse_clause": [
                                        { "ELSE": [] },
                                        { "NULL": [
                                            { "NOT_NULL": [] } ] } ] },
                                    { "END_IF": [] } ] },
                                { "as_alias": [
                                    { "AS": [] },
                                    { "identifier": "region_cluster" } ] } ] },
                            { ",": [] },
                            { "_aliasable_expression": [
                                { "identifier": "accounts.priority" } ] },
                            { ",": [] },
                            { "_aliasable_expression": [
                                { "function_call": [
                                    { "identifier": "SUM" },
                                    { "(": [] },
                                    { "argument": [
                                        { "identifier": "revenue" } ] },
                                    { ")": [] },
                                    { "analytics_clause": [
                                        { "OVER": [] },
                                        { "over_clause": [
                                            { "window_specification": [
                                                { "(": [] },
                                                { "window_partition_clause": [
                                                    { "PARTITION_COLUMNS": [] },
                                                    { "GROUP_BY": [] },
                                                    { "_expression": [
                                                        { "identifier": "account_id" } ] } ] },
                                                { "order_by_clause": [
                                                    { "ORDER_BY": [] },
                                                    { "GROUP_BY": [] },
                                                    { "order_by_clause_body": [
                                                        { "identifier": "date_month" } ] } ] },
                                                { "window_frame_clause": [
                                                    { "rows_range": [
                                                        { "ROWS": [] } ] },
                                                    { "window_frame_between": [
                                                        { "BETWEEN": [] },
                                                        { "window_numeric_preceding": [
                                                            { "number": "11" },
                                                            { "PRECEDING": [] } ] },
                                                        { "AND": [] },
                                                        { "between_to": [
                                                            { "keyword_current_row": [
                                                                { "CURRENT_ROW": [] },
                                                                { "ROW": [] } ] } ] } ] } ] },
                                                { ")": [] } ] } ] } ] } ] },
                                { "as_alias": [
                                    { "AS": [] },
                                    { "identifier": "revenue_12m" } ] } ] } ] },
                        { "from_clause": [
                            { "FROM": [] },
                            { "from_item": [
                                { "join_operation": [
                                    { "from_item": [
                                        { "join_operation": [
                                            { "from_item": [
                                                { "identifier": "accounts_revenue" } ] },
                                            { "join_type": [
                                                { "LEFT": [] } ] },
                                            { "JOIN": [] },
                                            { "from_item": [
                                                { "identifier": "accounts" } ] },
                                            { "join_condition": [
                                                { "USING": [] },
                                                { "(": [] },
                                                { "identifier": "account_id" },
                                                { ")": [] } ] } ] } ] },
                                    { "join_type": [
                                        { "LEFT": [] } ] },
                                    { "JOIN": [] },
                                    { "from_item": [
                                        { "identifier": "countries" },
                                        { "as_alias": [
                                            { "identifier": "c" } ] } ] },
                                    { "join_condition": [
                                        { "USING": [] },
                                        { "(": [] },
                                        { "identifier": "country" },
                                        { ")": [] } ] } ] } ] } ] } ] } ] },
                [
                  { "node:dataset:table:alias": [
                      { "identifier": "accounts_revenue" },
                      "None",
                      "accounts_revenue",
                      "None" ] },
                  { "node:dataset:table:alias": [
                      { "identifier": "accounts" },
                      "None",
                      "accounts",
                      "None" ] },
                  { "node:dataset:table:alias": [
                      { "identifier": "countries" },
                      "None",
                      "countries",
                      "c" ] } ],
                [
                  { "node:columns:alias": [
                      { "identifier": "account_id" },
                      [
                        { "nodes:dataset:table:column": [
                            [
                              { "identifier": "account_id" },
                              { "identifier": "account_id" },
                              { "identifier": "account_id" } ],
                            "None",
                            "accounts",
                            "account_id" ] } ],
                      "None" ] },
                  { "node:columns:alias": [
                      { "identifier": "date_month" },
                      [
                        { "nodes:dataset:table:column": [
                            [
                              { "identifier": "date_month" },
                              { "identifier": "date_month" } ],
                            "None",
                            "accounts",
                            "date_month" ] } ],
                      "None" ] },
                  { "node:columns:alias": [
                      { "identifier": "revenue" },
                      [
                        { "nodes:dataset:table:column": [
                            [
                              { "identifier": "revenue" },
                              { "identifier": "revenue" } ],
                            "None",
                            "accounts",
                            "revenue" ] } ],
                      "None" ] },
                  { "node:columns:alias": [
                      { "identifier": "revenue_core" },
                      [
                        { "nodes:dataset:table:column": [
                            [
                              { "identifier": "revenue_core" } ],
                            "None",
                            "accounts",
                            "revenue_core" ] } ],
                      "None" ] },
                  { "node:columns:alias": [
                      { "identifier": "revenue_aux" },
                      [
                        { "nodes:dataset:table:column": [
                            [
                              { "identifier": "revenue_aux" } ],
                            "None",
                            "accounts",
                            "revenue_aux" ] } ],
                      "None" ] },
                  { "node:columns:alias": [
                      { "identifier": "deals" },
                      [
                        { "nodes:dataset:table:column": [
                            [
                              { "identifier": "deals" } ],
                            "None",
                            "accounts",
                            "deals" ] } ],
                      "None" ] },
                  { "node:columns:alias": [
                      { "identifier": "accounts.name" },
                      [
                        { "nodes:dataset:table:column": [
                            [
                              { "identifier": "accounts.name" } ],
                            "None",
                            "accounts",
                            "name" ] } ],
                      "None" ] },
                  { "node:columns:alias": [
                      { "identifier": "accounts.industry" },
                      [
                        { "nodes:dataset:table:column": [
                            [
                              { "identifier": "accounts.industry" } ],
                            "None",
                            "accounts",
                            "industry" ] } ],
                      "None" ] },
                  { "node:columns:alias": [
                      { "identifier": "accounts.country" },
                      [
                        { "nodes:dataset:table:column": [
                            [
                              { "identifier": "accounts.country" },
                              { "identifier": "country" } ],
                            "None",
                            "accounts",
                            "country" ] } ],
                      "None" ] },
                  { "node:columns:alias": [
                      { "casewhen_expression": [
                          { "CASE": [] },
                          { "casewhen_clause": [
                              { "WHEN_MATCHED": [] },
                              { "binary_expression": [
                                  { "identifier": "c.region" },
                                  { "IN": [] },
                                  { "struct": [
                                      { "(": [] },
                                      { "string": "'Americas'" },
                                      { ",": [] },
                                      { "string": "'Europe'" },
                                      { ")": [] } ] } ] },
                              { "THEN": [] },
                              { "string": "'North-West'" } ] },
                          { "casewhen_clause": [
                              { "WHEN_MATCHED": [] },
                              { "binary_expression": [
                                  { "identifier": "c.region" },
                                  { "IN": [] },
                                  { "struct": [
                                      { "(": [] },
                                      { "string": "'Africa'" },
                                      { ",": [] },
                                      { "string": "'Asia'" },
                                      { ")": [] } ] } ] },
                              { "THEN": [] },
                              { "string": "'South-East'" } ] },
                          { "caseelse_clause": [
                              { "ELSE": [] },
                              { "NULL": [
                                  { "NOT_NULL": [] } ] } ] },
                          { "END_IF": [] } ] },
                      [
                        { "nodes:dataset:table:column": [
                            [
                              { "identifier": "c.region" },
                              { "identifier": "c.region" } ],
                            "None",
                            "countries",
                            "region" ] } ],
                      "region_cluster" ] },
                  { "node:columns:alias": [
                      { "identifier": "accounts.priority" },
                      [
                        { "nodes:dataset:table:column": [
                            [
                              { "identifier": "accounts.priority" } ],
                            "None",
                            "accounts",
                            "priority" ] } ],
                      "None" ] },
                  { "node:columns:alias": [
                      { "function_call": [
                          { "identifier": "SUM" },
                          { "(": [] },
                          { "argument": [
                              { "identifier": "revenue" } ] },
                          { ")": [] },
                          { "analytics_clause": [
                              { "OVER": [] },
                              { "over_clause": [
                                  { "window_specification": [
                                      { "(": [] },
                                      { "window_partition_clause": [
                                          { "PARTITION_COLUMNS": [] },
                                          { "GROUP_BY": [] },
                                          { "_expression": [
                                              { "identifier": "account_id" } ] } ] },
                                      { "order_by_clause": [
                                          { "ORDER_BY": [] },
                                          { "GROUP_BY": [] },
                                          { "order_by_clause_body": [
                                              { "identifier": "date_month" } ] } ] },
                                      { "window_frame_clause": [
                                          { "rows_range": [
                                              { "ROWS": [] } ] },
                                          { "window_frame_between": [
                                              { "BETWEEN": [] },
                                              { "window_numeric_preceding": [
                                                  { "number": "11" },
                                                  { "PRECEDING": [] } ] },
                                              { "AND": [] },
                                              { "between_to": [
                                                  { "keyword_current_row": [
                                                      { "CURRENT_ROW": [] },
                                                      { "ROW": [] } ] } ] } ] } ] },
                                      { ")": [] } ] } ] } ] } ] },
                      [
                        { "nodes:dataset:table:column": [
                            [
                              { "identifier": "revenue" },
                              { "identifier": "revenue" } ],
                            "None",
                            "accounts",
                            "revenue" ] },
                        { "nodes:dataset:table:column": [
                            [
                              { "identifier": "account_id" },
                              { "identifier": "account_id" },
                              { "identifier": "account_id" } ],
                            "None",
                            "accounts",
                            "account_id" ] },
                        { "nodes:dataset:table:column": [
                            [
                              { "identifier": "date_month" },
                              { "identifier": "date_month" } ],
                            "None",
                            "accounts",
                            "date_month" ] } ],
                      "revenue_12m" ] },
                  { "node:columns:alias": [
                      { "identifier": "date_month" },
                      [
                        { "nodes:dataset:table:column": [
                            [
                              { "identifier": "date_month" },
                              { "identifier": "date_month" } ],
                            "None",
                            "accounts",
                            "date_month" ] } ],
                      "None" ] },
                  { "node:columns:alias": [
                      { "identifier": "account_id" },
                      [
                        { "nodes:dataset:table:column": [
                            [
                              { "identifier": "account_id" },
                              { "identifier": "account_id" },
                              { "identifier": "account_id" } ],
                            "None",
                            "accounts",
                            "account_id" ] } ],
                      "None" ] },
                  { "node:columns:alias": [
                      { "identifier": "country" },
                      [
                        { "nodes:dataset:table:column": [
                            [
                              { "identifier": "accounts.country" },
                              { "identifier": "country" } ],
                            "None",
                            "accounts",
                            "country" ] } ],
                      "None" ] } ],
                "None" ] } ],
          [
            { "node:columns:alias": [
                { "casewhen_expression": [
                    { "CASE": [] },
                    { "casewhen_clause": [
                        { "WHEN_MATCHED": [] },
                        { "binary_expression": [
                            { "identifier": "t.revenue_12m" },
                            { "<=": [] },
                            { "number": "300" } ] },
                        { "THEN": [] },
                        { "string": "'Small'" } ] },
                    { "casewhen_clause": [
                        { "WHEN_MATCHED": [] },
                        { "binary_expression": [
                            { "binary_expression": [
                                { "identifier": "t.revenue_12m" },
                                { ">": [] },
                                { "number": "300" } ] },
                            { "AND": [] },
                            { "binary_expression": [
                                { "identifier": "t.revenue_12m" },
                                { "<=": [] },
                                { "number": "600" } ] } ] },
                        { "THEN": [] },
                        { "string": "'Medium'" } ] },
                    { "casewhen_clause": [
                        { "WHEN_MATCHED": [] },
                        { "binary_expression": [
                            { "identifier": "t.revenue_12m" },
                            { ">": [] },
                            { "number": "600" } ] },
                        { "THEN": [] },
                        { "string": "'Large'" } ] },
                    { "caseelse_clause": [
                        { "ELSE": [] },
                        { "NULL": [
                            { "NOT_NULL": [] } ] } ] },
                    { "END_IF": [] } ] },
                [
                  { "nodes:dataset:table:column": [
                      [
                        { "identifier": "t.revenue_12m" },
                        { "identifier": "t.revenue_12m" },
                        { "identifier": "t.revenue_12m" },
                        { "identifier": "t.revenue_12m" } ],
                      "None",
                      "t",
                      "revenue_12m" ] } ],
                "account_size" ] } ],
          "None" ] },
      { "node:sources:ops:alias": [
          { "query_expr": [
              { "select": [
                  { "SELECT": [] },
                  { "select_list": [
                      { "_aliasable_expression": [
                          { "function_call": [
                              { "identifier": "date" },
                              { "(": [] },
                              { "argument": [
                                  { "identifier": "date_month" } ] },
                              { ",": [] },
                              { "argument": [
                                  { "string": "'start of year'" } ] },
                              { ")": [] } ] },
                          { "as_alias": [
                              { "AS": [] },
                              { "identifier": "date_year" } ] } ] },
                      { ",": [] },
                      { "_aliasable_expression": [
                          { "casewhen_expression": [
                              { "CASE": [] },
                              { "casewhen_clause": [
                                  { "WHEN_MATCHED": [] },
                                  { "binary_expression": [
                                      { "identifier": "c.region" },
                                      { "IN": [] },
                                      { "struct": [
                                          { "(": [] },
                                          { "string": "'Americas'" },
                                          { ",": [] },
                                          { "string": "'Europe'" },
                                          { ")": [] } ] } ] },
                                  { "THEN": [] },
                                  { "string": "'North-West'" } ] },
                              { "casewhen_clause": [
                                  { "WHEN_MATCHED": [] },
                                  { "binary_expression": [
                                      { "identifier": "c.region" },
                                      { "IN": [] },
                                      { "struct": [
                                          { "(": [] },
                                          { "string": "'Africa'" },
                                          { ",": [] },
                                          { "string": "'Asia'" },
                                          { ")": [] } ] } ] },
                                  { "THEN": [] },
                                  { "string": "'South-East'" } ] },
                              { "caseelse_clause": [
                                  { "ELSE": [] },
                                  { "NULL": [
                                      { "NOT_NULL": [] } ] } ] },
                              { "END_IF": [] } ] },
                          { "as_alias": [
                              { "AS": [] },
                              { "identifier": "region_cluster" } ] } ] },
                      { ",": [] },
                      { "_aliasable_expression": [
                          { "casewhen_expression": [
                              { "CASE": [] },
                              { "casewhen_clause": [
                                  { "WHEN_MATCHED": [] },
                                  { "binary_expression": [
                                      { "identifier": "a.industry" },
                                      { "=": [] },
                                      { "string": "'Information Technology'" } ] },
                                  { "THEN": [] },
                                  { "string": "'Tech'" } ] },
                              { "casewhen_clause": [
                                  { "WHEN_MATCHED": [] },
                                  { "unary_expression": [
                                      { "identifier": "a.industry" },
                                      { "IS": [] },
                                      { "NULL": [
                                          { "NOT_NULL": [] } ] } ] },
                                  { "THEN": [] },
                                  { "NULL": [
                                      { "NOT_NULL": [] } ] } ] },
                              { "caseelse_clause": [
                                  { "ELSE": [] },
                                  { "string": "'Other'" } ] },
                              { "END_IF": [] } ] },
                          { "as_alias": [
                              { "AS": [] },
                              { "identifier": "industry_cluster" } ] } ] },
                      { ",": [] },
                      { "_aliasable_expression": [
                          { "identifier": "a360.account_size" } ] },
                      { ",": [] },
                      { "_aliasable_expression": [
                          { "function_call": [
                              { "identifier": "SUM" },
                              { "(": [] },
                              { "argument": [
                                  { "identifier": "ar.revenue" } ] },
                              { ")": [] } ] },
                          { "as_alias": [
                              { "AS": [] },
                              { "identifier": "revenue" } ] } ] },
                      { ",": [] },
                      { "_aliasable_expression": [
                          { "function_call": [
                              { "identifier": "COUNT" },
                              { "(": [] },
                              { "_keyword_distinct": [
                                  { "DISTINCT_FROM": [] } ] },
                              { "argument": [
                                  { "identifier": "ar.account_id" } ] },
                              { ")": [] } ] },
                          { "as_alias": [
                              { "AS": [] },
                              { "identifier": "accounts" } ] } ] },
                      { ",": [] },
                      { "_aliasable_expression": [
                          { "binary_expression": [
                              { "function_call": [
                                  { "identifier": "SUM" },
                                  { "(": [] },
                                  { "argument": [
                                      { "identifier": "ar.revenue" } ] },
                                  { ")": [] } ] },
                              { "/": [] },
                              { "function_call": [
                                  { "identifier": "COUNT" },
                                  { "(": [] },
                                  { "_keyword_distinct": [
                                      { "DISTINCT_FROM": [] } ] },
                                  { "argument": [
                                      { "identifier": "ar.account_id" } ] },
                                  { ")": [] } ] } ] },
                          { "as_alias": [
                              { "AS": [] },
                              { "identifier": "revenue_per_account" } ] } ] } ] },
                  { "from_clause": [
                      { "FROM": [] },
                      { "from_item": [
                          { "join_operation": [
                              { "from_item": [
                                  { "join_operation": [
                                      { "from_item": [
                                          { "join_operation": [
                                              { "from_item": [
                                                  { "identifier": "accounts_revenue" },
                                                  { "as_alias": [
                                                      { "identifier": "ar" } ] } ] },
                                              { "join_type": [
                                                  { "LEFT": [] } ] },
                                              { "JOIN": [] },
                                              { "from_item": [
                                                  { "identifier": "accounts" },
                                                  { "as_alias": [
                                                      { "identifier": "a" } ] } ] },
                                              { "join_condition": [
                                                  { "USING": [] },
                                                  { "(": [] },
                                                  { "identifier": "account_id" },
                                                  { ")": [] } ] } ] } ] },
                                      { "join_type": [
                                          { "LEFT": [] } ] },
                                      { "JOIN": [] },
                                      { "from_item": [
                                          { "identifier": "countries" },
                                          { "as_alias": [
                                              { "identifier": "c" } ] } ] },
                                      { "join_condition": [
                                          { "USING": [] },
                                          { "(": [] },
                                          { "identifier": "country" },
                                          { ")": [] } ] } ] } ] },
                              { "join_type": [
                                  { "LEFT": [] } ] },
                              { "JOIN": [] },
                              { "from_item": [
                                  { "identifier": "accounts_360" },
                                  { "as_alias": [
                                      { "identifier": "a360" } ] } ] },
                              { "join_condition": [
                                  { "USING": [] },
                                  { "(": [] },
                                  { "identifier": "account_id" },
                                  { ",": [] },
                                  { "identifier": "date_month" },
                                  { ")": [] } ] } ] } ] } ] },
                  { "group_by_clause": [
                      { "GROUP_BY": [] },
                      { "GROUP_BY": [] },
                      { "grouping_item": [
                          { "identifier": "date_year" } ] },
                      { ",": [] },
                      { "grouping_item": [
                          { "identifier": "region_cluster" } ] },
                      { ",": [] },
                      { "grouping_item": [
                          { "identifier": "industry_cluster" } ] },
                      { ",": [] },
                      { "grouping_item": [
                          { "identifier": "a360.account_size" } ] } ] } ] },
              { "order_by_clause": [
                  { "ORDER_BY": [] },
                  { "GROUP_BY": [] },
                  { "order_by_clause_body": [
                      { "identifier": "date_year" },
                      { ",": [] },
                      { "identifier": "region_cluster" },
                      { ",": [] },
                      { "identifier": "industry_cluster" } ] } ] } ] },
          [
            { "node:dataset:table:alias": [
                { "identifier": "accounts_revenue" },
                "None",
                "accounts_revenue",
                "ar" ] },
            { "node:dataset:table:alias": [
                { "identifier": "accounts" },
                "None",
                "accounts",
                "a" ] },
            { "node:dataset:table:alias": [
                { "identifier": "countries" },
                "None",
                "countries",
                "c" ] },
            { "node:dataset:table:alias": [
                { "identifier": "accounts_360" },
                "None",
                "accounts_360",
                "a360" ] } ],
          [
            { "node:columns:alias": [
                { "function_call": [
                    { "identifier": "date" },
                    { "(": [] },
                    { "argument": [
                        { "identifier": "date_month" } ] },
                    { ",": [] },
                    { "argument": [
                        { "string": "'start of year'" } ] },
                    { ")": [] } ] },
                [
                  { "nodes:dataset:table:column": [
                      [
                        { "identifier": "date_month" },
                        { "identifier": "date_month" } ],
                      "None",
                      "None",
                      "date_month" ] } ],
                "date_year" ] },
            { "node:columns:alias": [
                { "casewhen_expression": [
                    { "CASE": [] },
                    { "casewhen_clause": [
                        { "WHEN_MATCHED": [] },
                        { "binary_expression": [
                            { "identifier": "c.region" },
                            { "IN": [] },
                            { "struct": [
                                { "(": [] },
                                { "string": "'Americas'" },
                                { ",": [] },
                                { "string": "'Europe'" },
                                { ")": [] } ] } ] },
                        { "THEN": [] },
                        { "string": "'North-West'" } ] },
                    { "casewhen_clause": [
                        { "WHEN_MATCHED": [] },
                        { "binary_expression": [
                            { "identifier": "c.region" },
                            { "IN": [] },
                            { "struct": [
                                { "(": [] },
                                { "string": "'Africa'" },
                                { ",": [] },
                                { "string": "'Asia'" },
                                { ")": [] } ] } ] },
                        { "THEN": [] },
                        { "string": "'South-East'" } ] },
                    { "caseelse_clause": [
                        { "ELSE": [] },
                        { "NULL": [
                            { "NOT_NULL": [] } ] } ] },
                    { "END_IF": [] } ] },
                [
                  { "nodes:dataset:table:column": [
                      [
                        { "identifier": "c.region" },
                        { "identifier": "c.region" } ],
                      "None",
                      "countries",
                      "region" ] } ],
                "region_cluster" ] },
            { "node:columns:alias": [
                { "casewhen_expression": [
                    { "CASE": [] },
                    { "casewhen_clause": [
                        { "WHEN_MATCHED": [] },
                        { "binary_expression": [
                            { "identifier": "a.industry" },
                            { "=": [] },
                            { "string": "'Information Technology'" } ] },
                        { "THEN": [] },
                        { "string": "'Tech'" } ] },
                    { "casewhen_clause": [
                        { "WHEN_MATCHED": [] },
                        { "unary_expression": [
                            { "identifier": "a.industry" },
                            { "IS": [] },
                            { "NULL": [
                                { "NOT_NULL": [] } ] } ] },
                        { "THEN": [] },
                        { "NULL": [
                            { "NOT_NULL": [] } ] } ] },
                    { "caseelse_clause": [
                        { "ELSE": [] },
                        { "string": "'Other'" } ] },
                    { "END_IF": [] } ] },
                [
                  { "nodes:dataset:table:column": [
                      [
                        { "identifier": "a.industry" },
                        { "identifier": "a.industry" } ],
                      "None",
                      "accounts",
                      "industry" ] } ],
                "industry_cluster" ] },
            { "node:columns:alias": [
                { "identifier": "a360.account_size" },
                [
                  { "nodes:dataset:table:column": [
                      [
                        { "identifier": "a360.account_size" },
                        { "identifier": "a360.account_size" } ],
                      "None",
                      "accounts_360",
                      "account_size" ] } ],
                "None" ] },
            { "node:columns:alias": [
                { "function_call": [
                    { "identifier": "SUM" },
                    { "(": [] },
                    { "argument": [
                        { "identifier": "ar.revenue" } ] },
                    { ")": [] } ] },
                [
                  { "nodes:dataset:table:column": [
                      [
                        { "identifier": "ar.revenue" },
                        { "identifier": "ar.revenue" } ],
                      "None",
                      "accounts_revenue",
                      "revenue" ] } ],
                "revenue" ] },
            { "node:columns:alias": [
                { "function_call": [
                    { "identifier": "COUNT" },
                    { "(": [] },
                    { "_keyword_distinct": [
                        { "DISTINCT_FROM": [] } ] },
                    { "argument": [
                        { "identifier": "ar.account_id" } ] },
                    { ")": [] } ] },
                [
                  { "nodes:dataset:table:column": [
                      [
                        { "identifier": "ar.account_id" },
                        { "identifier": "ar.account_id" } ],
                      "None",
                      "accounts_revenue",
                      "account_id" ] } ],
                "accounts" ] },
            { "node:columns:alias": [
                { "binary_expression": [
                    { "function_call": [
                        { "identifier": "SUM" },
                        { "(": [] },
                        { "argument": [
                            { "identifier": "ar.revenue" } ] },
                        { ")": [] } ] },
                    { "/": [] },
                    { "function_call": [
                        { "identifier": "COUNT" },
                        { "(": [] },
                        { "_keyword_distinct": [
                            { "DISTINCT_FROM": [] } ] },
                        { "argument": [
                            { "identifier": "ar.account_id" } ] },
                        { ")": [] } ] } ] },
                [
                  { "nodes:dataset:table:column": [
                      [
                        { "identifier": "ar.revenue" },
                        { "identifier": "ar.revenue" } ],
                      "None",
                      "accounts_revenue",
                      "revenue" ] },
                  { "nodes:dataset:table:column": [
                      [
                        { "identifier": "ar.account_id" },
                        { "identifier": "ar.account_id" } ],
                      "None",
                      "accounts_revenue",
                      "account_id" ] } ],
                "revenue_per_account" ] },
            { "node:columns:alias": [
                { "identifier": "account_id" },
                [
                  { "nodes:dataset:table:column": [
                      [
                        { "identifier": "account_id" },
                        { "identifier": "account_id" } ],
                      "None",
                      "None",
                      "account_id" ] } ],
                "None" ] },
            { "node:columns:alias": [
                { "identifier": "country" },
                [
                  { "nodes:dataset:table:column": [
                      [
                        { "identifier": "country" } ],
                      "None",
                      "None",
                      "country" ] } ],
                "None" ] },
            { "node:columns:alias": [
                { "identifier": "account_id" },
                [
                  { "nodes:dataset:table:column": [
                      [
                        { "identifier": "account_id" },
                        { "identifier": "account_id" } ],
                      "None",
                      "None",
                      "account_id" ] },
                  { "nodes:dataset:table:column": [
                      [
                        { "identifier": "date_month" },
                        { "identifier": "date_month" } ],
                      "None",
                      "None",
                      "date_month" ] } ],
                "None" ] },
            { "node:columns:alias": [
                { "identifier": "date_month" },
                [
                  { "nodes:dataset:table:column": [
                      [
                        { "identifier": "account_id" },
                        { "identifier": "account_id" } ],
                      "None",
                      "None",
                      "account_id" ] },
                  { "nodes:dataset:table:column": [
                      [
                        { "identifier": "date_month" },
                        { "identifier": "date_month" } ],
                      "None",
                      "None",
                      "date_month" ] } ],
                "None" ] },
            { "node:columns:alias": [
                { "identifier": "date_year" },
                [
                  { "nodes:dataset:table:column": [
                      [
                        { "identifier": "date_year" },
                        { "identifier": "date_year" } ],
                      "None",
                      "None",
                      "date_year" ] } ],
                "None" ] },
            { "node:columns:alias": [
                { "identifier": "region_cluster" },
                [
                  { "nodes:dataset:table:column": [
                      [
                        { "identifier": "region_cluster" },
                        { "identifier": "region_cluster" } ],
                      "None",
                      "None",
                      "region_cluster" ] } ],
                "None" ] },
            { "node:columns:alias": [
                { "identifier": "industry_cluster" },
                [
                  { "nodes:dataset:table:column": [
                      [
                        { "identifier": "industry_cluster" },
                        { "identifier": "industry_cluster" } ],
                      "None",
                      "None",
                      "industry_cluster" ] } ],
                "None" ] },
            { "node:columns:alias": [
                { "identifier": "a360.account_size" },
                [
                  { "nodes:dataset:table:column": [
                      [
                        { "identifier": "a360.account_size" },
                        { "identifier": "a360.account_size" } ],
                      "None",
                      "accounts_360",
                      "account_size" ] } ],
                "None" ] },
            { "node:columns:alias": [
                { "identifier": "date_year" },
                [
                  { "nodes:dataset:table:column": [
                      [
                        { "identifier": "date_year" },
                        { "identifier": "date_year" } ],
                      "None",
                      "None",
                      "date_year" ] },
                  { "nodes:dataset:table:column": [
                      [
                        { "identifier": "region_cluster" },
                        { "identifier": "region_cluster" } ],
                      "None",
                      "None",
                      "region_cluster" ] },
                  { "nodes:dataset:table:column": [
                      [
                        { "identifier": "industry_cluster" },
                        { "identifier": "industry_cluster" } ],
                      "None",
                      "None",
                      "industry_cluster" ] } ],
                "None" ] },
            { "node:columns:alias": [
                { "identifier": "region_cluster" },
                [
                  { "nodes:dataset:table:column": [
                      [
                        { "identifier": "date_year" },
                        { "identifier": "date_year" } ],
                      "None",
                      "None",
                      "date_year" ] },
                  { "nodes:dataset:table:column": [
                      [
                        { "identifier": "region_cluster" },
                        { "identifier": "region_cluster" } ],
                      "None",
                      "None",
                      "region_cluster" ] },
                  { "nodes:dataset:table:column": [
                      [
                        { "identifier": "industry_cluster" },
                        { "identifier": "industry_cluster" } ],
                      "None",
                      "None",
                      "industry_cluster" ] } ],
                "None" ] },
            { "node:columns:alias": [
                { "identifier": "industry_cluster" },
                [
                  { "nodes:dataset:table:column": [
                      [
                        { "identifier": "date_year" },
                        { "identifier": "date_year" } ],
                      "None",
                      "None",
                      "date_year" ] },
                  { "nodes:dataset:table:column": [
                      [
                        { "identifier": "region_cluster" },
                        { "identifier": "region_cluster" } ],
                      "None",
                      "None",
                      "region_cluster" ] },
                  { "nodes:dataset:table:column": [
                      [
                        { "identifier": "industry_cluster" },
                        { "identifier": "industry_cluster" } ],
                      "None",
                      "None",
                      "industry_cluster" ] } ],
                "None" ] } ],
          "None" ] },
      { "node:sources:ops:alias": [
          { "query_expr": [
              { "select": [
                  { "SELECT": [] },
                  { "select_list": [
                      { "_aliasable_expression": [
                          { "identifier": "accounts.name" } ] },
                      { ",": [] },
                      { "_aliasable_expression": [
                          { "identifier": "region" } ] },
                      { ",": [] },
                      { "_aliasable_expression": [
                          { "casewhen_expression": [
                              { "CASE": [] },
                              { "casewhen_clause": [
                                  { "WHEN_MATCHED": [] },
                                  { "binary_expression": [
                                      { "identifier": "c.region" },
                                      { "IN": [] },
                                      { "struct": [
                                          { "(": [] },
                                          { "string": "'Americas'" },
                                          { ",": [] },
                                          { "string": "'Europe'" },
                                          { ")": [] } ] } ] },
                                  { "THEN": [] },
                                  { "string": "'North-West'" } ] },
                              { "casewhen_clause": [
                                  { "WHEN_MATCHED": [] },
                                  { "binary_expression": [
                                      { "identifier": "c.region" },
                                      { "IN": [] },
                                      { "struct": [
                                          { "(": [] },
                                          { "string": "'Africa'" },
                                          { ",": [] },
                                          { "string": "'Asia'" },
                                          { ")": [] } ] } ] },
                                  { "THEN": [] },
                                  { "string": "'South-East'" } ] },
                              { "caseelse_clause": [
                                  { "ELSE": [] },
                                  { "NULL": [
                                      { "NOT_NULL": [] } ] } ] },
                              { "END_IF": [] } ] },
                          { "as_alias": [
                              { "AS": [] },
                              { "identifier": "cluster" } ] } ] },
                      { ",": [] },
                      { "_aliasable_expression": [
                          { "identifier": "accounts.industry" },
                          { "as_alias": [
                              { "AS": [] },
                              { "identifier": "industry" } ] } ] },
                      { ",": [] },
                      { "_aliasable_expression": [
                          { "function_call": [
                              { "identifier": "IIF" },
                              { "(": [] },
                              { "argument": [
                                  { "binary_expression": [
                                      { "identifier": "accounts.industry" },
                                      { "=": [] },
                                      { "string": "'Information Technology'" } ] } ] },
                              { ",": [] },
                              { "argument": [
                                  { "string": "'Tech'" } ] },
                              { ",": [] },
                              { "argument": [
                                  { "string": "'Other'" } ] },
                              { ")": [] } ] },
                          { "as_alias": [
                              { "AS": [] },
                              { "identifier": "industry_tech" } ] } ] },
                      { ",": [] },
                      { "_aliasable_expression": [
                          { "casewhen_expression": [
                              { "CASE": [] },
                              { "casewhen_clause": [
                                  { "WHEN_MATCHED": [] },
                                  { "binary_expression": [
                                      { "function_call": [
                                          { "identifier": "SUM" },
                                          { "(": [] },
                                          { "argument": [
                                              { "identifier": "accounts_revenue.revenue" } ] },
                                          { ")": [] } ] },
                                      { "<=": [] },
                                      { "number": "300" } ] },
                                  { "THEN": [] },
                                  { "string": "'Small'" } ] },
                              { "casewhen_clause": [
                                  { "WHEN_MATCHED": [] },
                                  { "binary_expression": [
                                      { "binary_expression": [
                                          { "function_call": [
                                              { "identifier": "SUM" },
                                              { "(": [] },
                                              { "argument": [
                                                  { "identifier": "accounts_revenue.revenue" } ] },
                                              { ")": [] } ] },
                                          { ">": [] },
                                          { "number": "300" } ] },
                                      { "AND": [] },
                                      { "binary_expression": [
                                          { "function_call": [
                                              { "identifier": "SUM" },
                                              { "(": [] },
                                              { "argument": [
                                                  { "identifier": "accounts_revenue.revenue" } ] },
                                              { ")": [] } ] },
                                          { "<=": [] },
                                          { "number": "600" } ] } ] },
                                  { "THEN": [] },
                                  { "string": "'Medium'" } ] },
                              { "casewhen_clause": [
                                  { "WHEN_MATCHED": [] },
                                  { "binary_expression": [
                                      { "function_call": [
                                          { "identifier": "SUM" },
                                          { "(": [] },
                                          { "argument": [
                                              { "identifier": "accounts_revenue.revenue" } ] },
                                          { ")": [] } ] },
                                      { ">": [] },
                                      { "number": "600" } ] },
                                  { "THEN": [] },
                                  { "string": "'Large'" } ] },
                              { "caseelse_clause": [
                                  { "ELSE": [] },
                                  { "NULL": [
                                      { "NOT_NULL": [] } ] } ] },
                              { "END_IF": [] } ] },
                          { "as_alias": [
                              { "AS": [] },
                              { "identifier": "account_size" } ] } ] },
                      { ",": [] },
                      { "_aliasable_expression": [
                          { "function_call": [
                              { "identifier": "SUM" },
                              { "(": [] },
                              { "argument": [
                                  { "identifier": "accounts_revenue.revenue" } ] },
                              { ")": [] } ] },
                          { "as_alias": [
                              { "AS": [] },
                              { "identifier": "revenue_12m" } ] } ] } ] },
                  { "from_clause": [
                      { "FROM": [] },
                      { "from_item": [
                          { "join_operation": [
                              { "from_item": [
                                  { "join_operation": [
                                      { "from_item": [
                                          { "identifier": "accounts" } ] },
                                      { "join_type": [
                                          { "LEFT": [] } ] },
                                      { "JOIN": [] },
                                      { "from_item": [
                                          { "identifier": "accounts_revenue" } ] },
                                      { "join_condition": [
                                          { "USING": [] },
                                          { "(": [] },
                                          { "identifier": "account_id" },
                                          { ")": [] } ] } ] } ] },
                              { "join_type": [
                                  { "LEFT": [] } ] },
                              { "JOIN": [] },
                              { "from_item": [
                                  { "identifier": "countries" },
                                  { "as_alias": [
                                      { "identifier": "c" } ] } ] },
                              { "join_condition": [
                                  { "USING": [] },
                                  { "(": [] },
                                  { "identifier": "country" },
                                  { ")": [] } ] } ] } ] } ] },
                  { "where_clause": [
                      { "WHERE": [] },
                      { "between_operator": [
                          { "identifier": "accounts_revenue.date_month" },
                          { "BETWEEN": [] },
                          { "_expression": [
                              { "function_call": [
                                  { "identifier": "DATE" },
                                  { "(": [] },
                                  { "argument": [
                                      { "string": "'now'" } ] },
                                  { ",": [] },
                                  { "argument": [
                                      { "string": "'-12 months'" } ] },
                                  { ")": [] } ] } ] },
                          { "AND": [] },
                          { "_expression": [
                              { "function_call": [
                                  { "identifier": "DATE" },
                                  { "(": [] },
                                  { "argument": [
                                      { "string": "'now'" } ] },
                                  { ")": [] } ] } ] } ] } ] },
                  { "group_by_clause": [
                      { "GROUP_BY": [] },
                      { "GROUP_BY": [] },
                      { "grouping_item": [
                          { "identifier": "accounts.name" } ] },
                      { ",": [] },
                      { "grouping_item": [
                          { "identifier": "region" } ] },
                      { ",": [] },
                      { "grouping_item": [
                          { "identifier": "accounts.industry" } ] } ] } ] } ] },
          [
            { "node:dataset:table:alias": [
                { "identifier": "accounts" },
                "None",
                "accounts",
                "None" ] },
            { "node:dataset:table:alias": [
                { "identifier": "accounts_revenue" },
                "None",
                "accounts_revenue",
                "None" ] },
            { "node:dataset:table:alias": [
                { "identifier": "countries" },
                "None",
                "countries",
                "c" ] } ],
          [
            { "node:columns:alias": [
                { "identifier": "accounts.name" },
                [
                  { "nodes:dataset:table:column": [
                      [
                        { "identifier": "accounts.name" },
                        { "identifier": "accounts.name" } ],
                      "None",
                      "accounts",
                      "name" ] } ],
                "None" ] },
            { "node:columns:alias": [
                { "identifier": "region" },
                [
                  { "nodes:dataset:table:column": [
                      [
                        { "identifier": "region" },
                        { "identifier": "region" } ],
                      "None",
                      "accounts_revenue",
                      "region" ] } ],
                "None" ] },
            { "node:columns:alias": [
                { "casewhen_expression": [
                    { "CASE": [] },
                    { "casewhen_clause": [
                        { "WHEN_MATCHED": [] },
                        { "binary_expression": [
                            { "identifier": "c.region" },
                            { "IN": [] },
                            { "struct": [
                                { "(": [] },
                                { "string": "'Americas'" },
                                { ",": [] },
                                { "string": "'Europe'" },
                                { ")": [] } ] } ] },
                        { "THEN": [] },
                        { "string": "'North-West'" } ] },
                    { "casewhen_clause": [
                        { "WHEN_MATCHED": [] },
                        { "binary_expression": [
                            { "identifier": "c.region" },
                            { "IN": [] },
                            { "struct": [
                                { "(": [] },
                                { "string": "'Africa'" },
                                { ",": [] },
                                { "string": "'Asia'" },
                                { ")": [] } ] } ] },
                        { "THEN": [] },
                        { "string": "'South-East'" } ] },
                    { "caseelse_clause": [
                        { "ELSE": [] },
                        { "NULL": [
                            { "NOT_NULL": [] } ] } ] },
                    { "END_IF": [] } ] },
                [
                  { "nodes:dataset:table:column": [
                      [
                        { "identifier": "c.region" },
                        { "identifier": "c.region" } ],
                      "None",
                      "countries",
                      "region" ] } ],
                "cluster" ] },
            { "node:columns:alias": [
                { "identifier": "accounts.industry" },
                [
                  { "nodes:dataset:table:column": [
                      [
                        { "identifier": "accounts.industry" },
                        { "identifier": "accounts.industry" },
                        { "identifier": "accounts.industry" } ],
                      "None",
                      "accounts",
                      "industry" ] } ],
                "industry" ] },
            { "node:columns:alias": [
                { "function_call": [
                    { "identifier": "IIF" },
                    { "(": [] },
                    { "argument": [
                        { "binary_expression": [
                            { "identifier": "accounts.industry" },
                            { "=": [] },
                            { "string": "'Information Technology'" } ] } ] },
                    { ",": [] },
                    { "argument": [
                        { "string": "'Tech'" } ] },
                    { ",": [] },
                    { "argument": [
                        { "string": "'Other'" } ] },
                    { ")": [] } ] },
                [
                  { "nodes:dataset:table:column": [
                      [
                        { "identifier": "accounts.industry" },
                        { "identifier": "accounts.industry" },
                        { "identifier": "accounts.industry" } ],
                      "None",
                      "accounts",
                      "industry" ] } ],
                "industry_tech" ] },
            { "node:columns:alias": [
                { "casewhen_expression": [
                    { "CASE": [] },
                    { "casewhen_clause": [
                        { "WHEN_MATCHED": [] },
                        { "binary_expression": [
                            { "function_call": [
                                { "identifier": "SUM" },
                                { "(": [] },
                                { "argument": [
                                    { "identifier": "accounts_revenue.revenue" } ] },
                                { ")": [] } ] },
                            { "<=": [] },
                            { "number": "300" } ] },
                        { "THEN": [] },
                        { "string": "'Small'" } ] },
                    { "casewhen_clause": [
                        { "WHEN_MATCHED": [] },
                        { "binary_expression": [
                            { "binary_expression": [
                                { "function_call": [
                                    { "identifier": "SUM" },
                                    { "(": [] },
                                    { "argument": [
                                        { "identifier": "accounts_revenue.revenue" } ] },
                                    { ")": [] } ] },
                                { ">": [] },
                                { "number": "300" } ] },
                            { "AND": [] },
                            { "binary_expression": [
                                { "function_call": [
                                    { "identifier": "SUM" },
                                    { "(": [] },
                                    { "argument": [
                                        { "identifier": "accounts_revenue.revenue" } ] },
                                    { ")": [] } ] },
                                { "<=": [] },
                                { "number": "600" } ] } ] },
                        { "THEN": [] },
                        { "string": "'Medium'" } ] },
                    { "casewhen_clause": [
                        { "WHEN_MATCHED": [] },
                        { "binary_expression": [
                            { "function_call": [
                                { "identifier": "SUM" },
                                { "(": [] },
                                { "argument": [
                                    { "identifier": "accounts_revenue.revenue" } ] },
                                { ")": [] } ] },
                            { ">": [] },
                            { "number": "600" } ] },
                        { "THEN": [] },
                        { "string": "'Large'" } ] },
                    { "caseelse_clause": [
                        { "ELSE": [] },
                        { "NULL": [
                            { "NOT_NULL": [] } ] } ] },
                    { "END_IF": [] } ] },
                [
                  { "nodes:dataset:table:column": [
                      [
                        { "identifier": "accounts_revenue.revenue" },
                        { "identifier": "accounts_revenue.revenue" },
                        { "identifier": "accounts_revenue.revenue" },
                        { "identifier": "accounts_revenue.revenue" },
                        { "identifier": "accounts_revenue.revenue" } ],
                      "None",
                      "accounts_revenue",
                      "revenue" ] } ],
                "account_size" ] },
            { "node:columns:alias": [
                { "function_call": [
                    { "identifier": "SUM" },
                    { "(": [] },
                    { "argument": [
                        { "identifier": "accounts_revenue.revenue" } ] },
                    { ")": [] } ] },
                [
                  { "nodes:dataset:table:column": [
                      [
                        { "identifier": "accounts_revenue.revenue" },
                        { "identifier": "accounts_revenue.revenue" },
                        { "identifier": "accounts_revenue.revenue" },
                        { "identifier": "accounts_revenue.revenue" },
                        { "identifier": "accounts_revenue.revenue" } ],
                      "None",
                      "accounts_revenue",
                      "revenue" ] } ],
                "revenue_12m" ] },
            { "node:columns:alias": [
                { "identifier": "account_id" },
                [
                  { "nodes:dataset:table:column": [
                      [
                        { "identifier": "account_id" } ],
                      "None",
                      "accounts_revenue",
                      "account_id" ] } ],
                "None" ] },
            { "node:columns:alias": [
                { "identifier": "country" },
                [
                  { "nodes:dataset:table:column": [
                      [
                        { "identifier": "country" } ],
                      "None",
                      "accounts_revenue",
                      "country" ] } ],
                "None" ] },
            { "node:columns:alias": [
                { "identifier": "accounts.name" },
                [
                  { "nodes:dataset:table:column": [
                      [
                        { "identifier": "accounts.name" },
                        { "identifier": "accounts.name" } ],
                      "None",
                      "accounts",
                      "name" ] } ],
                "None" ] },
            { "node:columns:alias": [
                { "identifier": "region" },
                [
                  { "nodes:dataset:table:column": [
                      [
                        { "identifier": "region" },
                        { "identifier": "region" } ],
                      "None",
                      "accounts_revenue",
                      "region" ] } ],
                "None" ] },
            { "node:columns:alias": [
                { "identifier": "accounts.industry" },
                [
                  { "nodes:dataset:table:column": [
                      [
                        { "identifier": "accounts.industry" },
                        { "identifier": "accounts.industry" },
                        { "identifier": "accounts.industry" } ],
                      "None",
                      "accounts",
                      "industry" ] } ],
                "None" ] } ],
          "None" ] } ] ] }