[{"root": {"type": "source_file", "text": "SELECT book, LAST_VALUE(item) OVER (ORDER BY year) FROM Library;\nSELECT ROW_NUMBER() OVER (PARTITION BY author ORDER BY ts) as seq FROM Library;\nSELECT book, LAST_VALUE(item)\n  OVER (\n    ORDER BY year\n    RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW)\nFROM Library;\n\n", "children": [{"type": "query_statement", "text": "SELECT book, LAST_VALUE(item) OVER (ORDER BY year) FROM Library", "children": [{"type": "query_expr", "text": "SELECT book, LAST_VALUE(item) OVER (ORDER BY year) FROM Library", "children": [{"type": "select", "text": "SELECT book, LAST_VALUE(item) OVER (ORDER BY year) FROM Library", "children": [{"type": "SELECT", "text": "SELECT", "children": []}, {"type": "select_list", "text": "book, LAST_VALUE(item) OVER (ORDER BY year)", "children": [{"type": "select_expression", "text": "book", "children": [{"type": "identifier", "text": "book", "children": []}]}, {"type": ",", "text": ",", "children": []}, {"type": "select_expression", "text": "LAST_VALUE(item) OVER (ORDER BY year)", "children": [{"type": "function_call", "text": "LAST_VALUE(item) OVER (ORDER BY year)", "children": [{"type": "identifier", "text": "LAST_VALUE", "children": []}, {"type": "(", "text": "(", "children": []}, {"type": "argument", "text": "item", "children": [{"type": "identifier", "text": "item", "children": []}]}, {"type": ")", "text": ")", "children": []}, {"type": "analytics_clause", "text": "OVER (ORDER BY year)", "children": [{"type": "OVER", "text": "OVER", "children": []}, {"type": "over_clause", "text": "(ORDER BY year)", "children": [{"type": "window_specification", "text": "(ORDER BY year)", "children": [{"type": "(", "text": "(", "children": []}, {"type": "order_by_clause", "text": "ORDER BY year", "children": [{"type": "ORDER_BY", "text": "ORDER", "children": []}, {"type": "ORDER_BY", "text": "BY", "children": []}, {"type": "order_by_clause_body", "text": "year", "children": [{"type": "identifier", "text": "year", "children": []}]}]}, {"type": ")", "text": ")", "children": []}]}]}]}]}]}]}, {"type": "from_clause", "text": "FROM Library", "children": [{"type": "FROM", "text": "FROM", "children": []}, {"type": "from_item", "text": "Library", "children": [{"type": "identifier", "text": "Library", "children": []}]}]}]}]}]}, {"type": ";", "text": ";", "children": []}, {"type": "query_statement", "text": "SELECT ROW_NUMBER() OVER (PARTITION BY author ORDER BY ts) as seq FROM Library", "children": [{"type": "query_expr", "text": "SELECT ROW_NUMBER() OVER (PARTITION BY author ORDER BY ts) as seq FROM Library", "children": [{"type": "select", "text": "SELECT ROW_NUMBER() OVER (PARTITION BY author ORDER BY ts) as seq FROM Library", "children": [{"type": "SELECT", "text": "SELECT", "children": []}, {"type": "select_list", "text": "ROW_NUMBER() OVER (PARTITION BY author ORDER BY ts) as seq", "children": [{"type": "select_expression", "text": "ROW_NUMBER() OVER (PARTITION BY author ORDER BY ts) as seq", "children": [{"type": "function_call", "text": "ROW_NUMBER() OVER (PARTITION BY author ORDER BY ts)", "children": [{"type": "identifier", "text": "ROW_NUMBER", "children": []}, {"type": "(", "text": "(", "children": []}, {"type": ")", "text": ")", "children": []}, {"type": "analytics_clause", "text": "OVER (PARTITION BY author ORDER BY ts)", "children": [{"type": "OVER", "text": "OVER", "children": []}, {"type": "over_clause", "text": "(PARTITION BY author ORDER BY ts)", "children": [{"type": "window_specification", "text": "(PARTITION BY author ORDER BY ts)", "children": [{"type": "(", "text": "(", "children": []}, {"type": "window_partition_clause", "text": "PARTITION BY author", "children": [{"type": "PARTITION_BY", "text": "PARTITION", "children": []}, {"type": "PARTITION_BY", "text": "BY", "children": []}, {"type": "partition_expression", "text": "author", "children": [{"type": "identifier", "text": "author", "children": []}]}]}, {"type": "order_by_clause", "text": "ORDER BY ts", "children": [{"type": "ORDER_BY", "text": "ORDER", "children": []}, {"type": "ORDER_BY", "text": "BY", "children": []}, {"type": "order_by_clause_body", "text": "ts", "children": [{"type": "identifier", "text": "ts", "children": []}]}]}, {"type": ")", "text": ")", "children": []}]}]}]}]}, {"type": "as_alias", "text": "as seq", "children": [{"type": "AS", "text": "as", "children": []}, {"type": "identifier", "text": "seq", "children": []}]}]}]}, {"type": "from_clause", "text": "FROM Library", "children": [{"type": "FROM", "text": "FROM", "children": []}, {"type": "from_item", "text": "Library", "children": [{"type": "identifier", "text": "Library", "children": []}]}]}]}]}]}, {"type": ";", "text": ";", "children": []}, {"type": "query_statement", "text": "SELECT book, LAST_VALUE(item)\n  OVER (\n    ORDER BY year\n    RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW)\nFROM Library", "children": [{"type": "query_expr", "text": "SELECT book, LAST_VALUE(item)\n  OVER (\n    ORDER BY year\n    RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW)\nFROM Library", "children": [{"type": "select", "text": "SELECT book, LAST_VALUE(item)\n  OVER (\n    ORDER BY year\n    RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW)\nFROM Library", "children": [{"type": "SELECT", "text": "SELECT", "children": []}, {"type": "select_list", "text": "book, LAST_VALUE(item)\n  OVER (\n    ORDER BY year\n    RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW)", "children": [{"type": "select_expression", "text": "book", "children": [{"type": "identifier", "text": "book", "children": []}]}, {"type": ",", "text": ",", "children": []}, {"type": "select_expression", "text": "LAST_VALUE(item)\n  OVER (\n    ORDER BY year\n    RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW)", "children": [{"type": "function_call", "text": "LAST_VALUE(item)\n  OVER (\n    ORDER BY year\n    RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW)", "children": [{"type": "identifier", "text": "LAST_VALUE", "children": []}, {"type": "(", "text": "(", "children": []}, {"type": "argument", "text": "item", "children": [{"type": "identifier", "text": "item", "children": []}]}, {"type": ")", "text": ")", "children": []}, {"type": "analytics_clause", "text": "OVER (\n    ORDER BY year\n    RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW)", "children": [{"type": "OVER", "text": "OVER", "children": []}, {"type": "over_clause", "text": "(\n    ORDER BY year\n    RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW)", "children": [{"type": "window_specification", "text": "(\n    ORDER BY year\n    RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW)", "children": [{"type": "(", "text": "(", "children": []}, {"type": "order_by_clause", "text": "ORDER BY year", "children": [{"type": "ORDER_BY", "text": "ORDER", "children": []}, {"type": "ORDER_BY", "text": "BY", "children": []}, {"type": "order_by_clause_body", "text": "year", "children": [{"type": "identifier", "text": "year", "children": []}]}]}, {"type": "window_frame_clause", "text": "RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW", "children": [{"type": "rows_range", "text": "RANGE", "children": [{"type": "RANGE", "text": "RANGE", "children": []}]}, {"type": "window_frame_between", "text": "BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW", "children": [{"type": "BETWEEN", "text": "BETWEEN", "children": []}, {"type": "between_from", "text": "UNBOUNDED PRECEDING", "children": [{"type": "UNBOUNDED_PRECEDING", "text": "UNBOUNDED", "children": []}, {"type": "UNBOUNDED_PRECEDING", "text": "PRECEDING", "children": []}]}, {"type": "AND", "text": "AND", "children": []}, {"type": "between_to", "text": "CURRENT ROW", "children": [{"type": "keyword_current_row", "text": "CURRENT ROW", "children": [{"type": "CURRENT_ROW", "text": "CURRENT", "children": []}, {"type": "CURRENT_ROW", "text": "ROW", "children": []}]}]}]}]}, {"type": ")", "text": ")", "children": []}]}]}]}]}]}]}, {"type": "from_clause", "text": "FROM Library", "children": [{"type": "FROM", "text": "FROM", "children": []}, {"type": "from_item", "text": "Library", "children": [{"type": "identifier", "text": "Library", "children": []}]}]}]}]}]}, {"type": ";", "text": ";", "children": []}]}}, {"root": {"type": "source_file", "text": "SELECT item, purchases, category, LAST_VALUE(item)\n  OVER (\n      item_window\n      ROWS BETWEEN 1 PRECEDING AND 1 FOLLOWING\n      ) AS most_popular\n  FROM Produce\n  WINDOW item_window AS (\n      PARTITION BY category1, category2\n      ORDER BY purchases)", "children": [{"type": "query_statement", "text": "SELECT item, purchases, category, LAST_VALUE(item)\n  OVER (\n      item_window\n      ROWS BETWEEN 1 PRECEDING AND 1 FOLLOWING\n      ) AS most_popular\n  FROM Produce\n  WINDOW item_window AS (\n      PARTITION BY category1, category2\n      ORDER BY purchases)", "children": [{"type": "query_expr", "text": "SELECT item, purchases, category, LAST_VALUE(item)\n  OVER (\n      item_window\n      ROWS BETWEEN 1 PRECEDING AND 1 FOLLOWING\n      ) AS most_popular\n  FROM Produce\n  WINDOW item_window AS (\n      PARTITION BY category1, category2\n      ORDER BY purchases)", "children": [{"type": "select", "text": "SELECT item, purchases, category, LAST_VALUE(item)\n  OVER (\n      item_window\n      ROWS BETWEEN 1 PRECEDING AND 1 FOLLOWING\n      ) AS most_popular\n  FROM Produce\n  WINDOW item_window AS (\n      PARTITION BY category1, category2\n      ORDER BY purchases)", "children": [{"type": "SELECT", "text": "SELECT", "children": []}, {"type": "select_list", "text": "item, purchases, category, LAST_VALUE(item)\n  OVER (\n      item_window\n      ROWS BETWEEN 1 PRECEDING AND 1 FOLLOWING\n      ) AS most_popular", "children": [{"type": "select_expression", "text": "item", "children": [{"type": "identifier", "text": "item", "children": []}]}, {"type": ",", "text": ",", "children": []}, {"type": "select_expression", "text": "purchases", "children": [{"type": "identifier", "text": "purchases", "children": []}]}, {"type": ",", "text": ",", "children": []}, {"type": "select_expression", "text": "category", "children": [{"type": "identifier", "text": "category", "children": []}]}, {"type": ",", "text": ",", "children": []}, {"type": "select_expression", "text": "LAST_VALUE(item)\n  OVER (\n      item_window\n      ROWS BETWEEN 1 PRECEDING AND 1 FOLLOWING\n      ) AS most_popular", "children": [{"type": "function_call", "text": "LAST_VALUE(item)\n  OVER (\n      item_window\n      ROWS BETWEEN 1 PRECEDING AND 1 FOLLOWING\n      )", "children": [{"type": "identifier", "text": "LAST_VALUE", "children": []}, {"type": "(", "text": "(", "children": []}, {"type": "argument", "text": "item", "children": [{"type": "identifier", "text": "item", "children": []}]}, {"type": ")", "text": ")", "children": []}, {"type": "analytics_clause", "text": "OVER (\n      item_window\n      ROWS BETWEEN 1 PRECEDING AND 1 FOLLOWING\n      )", "children": [{"type": "OVER", "text": "OVER", "children": []}, {"type": "over_clause", "text": "(\n      item_window\n      ROWS BETWEEN 1 PRECEDING AND 1 FOLLOWING\n      )", "children": [{"type": "window_specification", "text": "(\n      item_window\n      ROWS BETWEEN 1 PRECEDING AND 1 FOLLOWING\n      )", "children": [{"type": "(", "text": "(", "children": []}, {"type": "identifier", "text": "item_window", "children": []}, {"type": "window_frame_clause", "text": "ROWS BETWEEN 1 PRECEDING AND 1 FOLLOWING", "children": [{"type": "rows_range", "text": "ROWS", "children": [{"type": "ROWS", "text": "ROWS", "children": []}]}, {"type": "window_frame_between", "text": "BETWEEN 1 PRECEDING AND 1 FOLLOWING", "children": [{"type": "BETWEEN", "text": "BETWEEN", "children": []}, {"type": "between_from", "text": "1 PRECEDING", "children": [{"type": "number", "text": "1", "children": []}, {"type": "PRECEDING", "text": "PRECEDING", "children": []}]}, {"type": "AND", "text": "AND", "children": []}, {"type": "between_to", "text": "1 FOLLOWING", "children": [{"type": "window_numeric_following", "text": "1 FOLLOWING", "children": [{"type": "number", "text": "1", "children": []}, {"type": "FOLLOWING", "text": "FOLLOWING", "children": []}]}]}]}]}, {"type": ")", "text": ")", "children": []}]}]}]}]}, {"type": "as_alias", "text": "AS most_popular", "children": [{"type": "AS", "text": "AS", "children": []}, {"type": "identifier", "text": "most_popular", "children": []}]}]}]}, {"type": "from_clause", "text": "FROM Produce", "children": [{"type": "FROM", "text": "FROM", "children": []}, {"type": "from_item", "text": "Produce", "children": [{"type": "identifier", "text": "Produce", "children": []}]}]}, {"type": "window_clause", "text": "WINDOW item_window AS (\n      PARTITION BY category1, category2\n      ORDER BY purchases)", "children": [{"type": "WINDOW", "text": "WINDOW", "children": []}, {"type": "named_window_expression", "text": "item_window AS (\n      PARTITION BY category1, category2\n      ORDER BY purchases)", "children": [{"type": "identifier", "text": "item_window", "children": []}, {"type": "AS", "text": "AS", "children": []}, {"type": "window_specification", "text": "(\n      PARTITION BY category1, category2\n      ORDER BY purchases)", "children": [{"type": "(", "text": "(", "children": []}, {"type": "window_partition_clause", "text": "PARTITION BY category1, category2", "children": [{"type": "PARTITION_BY", "text": "PARTITION", "children": []}, {"type": "PARTITION_BY", "text": "BY", "children": []}, {"type": "partition_expression", "text": "category1", "children": [{"type": "identifier", "text": "category1", "children": []}]}, {"type": ",", "text": ",", "children": []}, {"type": "partition_expression", "text": "category2", "children": [{"type": "identifier", "text": "category2", "children": []}]}]}, {"type": "order_by_clause", "text": "ORDER BY purchases", "children": [{"type": "ORDER_BY", "text": "ORDER", "children": []}, {"type": "ORDER_BY", "text": "BY", "children": []}, {"type": "order_by_clause_body", "text": "purchases", "children": [{"type": "identifier", "text": "purchases", "children": []}]}]}, {"type": ")", "text": ")", "children": []}]}]}]}]}]}]}]}}]